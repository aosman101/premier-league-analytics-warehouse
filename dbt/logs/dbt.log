[0m18:54:04.355159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b72510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111baacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bce6d0>]}


============================== 18:54:04.375175 | 11ab672e-a892-456c-bd22-7670182d536a ==============================
[0m18:54:04.375175 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:54:04.376614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'log_path': 'dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:54:04.785113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ab672e-a892-456c-bd22-7670182d536a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111620510>]}
[0m18:54:04.786883 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:54:04.788939 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:54:04.802823 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6504758, "process_user_time": 4.744231, "process_kernel_time": 0.938313, "process_mem_max_rss": "101548032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:54:04.805059 [debug] [MainThread]: Command `dbt deps` succeeded at 18:54:04.804503 after 0.65 seconds
[0m18:54:04.806616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feef450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b5c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d230d90>]}
[0m18:54:04.808026 [debug] [MainThread]: Flushing usage events
[0m18:55:04.934703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbee590>]}


============================== 18:55:04.944791 | 4a816264-b09e-4c74-930e-7f316c8ff7d9 ==============================
[0m18:55:04.944791 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:55:04.946291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:05.252851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a816264-b09e-4c74-930e-7f316c8ff7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc15950>]}
[0m18:55:05.254272 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:55:05.258433 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:55:05.275138 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4838505, "process_user_time": 3.658613, "process_kernel_time": 0.818178, "process_mem_max_rss": "102412288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:55:05.276500 [debug] [MainThread]: Command `dbt deps` succeeded at 18:55:05.276090 after 0.49 seconds
[0m18:55:05.277922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d949d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092465d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109246550>]}
[0m18:55:05.278677 [debug] [MainThread]: Flushing usage events
[0m18:57:12.656674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095876d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960ef50>]}


============================== 18:57:12.676249 | 52b91e7a-1e81-4d72-af52-8cded8a052d7 ==============================
[0m18:57:12.676249 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:57:12.678714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target ci', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:59.012103 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "premier_league_analytics", target "ci" invalid: '{\n  "type": "service_account",\n  "project_id": "pl-football-analytics",\n  "private_key_id": "7d994e79a010ca9c0ee90da958543c43d7d6a6fc",\n  "private_key": "-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC7QnGGgU01KCEN\\niENvgitTPZvo/736Q0UrFh5TJFz5aXAZVay9MjG588QRAdgpbXV+ufe/grX6N1o2\\n3Yje75zHNIBo/eTMSVJv9JCVcI7Q3ngXocMe7QdZdmAxPKIAN/pYnqa986LB/Zog\\nu9QI0/D7cPSgK7ydMm9BuDmRxfRgs4QjqAV7ngP+HyTbQFO2XFw47t7O/LZDUePj\\ngnX1THviC5OsnFSBh/D4GN1ifoiXqZZJJdK/t+q8IMGbYyYnEQsR6dLu95mzbEZI\\nNVcSbjHD/BWycdT7u2r4tYnHZBt8zdl2ajBa42yry3NX8Vy4X8aLX7bWjIdMWfTT\\n8K7gDoBtAgMBAAECggEAAOm0gvrbZQBylM3OwlrominJOkwQ4Yj1a93aPP6G44Jj\\nlQQJaQy3GFh7YrfXFXCeq4T9k7Xv7C3b5zuSQL/7TC9R1vEx7dsHp1sSX2AimhsT\\ni83ylRKDwChnFKZehdDADDGNz4xCBV8WosU3pelemeM1lhhQfZWy3CepRDAqXlRP\\nj21mr/im3+z2R5zBg8pcfIQF9b3AVGngxR4rOwehYdZMRInTfQHWwXbskksaPNew\\nQev4EiEJawloZSs03Chtea6ErJdX1DsDpsSuFTDVUI0IFUv+dNinVYMIFAjnsnG1\\naADCIsZN6cHsas2+fFz5c5BUPBTAKxxnfpePiYAtEwKBgQD7Lh8uSgsHkaL2pCJt\\nQuUIYk+mR2JOml4GXqUqD/BaSLmVcQloUvDjjwVyKdUUiLDLsNpA3/hwj5OYwYpV\\n2KQp4dTltl0GWUBGq+JXSMVyTWPQKBR8wfGc1V8OvJvJ8ZRT1rqwyoXJU5mdhT8z\\nMf26gQRVf1Dyw0IhHYcydfksUwKBgQC+2lKqBm90JhsQgmfqBP4d2jhHiqOP/bgG\\nYtw3TgjfHvws1iPthHZkGmi5K01I1b3Rt8Nc6a1pSe/EohQVUpoLKnpmhekphyrk\\nJEV/SlPPlMPVGiClrK4EfZYbo9XBCeXpNcnUEdDeL9zDNlKUzocNnMLnOMwBnd4N\\nZ9hbHP4IPwKBgFaTXiH5WXXhZ9c1WbxpS0IpiKSahDLtmCz/4FPwLHsiB/2PeZug\\nwvDcchcYfh5WwwFiUsf7qsk5Y7lKNGFEi8j30wbeZY/zoWj6g8hsB8pPDHFJ703V\\nF29kSCBvOA9SGjsPj0eydoyfKRqXO+Jsf7USFSlW+dLDJH7/i4MEEL+LAoGBAIPX\\nXA2afnnVLRMdkt1l74n9yq0ZR95bnjnDJ2+JF7XSuM/caltVC1ghqkBoem4bQZLT\\niEDyKFo4ukqy0H7eXg3inUWfsi9+8ZFCwUOqu/UFRrc64lywylHN09lqN2qwBMQy\\n5Sb727bxh2bPawLjHQa5SSbj5IIlZVULbLmccJyPAoGBAIH09o1DqVH24HxZZSwH\\nAIC8ysdOAYlPsAWFvJry8VMv+zeNUd1NAykbhztMigteUuwIdLG3zZxPfCsGMn1Z\\nP9ZOAfDpbOd4Lha+1s3sclTS46KNjf+X48gqwnGfmnbqT84MlOnXBZIQRBH30EFC\\ngygqCsRl4KUuHm3Sbem012hT\\n-----END PRIVATE KEY-----\\n",\n  "client_email": "dbt-pl-ci-sa@pl-football-analytics.iam.gserviceaccount.com",\n  "client_id": "106750563153080302318",\n  "auth_uri": "https://accounts.google.com/o/oauth2/auth",\n  "token_uri": "https://oauth2.googleapis.com/token",\n  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",\n  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/dbt-pl-ci-sa%40pl-football-analytics.iam.gserviceaccount.com",\n  "universe_domain": "googleapis.com"\n}' is not valid under any of the given schemas
[0m18:57:59.027024 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 46.553787, "process_user_time": 6.590131, "process_kernel_time": 1.630724, "process_mem_max_rss": "190259200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:57:59.029463 [debug] [MainThread]: Command `dbt build` failed at 18:57:59.028701 after 46.56 seconds
[0m18:57:59.030383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c96810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbf210>]}
[0m18:57:59.031198 [debug] [MainThread]: Flushing usage events
[0m19:23:12.800889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f73ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f94f50>]}


============================== 19:23:12.830042 | 2b312ff7-be80-4e95-a4c7-f2670a99aab6 ==============================
[0m19:23:12.830042 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:23:12.831785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'send_anonymous_usage_stats': 'True'}
[0m19:24:07.412468 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "premier_league_analytics", target "ci" invalid: '{\n  "type": "service_account",\n  "project_id": "pl-football-analytics",\n  "private_key_id": "7d994e79a010ca9c0ee90da958543c43d7d6a6fc",\n  "private_key": "-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC7QnGGgU01KCEN\\niENvgitTPZvo/736Q0UrFh5TJFz5aXAZVay9MjG588QRAdgpbXV+ufe/grX6N1o2\\n3Yje75zHNIBo/eTMSVJv9JCVcI7Q3ngXocMe7QdZdmAxPKIAN/pYnqa986LB/Zog\\nu9QI0/D7cPSgK7ydMm9BuDmRxfRgs4QjqAV7ngP+HyTbQFO2XFw47t7O/LZDUePj\\ngnX1THviC5OsnFSBh/D4GN1ifoiXqZZJJdK/t+q8IMGbYyYnEQsR6dLu95mzbEZI\\nNVcSbjHD/BWycdT7u2r4tYnHZBt8zdl2ajBa42yry3NX8Vy4X8aLX7bWjIdMWfTT\\n8K7gDoBtAgMBAAECggEAAOm0gvrbZQBylM3OwlrominJOkwQ4Yj1a93aPP6G44Jj\\nlQQJaQy3GFh7YrfXFXCeq4T9k7Xv7C3b5zuSQL/7TC9R1vEx7dsHp1sSX2AimhsT\\ni83ylRKDwChnFKZehdDADDGNz4xCBV8WosU3pelemeM1lhhQfZWy3CepRDAqXlRP\\nj21mr/im3+z2R5zBg8pcfIQF9b3AVGngxR4rOwehYdZMRInTfQHWwXbskksaPNew\\nQev4EiEJawloZSs03Chtea6ErJdX1DsDpsSuFTDVUI0IFUv+dNinVYMIFAjnsnG1\\naADCIsZN6cHsas2+fFz5c5BUPBTAKxxnfpePiYAtEwKBgQD7Lh8uSgsHkaL2pCJt\\nQuUIYk+mR2JOml4GXqUqD/BaSLmVcQloUvDjjwVyKdUUiLDLsNpA3/hwj5OYwYpV\\n2KQp4dTltl0GWUBGq+JXSMVyTWPQKBR8wfGc1V8OvJvJ8ZRT1rqwyoXJU5mdhT8z\\nMf26gQRVf1Dyw0IhHYcydfksUwKBgQC+2lKqBm90JhsQgmfqBP4d2jhHiqOP/bgG\\nYtw3TgjfHvws1iPthHZkGmi5K01I1b3Rt8Nc6a1pSe/EohQVUpoLKnpmhekphyrk\\nJEV/SlPPlMPVGiClrK4EfZYbo9XBCeXpNcnUEdDeL9zDNlKUzocNnMLnOMwBnd4N\\nZ9hbHP4IPwKBgFaTXiH5WXXhZ9c1WbxpS0IpiKSahDLtmCz/4FPwLHsiB/2PeZug\\nwvDcchcYfh5WwwFiUsf7qsk5Y7lKNGFEi8j30wbeZY/zoWj6g8hsB8pPDHFJ703V\\nF29kSCBvOA9SGjsPj0eydoyfKRqXO+Jsf7USFSlW+dLDJH7/i4MEEL+LAoGBAIPX\\nXA2afnnVLRMdkt1l74n9yq0ZR95bnjnDJ2+JF7XSuM/caltVC1ghqkBoem4bQZLT\\niEDyKFo4ukqy0H7eXg3inUWfsi9+8ZFCwUOqu/UFRrc64lywylHN09lqN2qwBMQy\\n5Sb727bxh2bPawLjHQa5SSbj5IIlZVULbLmccJyPAoGBAIH09o1DqVH24HxZZSwH\\nAIC8ysdOAYlPsAWFvJry8VMv+zeNUd1NAykbhztMigteUuwIdLG3zZxPfCsGMn1Z\\nP9ZOAfDpbOd4Lha+1s3sclTS46KNjf+X48gqwnGfmnbqT84MlOnXBZIQRBH30EFC\\ngygqCsRl4KUuHm3Sbem012hT\\n-----END PRIVATE KEY-----\\n",\n  "client_email": "dbt-pl-ci-sa@pl-football-analytics.iam.gserviceaccount.com",\n  "client_id": "106750563153080302318",\n  "auth_uri": "https://accounts.google.com/o/oauth2/auth",\n  "token_uri": "https://oauth2.googleapis.com/token",\n  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",\n  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/dbt-pl-ci-sa%40pl-football-analytics.iam.gserviceaccount.com",\n  "universe_domain": "googleapis.com"\n}' is not valid under any of the given schemas
[0m19:24:07.509648 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 54.99165, "process_user_time": 6.860743, "process_kernel_time": 1.468861, "process_mem_max_rss": "187662336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:24:07.512176 [debug] [MainThread]: Command `dbt build` failed at 19:24:07.511425 after 54.99 seconds
[0m19:24:07.513898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f94cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d556f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d557090>]}
[0m19:24:07.515388 [debug] [MainThread]: Flushing usage events
[0m19:25:26.115480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f132290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f137fd0>]}


============================== 19:25:26.133821 | 560130f7-72f0-42a1-a26a-d8fc3bc78b36 ==============================
[0m19:25:26.133821 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:25:26.135547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'log_path': 'dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:25:26.137137 [info ] [MainThread]: dbt version: 1.7.19
[0m19:25:26.138337 [info ] [MainThread]: python version: 3.11.14
[0m19:25:26.148916 [info ] [MainThread]: python path: /Users/adilosman/.venv-dbt-core-3.11/bin/python3.11
[0m19:25:26.151914 [info ] [MainThread]: os info: macOS-15.7.2-x86_64-i386-64bit
[0m19:25:39.342752 [info ] [MainThread]: Using profiles dir at /Users/adilosman/Desktop/premier-league-analytics-warehouse/ci
[0m19:25:39.349254 [info ] [MainThread]: Using profiles.yml file at /Users/adilosman/Desktop/premier-league-analytics-warehouse/ci/profiles.yml
[0m19:25:39.385182 [info ] [MainThread]: Using dbt_project.yml file at dbt/dbt_project.yml
[0m19:25:40.050246 [info ] [MainThread]: Configuration:
[0m19:25:40.052640 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:25:40.054373 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:25:40.056461 [info ] [MainThread]: Required dependencies:
[0m19:25:40.059307 [debug] [MainThread]: Executing "git --help"
[0m19:25:40.278132 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:25:40.280909 [debug] [MainThread]: STDERR: "b''"
[0m19:25:40.282304 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:25:40.283924 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:25:40.285530 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:25:40.287196 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "premier_league_analytics", target "ci" invalid: '{\n  "type": "service_account",\n  "project_id": "pl-football-analytics",\n  "private_key_id": "7d994e79a010ca9c0ee90da958543c43d7d6a6fc",\n  "private_key": "-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC7QnGGgU01KCEN\\niENvgitTPZvo/736Q0UrFh5TJFz5aXAZVay9MjG588QRAdgpbXV+ufe/grX6N1o2\\n3Yje75zHNIBo/eTMSVJv9JCVcI7Q3ngXocMe7QdZdmAxPKIAN/pYnqa986LB/Zog\\nu9QI0/D7cPSgK7ydMm9BuDmRxfRgs4QjqAV7ngP+HyTbQFO2XFw47t7O/LZDUePj\\ngnX1THviC5OsnFSBh/D4GN1ifoiXqZZJJdK/t+q8IMGbYyYnEQsR6dLu95mzbEZI\\nNVcSbjHD/BWycdT7u2r4tYnHZBt8zdl2ajBa42yry3NX8Vy4X8aLX7bWjIdMWfTT\\n8K7gDoBtAgMBAAECggEAAOm0gvrbZQBylM3OwlrominJOkwQ4Yj1a93aPP6G44Jj\\nlQQJaQy3GFh7YrfXFXCeq4T9k7Xv7C3b5zuSQL/7TC9R1vEx7dsHp1sSX2AimhsT\\ni83ylRKDwChnFKZehdDADDGNz4xCBV8WosU3pelemeM1lhhQfZWy3CepRDAqXlRP\\nj21mr/im3+z2R5zBg8pcfIQF9b3AVGngxR4rOwehYdZMRInTfQHWwXbskksaPNew\\nQev4EiEJawloZSs03Chtea6ErJdX1DsDpsSuFTDVUI0IFUv+dNinVYMIFAjnsnG1\\naADCIsZN6cHsas2+fFz5c5BUPBTAKxxnfpePiYAtEwKBgQD7Lh8uSgsHkaL2pCJt\\nQuUIYk+mR2JOml4GXqUqD/BaSLmVcQloUvDjjwVyKdUUiLDLsNpA3/hwj5OYwYpV\\n2KQp4dTltl0GWUBGq+JXSMVyTWPQKBR8wfGc1V8OvJvJ8ZRT1rqwyoXJU5mdhT8z\\nMf26gQRVf1Dyw0IhHYcydfksUwKBgQC+2lKqBm90JhsQgmfqBP4d2jhHiqOP/bgG\\nYtw3TgjfHvws1iPthHZkGmi5K01I1b3Rt8Nc6a1pSe/EohQVUpoLKnpmhekphyrk\\nJEV/SlPPlMPVGiClrK4EfZYbo9XBCeXpNcnUEdDeL9zDNlKUzocNnMLnOMwBnd4N\\nZ9hbHP4IPwKBgFaTXiH5WXXhZ9c1WbxpS0IpiKSahDLtmCz/4FPwLHsiB/2PeZug\\nwvDcchcYfh5WwwFiUsf7qsk5Y7lKNGFEi8j30wbeZY/zoWj6g8hsB8pPDHFJ703V\\nF29kSCBvOA9SGjsPj0eydoyfKRqXO+Jsf7USFSlW+dLDJH7/i4MEEL+LAoGBAIPX\\nXA2afnnVLRMdkt1l74n9yq0ZR95bnjnDJ2+JF7XSuM/caltVC1ghqkBoem4bQZLT\\niEDyKFo4ukqy0H7eXg3inUWfsi9+8ZFCwUOqu/UFRrc64lywylHN09lqN2qwBMQy\\n5Sb727bxh2bPawLjHQa5SSbj5IIlZVULbLmccJyPAoGBAIH09o1DqVH24HxZZSwH\\nAIC8ysdOAYlPsAWFvJry8VMv+zeNUd1NAykbhztMigteUuwIdLG3zZxPfCsGMn1Z\\nP9ZOAfDpbOd4Lha+1s3sclTS46KNjf+X48gqwnGfmnbqT84MlOnXBZIQRBH30EFC\\ngygqCsRl4KUuHm3Sbem012hT\\n-----END PRIVATE KEY-----\\n",\n  "client_email": "dbt-pl-ci-sa@pl-football-analytics.iam.gserviceaccount.com",\n  "client_id": "106750563153080302318",\n  "auth_uri": "https://accounts.google.com/o/oauth2/auth",\n  "token_uri": "https://oauth2.googleapis.com/token",\n  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",\n  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/dbt-pl-ci-sa%40pl-football-analytics.iam.gserviceaccount.com",\n  "universe_domain": "googleapis.com"\n}' is not valid under any of the given schemas


[0m19:25:40.355968 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 14.485803, "process_user_time": 8.714943, "process_kernel_time": 1.83622, "process_mem_max_rss": "188506112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:25:40.363194 [debug] [MainThread]: Command `dbt debug` failed at 19:25:40.362590 after 14.49 seconds
[0m19:25:40.365227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a742f10>]}
[0m19:25:40.367668 [debug] [MainThread]: Flushing usage events
[0m19:30:12.057541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106305090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6e50>]}


============================== 19:30:12.072660 | fd360098-8f72-4bc2-a209-4c6e1c935b4c ==============================
[0m19:30:12.072660 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:30:12.074282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'send_anonymous_usage_stats': 'True'}
[0m19:30:22.952075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba3510>]}
[0m19:30:23.133469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffda710>]}
[0m19:30:23.139512 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:30:24.160233 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:30:24.163395 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:30:24.167051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11054ff10>]}
[0m19:30:29.498138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110972650>]}
[0m19:30:29.608814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110807210>]}
[0m19:30:29.611251 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:30:29.629279 [info ] [MainThread]: 
[0m19:30:29.666718 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:30:29.670361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:30:29.671755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:29.679135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:30:29.680308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:30.530592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now create_pl-football-analytics_football_analytics_football_analytics)
[0m19:30:30.532832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now create_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:30:30.535585 [debug] [ThreadPool]: Creating schema "database: "pl-football-analytics"
schema: "football_analytics_football_analytics"
"
[0m19:30:30.537828 [debug] [ThreadPool]: Creating schema "database: "pl-football-analytics"
schema: "football_analytics_football_analytics_staging"
"
[0m19:30:30.583025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:30.587179 [debug] [ThreadPool]: On create_pl-football-analytics_football_analytics_football_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "connection_name": "create_pl-football-analytics_football_analytics_football_analytics"} */
create schema if not exists `pl-football-analytics`.`football_analytics_football_analytics`
  
[0m19:30:30.629569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:30.633698 [debug] [ThreadPool]: On create_pl-football-analytics_football_analytics_football_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "connection_name": "create_pl-football-analytics_football_analytics_football_analytics_staging"} */
create schema if not exists `pl-football-analytics`.`football_analytics_football_analytics_staging`
  
[0m19:30:31.741825 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c34567c8-5497-46d9-ba97-a7dd3624259d&page=queryresults
[0m19:30:31.858600 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:1c443709-538d-47ba-8be0-9036d9dbd0fe&page=queryresults
[0m19:30:34.669891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pl-football-analytics_football_analytics_football_analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:30:34.671625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pl-football-analytics_football_analytics_football_analytics_staging, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:30:34.672668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:34.673558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:35.066061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090bf10>]}
[0m19:30:35.068026 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:30:35.069121 [info ] [MainThread]: 
[0m19:30:35.109696 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:30:35.111532 [info ] [Thread-1 (]: 1 of 15 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:30:35.113640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:30:35.115033 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:30:35.188737 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:30:35.193568 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:30:35.115876 => 19:30:35.192661
[0m19:30:35.194933 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:30:35.410707 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:30:35.415904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:35.419901 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      parse_date('%Y-%m-%d', date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw

)

select * from typed;;


[0m19:30:35.787455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c57a0b87-947d-4ceb-9991-5256ae444ce7&page=queryresults
[0m19:30:35.788681 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [63:21]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [63:21]')
[0m19:30:36.849263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:efddbf45-d520-4aa5-ab86-56141c99fb4a&page=queryresults
[0m19:30:36.850966 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:efddbf45-d520-4aa5-ab86-56141c99fb4a&page=queryresults
[0m19:30:36.852853 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:30:35.195772 => 19:30:36.852130
[0m19:30:36.909142 [debug] [Thread-1 (]: Database Error in model stg_pl_matches (models/staging/stg_pl_matches.sql)
  Syntax error: Unexpected ";" at [63:21]
  compiled Code at target/run/premier_league_analytics/models/staging/stg_pl_matches.sql
[0m19:30:36.910664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd360098-8f72-4bc2-a209-4c6e1c935b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110506c90>]}
[0m19:30:36.912632 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[31mERROR[0m in 1.80s]
[0m19:30:36.915359 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:30:36.918137 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:30:36.919120 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:30:36.921104 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:30:36.923082 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:30:36.924080 [info ] [Thread-3 (]: 2 of 15 SKIP test not_null_stg_pl_matches_away_team_name ....................... [[33mSKIP[0m]
[0m19:30:36.930344 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:30:36.925268 [info ] [Thread-4 (]: 3 of 15 SKIP test not_null_stg_pl_matches_home_team_name ....................... [[33mSKIP[0m]
[0m19:30:36.928127 [info ] [Thread-1 (]: 5 of 15 SKIP test not_null_stg_pl_matches_match_id ............................. [[33mSKIP[0m]
[0m19:30:36.931720 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:30:36.926421 [info ] [Thread-2 (]: 4 of 15 SKIP test not_null_stg_pl_matches_match_date ........................... [[33mSKIP[0m]
[0m19:30:36.938566 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:30:36.940942 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:30:36.942519 [info ] [Thread-3 (]: 6 of 15 SKIP test unique_stg_pl_matches_match_id ............................... [[33mSKIP[0m]
[0m19:30:36.944015 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:30:36.946341 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:30:36.953279 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:30:36.959811 [info ] [Thread-4 (]: 7 of 15 SKIP relation football_analytics_football_analytics.dim_team ........... [[33mSKIP[0m]
[0m19:30:36.965879 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:30:36.972533 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:30:36.973953 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:30:36.975128 [info ] [Thread-2 (]: 8 of 15 SKIP test not_null_dim_team_team_id .................................... [[33mSKIP[0m]
[0m19:30:36.979429 [info ] [Thread-3 (]: 9 of 15 SKIP test unique_dim_team_team_id ...................................... [[33mSKIP[0m]
[0m19:30:36.986271 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:30:36.989628 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:30:36.991639 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:30:36.993564 [info ] [Thread-4 (]: 10 of 15 SKIP relation football_analytics_football_analytics.fct_match_results . [[33mSKIP[0m]
[0m19:30:36.995323 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:30:36.997988 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:30:37.007010 [info ] [Thread-2 (]: 11 of 15 SKIP test accepted_values_fct_match_results_result__H__A__D ........... [[33mSKIP[0m]
[0m19:30:37.011209 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:30:37.012553 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:30:37.014112 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:30:37.016185 [info ] [Thread-3 (]: 12 of 15 SKIP test not_null_fct_match_results_match_id ......................... [[33mSKIP[0m]
[0m19:30:37.020776 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:30:37.019136 [info ] [Thread-1 (]: 13 of 15 SKIP test unique_fct_match_results_match_id ........................... [[33mSKIP[0m]
[0m19:30:37.023792 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:30:37.033506 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:30:37.035968 [info ] [Thread-4 (]: 14 of 15 SKIP relation football_analytics_football_analytics.fct_team_season_stats  [[33mSKIP[0m]
[0m19:30:37.037477 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:30:37.040305 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:30:37.043192 [info ] [Thread-3 (]: 15 of 15 SKIP test unique_fct_team_season_stats_team_id_season ................. [[33mSKIP[0m]
[0m19:30:37.044868 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:30:37.050276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:37.051924 [debug] [MainThread]: Connection 'model.premier_league_analytics.stg_pl_matches' was properly closed.
[0m19:30:37.052656 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics_staging' was properly closed.
[0m19:30:37.054185 [info ] [MainThread]: 
[0m19:30:37.055519 [info ] [MainThread]: Finished running 1 view model, 11 tests, 3 table models in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m19:30:37.059453 [debug] [MainThread]: Command end result
[0m19:30:37.095090 [info ] [MainThread]: 
[0m19:30:37.097397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:37.099065 [info ] [MainThread]: 
[0m19:30:37.100477 [error] [MainThread]:   Database Error in model stg_pl_matches (models/staging/stg_pl_matches.sql)
  Syntax error: Unexpected ";" at [63:21]
  compiled Code at target/run/premier_league_analytics/models/staging/stg_pl_matches.sql
[0m19:30:37.102115 [info ] [MainThread]: 
[0m19:30:37.103459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m19:30:37.122886 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 25.284475, "process_user_time": 12.589444, "process_kernel_time": 2.14502, "process_mem_max_rss": "209899520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:30:37.124804 [debug] [MainThread]: Command `dbt build` failed at 19:30:37.124280 after 25.29 seconds
[0m19:30:37.126076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10192aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cced0>]}
[0m19:30:37.128205 [debug] [MainThread]: Flushing usage events
[0m19:34:32.030619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341d950>]}


============================== 19:34:32.051530 | 962fe281-bd5b-464b-98b2-b257758eaafe ==============================
[0m19:34:32.051530 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:34:32.053812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'send_anonymous_usage_stats': 'True'}
[0m19:34:38.400925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5e8350>]}
[0m19:34:38.515814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5d0f90>]}
[0m19:34:38.519732 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:34:38.576316 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:34:39.039318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:39.041644 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/staging/stg_pl_matches.sql
[0m19:34:39.810758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9fb710>]}
[0m19:34:39.844570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d981110>]}
[0m19:34:39.845640 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:34:39.853182 [info ] [MainThread]: 
[0m19:34:39.856003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:39.869369 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:34:39.871234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:34:39.874099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:39.882284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:40.395402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:34:40.399228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:34:40.401252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:40.403173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:40.849109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d152ad0>]}
[0m19:34:40.852769 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:34:40.854942 [info ] [MainThread]: 
[0m19:34:40.874591 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:34:40.875778 [info ] [Thread-1 (]: 1 of 15 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:34:40.877408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:34:40.878266 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:34:40.910113 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:34:40.914087 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:34:40.878758 => 19:34:40.913548
[0m19:34:40.914853 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:34:40.966958 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:34:40.969640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:40.971764 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      parse_date('%Y-%m-%d', date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw

)

select * from typed;


[0m19:34:41.655975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:44a0a0d1-d692-47f5-8cbf-8f8ab72eac65&page=queryresults
[0m19:34:41.804736 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function PARSE_DATE\n  Argument types: STRING, DATE\n  Signature: PARSE_DATE(STRING, STRING)\n    Argument 2: Unable to coerce type DATE to expected type STRING at [43:7]; reason: invalidQuery, location: query, message: No matching signature for function PARSE_DATE\n  Argument types: STRING, DATE\n  Signature: PARSE_DATE(STRING, STRING)\n    Argument 2: Unable to coerce type DATE to expected type STRING at [43:7]')
[0m19:34:42.515665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:36f3129a-ccc1-4de9-8bd1-62247ffb72f1&page=queryresults
[0m19:34:42.601051 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:36f3129a-ccc1-4de9-8bd1-62247ffb72f1&page=queryresults
[0m19:34:42.603820 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:34:40.915264 => 19:34:42.603130
[0m19:34:42.648356 [debug] [Thread-1 (]: Database Error in model stg_pl_matches (models/staging/stg_pl_matches.sql)
  No matching signature for function PARSE_DATE
    Argument types: STRING, DATE
    Signature: PARSE_DATE(STRING, STRING)
      Argument 2: Unable to coerce type DATE to expected type STRING at [43:7]
  compiled Code at target/run/premier_league_analytics/models/staging/stg_pl_matches.sql
[0m19:34:42.649828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '962fe281-bd5b-464b-98b2-b257758eaafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dafe690>]}
[0m19:34:42.651337 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[31mERROR[0m in 1.77s]
[0m19:34:42.653643 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:34:42.656945 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:34:42.658860 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:34:42.660185 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:34:42.660963 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:34:42.661914 [info ] [Thread-3 (]: 2 of 15 SKIP test not_null_stg_pl_matches_away_team_name ....................... [[33mSKIP[0m]
[0m19:34:42.662810 [info ] [Thread-4 (]: 3 of 15 SKIP test not_null_stg_pl_matches_home_team_name ....................... [[33mSKIP[0m]
[0m19:34:42.663671 [info ] [Thread-2 (]: 4 of 15 SKIP test not_null_stg_pl_matches_match_date ........................... [[33mSKIP[0m]
[0m19:34:42.664483 [info ] [Thread-1 (]: 5 of 15 SKIP test not_null_stg_pl_matches_match_id ............................. [[33mSKIP[0m]
[0m19:34:42.665458 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:34:42.666327 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:34:42.666960 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:34:42.667563 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:34:42.668937 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:34:42.670881 [info ] [Thread-3 (]: 6 of 15 SKIP test unique_stg_pl_matches_match_id ............................... [[33mSKIP[0m]
[0m19:34:42.672687 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:34:42.674274 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:34:42.675188 [info ] [Thread-4 (]: 7 of 15 SKIP relation football_analytics_football_analytics.dim_team ........... [[33mSKIP[0m]
[0m19:34:42.676224 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:34:42.682213 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:34:42.683008 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:34:42.683949 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_team_team_id .................................... [[33mSKIP[0m]
[0m19:34:42.685406 [info ] [Thread-3 (]: 9 of 15 SKIP test unique_dim_team_team_id ...................................... [[33mSKIP[0m]
[0m19:34:42.686982 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:34:42.688223 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:34:42.691219 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:34:42.695386 [info ] [Thread-4 (]: 10 of 15 SKIP relation football_analytics_football_analytics.fct_match_results . [[33mSKIP[0m]
[0m19:34:42.701377 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:34:42.704947 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:34:42.710149 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:34:42.711509 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:34:42.707403 [info ] [Thread-1 (]: 11 of 15 SKIP test accepted_values_fct_match_results_result__H__A__D ........... [[33mSKIP[0m]
[0m19:34:42.712552 [info ] [Thread-3 (]: 12 of 15 SKIP test not_null_fct_match_results_match_id ......................... [[33mSKIP[0m]
[0m19:34:42.722172 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:34:42.715300 [info ] [Thread-2 (]: 13 of 15 SKIP test unique_fct_match_results_match_id ........................... [[33mSKIP[0m]
[0m19:34:42.723924 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:34:42.729237 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:34:42.746253 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:34:42.747954 [info ] [Thread-4 (]: 14 of 15 SKIP relation football_analytics_football_analytics.fct_team_season_stats  [[33mSKIP[0m]
[0m19:34:42.749541 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:34:42.751322 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:34:42.752731 [info ] [Thread-3 (]: 15 of 15 SKIP test unique_fct_team_season_stats_team_id_season ................. [[33mSKIP[0m]
[0m19:34:42.755096 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:34:42.769058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:42.773299 [debug] [MainThread]: Connection 'model.premier_league_analytics.stg_pl_matches' was properly closed.
[0m19:34:42.774128 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics_staging' was properly closed.
[0m19:34:42.775328 [info ] [MainThread]: 
[0m19:34:42.776528 [info ] [MainThread]: Finished running 1 view model, 11 tests, 3 table models in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m19:34:42.780158 [debug] [MainThread]: Command end result
[0m19:34:42.853225 [info ] [MainThread]: 
[0m19:34:42.854932 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:34:42.856547 [info ] [MainThread]: 
[0m19:34:42.857963 [error] [MainThread]:   Database Error in model stg_pl_matches (models/staging/stg_pl_matches.sql)
  No matching signature for function PARSE_DATE
    Argument types: STRING, DATE
    Signature: PARSE_DATE(STRING, STRING)
      Argument 2: Unable to coerce type DATE to expected type STRING at [43:7]
  compiled Code at target/run/premier_league_analytics/models/staging/stg_pl_matches.sql
[0m19:34:42.859349 [info ] [MainThread]: 
[0m19:34:42.860954 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m19:34:42.872123 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.028277, "process_user_time": 9.109848, "process_kernel_time": 1.98027, "process_mem_max_rss": "212389888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:34:42.873196 [debug] [MainThread]: Command `dbt build` failed at 19:34:42.872925 after 11.03 seconds
[0m19:34:42.879115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da62b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9def10>]}
[0m19:34:42.880047 [debug] [MainThread]: Flushing usage events
[0m19:49:57.505358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107986290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d5810>]}


============================== 19:49:57.517822 | c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b ==============================
[0m19:49:57.517822 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:49:57.519182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:04.083090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deb0d10>]}
[0m19:50:04.672648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116fc950>]}
[0m19:50:04.679873 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:50:04.929995 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:50:05.792057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:05.793862 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/staging/stg_pl_matches.sql
[0m19:50:07.140005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112026e50>]}
[0m19:50:07.222798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d74510>]}
[0m19:50:07.224306 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:50:07.234992 [info ] [MainThread]: 
[0m19:50:07.237572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:07.274525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:50:07.275811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:07.284842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:50:07.286094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:08.182039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:50:08.186393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:08.201394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:50:08.320638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:08.856193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb4b10>]}
[0m19:50:08.858884 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:50:08.860656 [info ] [MainThread]: 
[0m19:50:08.867633 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:50:08.869426 [info ] [Thread-1 (]: 1 of 15 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:50:08.871473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:50:08.872420 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:50:08.899886 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:50:08.909928 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:50:08.873005 => 19:50:08.908611
[0m19:50:08.913477 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:50:09.014316 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:50:09.018912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:09.022380 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw

)

select * from typed;


[0m19:50:09.633817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:000f3ebe-7af4-4b2a-88c1-cc1620576697&page=queryresults
[0m19:50:09.935428 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:50:08.914700 => 19:50:09.934751
[0m19:50:09.938389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e745d9-96ad-4d64-9c9c-28d8e5a29e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c3690>]}
[0m19:50:09.963023 [info ] [Thread-1 (]: 1 of 15 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m19:50:09.965276 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:50:09.967777 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:50:09.971149 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:50:09.973061 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:50:09.974360 [info ] [Thread-3 (]: 2 of 15 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m19:50:09.985059 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:50:09.978951 [info ] [Thread-4 (]: 3 of 15 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m19:50:09.981164 [info ] [Thread-2 (]: 4 of 15 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m19:50:10.001707 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:50:10.005825 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663'
[0m19:50:10.071945 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:50:10.017333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:50:10.118354 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:50:10.120612 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:50:10.121403 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:50:09.976513 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:50:10.130694 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:50:10.132845 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m19:50:10.136197 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (compile): 19:50:10.018164 => 19:50:10.135075
[0m19:50:10.137750 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (compile): 19:50:10.122364 => 19:50:10.136943
[0m19:50:10.139591 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (compile): 19:50:10.072798 => 19:50:10.138801
[0m19:50:10.142214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:50:10.144772 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:50:10.146084 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:50:10.147310 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:50:10.148750 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:50:10.269239 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:50:10.300618 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:50:10.301866 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:50:10.312195 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:50:10.314058 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (compile): 19:50:10.205440 => 19:50:10.313284
[0m19:50:10.317137 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:50:10.319262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:50:10.320790 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:50:10.322580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:10.331135 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:50:10.335119 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



      
    ) dbt_internal_test
[0m19:50:10.339913 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



      
    ) dbt_internal_test
[0m19:50:10.344250 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



      
    ) dbt_internal_test
[0m19:50:10.430450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:10.581806 [debug] [Thread-1 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



      
    ) dbt_internal_test
[0m19:50:14.344201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5b26cb48-518c-49fd-8f22-8c7deb703a3f&page=queryresults
[0m19:50:14.360737 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:75e5bd03-adb3-4779-a8a4-0c4ae3755935&page=queryresults
[0m19:50:14.466760 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:4d216238-f4c2-4cfb-a568-7505addcdaad&page=queryresults
[0m19:50:14.469641 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:21b0c51e-f523-4448-8185-125460b47548&page=queryresults
[0m19:50:14.655531 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (execute): 19:50:10.156418 => 19:50:14.654578
[0m19:50:14.658000 [info ] [Thread-2 (]: 4 of 15 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 4.65s]
[0m19:50:14.659943 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:50:14.661383 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:50:14.663340 [info ] [Thread-2 (]: 6 of 15 START test unique_stg_pl_matches_match_id .............................. [RUN]
[0m19:50:14.665355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:50:14.666652 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:50:14.688107 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:50:14.696493 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (compile): 19:50:14.667405 => 19:50:14.695660
[0m19:50:14.698256 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:50:14.706576 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:50:14.714307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:14.719264 [debug] [Thread-2 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:50:14.828278 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (execute): 19:50:10.149640 => 19:50:14.827543
[0m19:50:14.831812 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (execute): 19:50:10.323318 => 19:50:14.831099
[0m19:50:14.833854 [info ] [Thread-3 (]: 2 of 15 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 4.85s]
[0m19:50:14.836322 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (execute): 19:50:10.192310 => 19:50:14.835611
[0m19:50:14.838611 [error] [Thread-1 (]: 5 of 15 FAIL 8360 not_null_stg_pl_matches_match_id ............................. [[31mFAIL 8360[0m in 4.70s]
[0m19:50:14.842877 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:50:14.845195 [info ] [Thread-4 (]: 3 of 15 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 4.84s]
[0m19:50:14.847189 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:50:14.850052 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:50:15.826256 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:4e284355-f1ab-4c5e-90b4-398fea29f5e8&page=queryresults
[0m19:50:16.162602 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (execute): 19:50:14.699338 => 19:50:16.161744
[0m19:50:16.164652 [info ] [Thread-2 (]: 6 of 15 PASS unique_stg_pl_matches_match_id .................................... [[32mPASS[0m in 1.50s]
[0m19:50:16.166220 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:50:16.168399 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m19:50:16.170155 [info ] [Thread-3 (]: 7 of 15 SKIP relation football_analytics_football_analytics.dim_team ........... [[33mSKIP[0m]
[0m19:50:16.174001 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:50:16.177450 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:50:16.179096 [info ] [Thread-4 (]: 8 of 15 SKIP test not_null_dim_team_team_id .................................... [[33mSKIP[0m]
[0m19:50:16.182502 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:50:16.183647 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:50:16.184757 [info ] [Thread-2 (]: 9 of 15 SKIP test unique_dim_team_team_id ...................................... [[33mSKIP[0m]
[0m19:50:16.186907 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:50:16.192586 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:50:16.193948 [info ] [Thread-3 (]: 10 of 15 SKIP relation football_analytics_football_analytics.fct_match_results . [[33mSKIP[0m]
[0m19:50:16.195219 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:50:16.200736 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:50:16.207822 [info ] [Thread-4 (]: 11 of 15 SKIP test accepted_values_fct_match_results_result__H__A__D ........... [[33mSKIP[0m]
[0m19:50:16.202029 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:50:16.210142 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:50:16.205167 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:50:16.216097 [info ] [Thread-2 (]: 12 of 15 SKIP test not_null_fct_match_results_match_id ......................... [[33mSKIP[0m]
[0m19:50:16.225258 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:50:16.223415 [info ] [Thread-1 (]: 13 of 15 SKIP test unique_fct_match_results_match_id ........................... [[33mSKIP[0m]
[0m19:50:16.227992 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:50:16.239039 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:50:16.247285 [info ] [Thread-3 (]: 14 of 15 SKIP relation football_analytics_football_analytics.fct_team_season_stats  [[33mSKIP[0m]
[0m19:50:16.252149 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:50:16.303510 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:50:16.308006 [info ] [Thread-2 (]: 15 of 15 SKIP test unique_fct_team_season_stats_team_id_season ................. [[33mSKIP[0m]
[0m19:50:16.312418 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:50:16.326816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:16.328798 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2' was properly closed.
[0m19:50:16.330788 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8' was properly closed.
[0m19:50:16.332431 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666' was properly closed.
[0m19:50:16.336290 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663' was properly closed.
[0m19:50:16.342304 [info ] [MainThread]: 
[0m19:50:16.346147 [info ] [MainThread]: Finished running 1 view model, 11 tests, 3 table models in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m19:50:16.357309 [debug] [MainThread]: Command end result
[0m19:50:16.397110 [info ] [MainThread]: 
[0m19:50:16.398605 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:50:16.399866 [info ] [MainThread]: 
[0m19:50:16.401649 [error] [MainThread]: [31mFailure in test not_null_stg_pl_matches_match_id (models/schema.yml)[0m
[0m19:50:16.407109 [error] [MainThread]:   Got 8360 results, configured to fail if != 0
[0m19:50:16.408997 [info ] [MainThread]: 
[0m19:50:16.410624 [info ] [MainThread]:   compiled Code at target/compiled/premier_league_analytics/models/schema.yml/not_null_stg_pl_matches_match_id.sql
[0m19:50:16.411703 [info ] [MainThread]: 
[0m19:50:16.413458 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=9 TOTAL=15
[0m19:50:16.433371 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 19.057274, "process_user_time": 8.708204, "process_kernel_time": 1.683455, "process_mem_max_rss": "212574208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:50:16.434782 [debug] [MainThread]: Command `dbt build` failed at 19:50:16.434331 after 19.06 seconds
[0m19:50:16.436409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f83150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f82fd0>]}
[0m19:50:16.437946 [debug] [MainThread]: Flushing usage events
[0m19:52:58.419306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e81ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed3e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5d5d0>]}


============================== 19:52:58.432589 | c32b0c40-d3c7-4149-b310-e4bfb1855e25 ==============================
[0m19:52:58.432589 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:52:58.434303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:05.165631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed37710>]}
[0m19:53:05.311284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d44410>]}
[0m19:53:05.314562 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:53:05.406624 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:53:05.918552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:05.920952 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/staging/stg_pl_matches.sql
[0m19:53:06.780101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192fb690>]}
[0m19:53:06.829187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190de810>]}
[0m19:53:06.830876 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:53:06.856134 [info ] [MainThread]: 
[0m19:53:06.864603 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:06.869345 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:53:06.872517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:53:06.876288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:06.882889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:07.412112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:53:07.413984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:53:07.414989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:07.415693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:07.817270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119203910>]}
[0m19:53:07.818874 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:53:07.819952 [info ] [MainThread]: 
[0m19:53:07.830108 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:53:07.832149 [info ] [Thread-1 (]: 1 of 15 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:53:07.838746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:53:07.843304 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:53:07.876545 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:53:07.880006 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:53:07.845863 => 19:53:07.879278
[0m19:53:07.881319 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:53:07.969278 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:53:07.973349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:07.976634 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw
    where season is not null
      and match_num is not null

)

select * from typed;


[0m19:53:08.880212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:24a01746-b61f-410a-88a1-429b6de7a2c2&page=queryresults
[0m19:53:09.127357 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:53:07.881963 => 19:53:09.126771
[0m19:53:09.129324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119263610>]}
[0m19:53:09.130688 [info ] [Thread-1 (]: 1 of 15 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m19:53:09.132932 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:53:09.135935 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:09.137973 [info ] [Thread-3 (]: 2 of 15 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m19:53:09.142943 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:53:09.144669 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:09.152005 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:09.153636 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:09.197173 [info ] [Thread-4 (]: 3 of 15 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m19:53:09.156955 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:09.200380 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663'
[0m19:53:09.188599 [info ] [Thread-2 (]: 4 of 15 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m19:53:09.214745 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:53:09.215935 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m19:53:09.217594 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:09.220806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:53:09.230964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:53:09.242133 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (compile): 19:53:09.158604 => 19:53:09.237344
[0m19:53:09.252438 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:53:09.254497 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:09.259260 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:09.260702 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:09.273457 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:53:09.281190 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (compile): 19:53:09.231844 => 19:53:09.280106
[0m19:53:09.287888 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:53:09.333130 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:09.339261 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (compile): 19:53:09.262132 => 19:53:09.338262
[0m19:53:09.372550 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:53:09.373644 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (compile): 19:53:09.274825 => 19:53:09.373172
[0m19:53:09.374783 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:53:09.376089 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:09.377739 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:09.385176 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:09.383911 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:53:09.394740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:53:09.396502 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:53:09.401793 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



      
    ) dbt_internal_test
[0m19:53:09.403361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:09.408335 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



      
    ) dbt_internal_test
[0m19:53:09.472493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:09.477107 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



      
    ) dbt_internal_test
[0m19:53:09.611565 [debug] [Thread-1 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



      
    ) dbt_internal_test
[0m19:53:10.621442 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:32fd85c5-e19f-47b8-bdaa-eb3afa16cac5&page=queryresults
[0m19:53:10.622928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:6e925c71-ef3f-4bea-9b49-efed01d36c3f&page=queryresults
[0m19:53:10.624873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:56b35a47-8c27-45b7-9fee-7e1b6c27c670&page=queryresults
[0m19:53:10.649355 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:d4eb954b-1492-44b0-a825-4e1cb4c432f2&page=queryresults
[0m19:53:10.951829 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (execute): 19:53:09.358041 => 19:53:10.951100
[0m19:53:10.954448 [info ] [Thread-4 (]: 3 of 15 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.76s]
[0m19:53:10.957206 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:10.959550 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (execute): 19:53:09.379070 => 19:53:10.958990
[0m19:53:10.961107 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:10.966095 [info ] [Thread-2 (]: 4 of 15 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 1.75s]
[0m19:53:10.967794 [info ] [Thread-4 (]: 6 of 15 START test unique_stg_pl_matches_match_id .............................. [RUN]
[0m19:53:10.978967 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (execute): 19:53:09.289390 => 19:53:10.978313
[0m19:53:10.980683 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (execute): 19:53:09.387316 => 19:53:10.980232
[0m19:53:10.981786 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:10.986613 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:53:10.990588 [info ] [Thread-3 (]: 2 of 15 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 1.85s]
[0m19:53:10.995806 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.76s]
[0m19:53:10.999139 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:11.001670 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:11.003934 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:11.031707 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:53:11.036597 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (compile): 19:53:11.008315 => 19:53:11.035733
[0m19:53:11.038767 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:11.046850 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:53:11.052065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:53:11.057215 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:12.054484 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f6f103ad-df7f-48cf-bbee-fb18c0946172&page=queryresults
[0m19:53:12.386566 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (execute): 19:53:11.039935 => 19:53:12.385773
[0m19:53:12.389359 [info ] [Thread-4 (]: 6 of 15 PASS unique_stg_pl_matches_match_id .................................... [[32mPASS[0m in 1.40s]
[0m19:53:12.391535 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:12.393860 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.dim_team
[0m19:53:12.395391 [info ] [Thread-2 (]: 7 of 15 START sql table model football_analytics_football_analytics.dim_team ... [RUN]
[0m19:53:12.404759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now model.premier_league_analytics.dim_team)
[0m19:53:12.409319 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:53:12.422451 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:53:12.428072 [debug] [Thread-2 (]: Timing info for model.premier_league_analytics.dim_team (compile): 19:53:12.411008 => 19:53:12.427070
[0m19:53:12.429688 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:53:12.512039 [debug] [Thread-2 (]: Writing runtime sql for node "model.premier_league_analytics.dim_team"
[0m19:53:12.514884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:12.518345 [debug] [Thread-2 (]: On model.premier_league_analytics.dim_team: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.dim_team"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
      
    
    

    OPTIONS()
    as (
      with teams as (

    select
      home_team_name as team_name,
      home_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

    union distinct

    select
      away_team_name as team_name,
      away_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

),

final as (

    select
      generate_uuid() as team_id,
      team_name,
      team_code
    from teams

)

select * from final;
    );
  
[0m19:53:12.853289 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:a9dd488b-1296-4f1d-b493-4a70a8c62805&page=queryresults
[0m19:53:12.854988 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [39:20]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [39:20]')
[0m19:53:13.724598 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9908b725-3cc8-46f4-89b1-7b17dc3648a5&page=queryresults
[0m19:53:13.725873 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9908b725-3cc8-46f4-89b1-7b17dc3648a5&page=queryresults
[0m19:53:13.727293 [debug] [Thread-2 (]: Timing info for model.premier_league_analytics.dim_team (execute): 19:53:12.430648 => 19:53:13.726788
[0m19:53:13.776627 [debug] [Thread-2 (]: Database Error in model dim_team (models/marts/dim_team.sql)
  Syntax error: Expected ")" but got ";" at [39:20]
  compiled Code at target/run/premier_league_analytics/models/marts/dim_team.sql
[0m19:53:13.777979 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32b0c40-d3c7-4149-b310-e4bfb1855e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11954bbd0>]}
[0m19:53:13.779297 [error] [Thread-2 (]: 7 of 15 ERROR creating sql table model football_analytics_football_analytics.dim_team  [[31mERROR[0m in 1.37s]
[0m19:53:13.780847 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:53:13.783401 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:13.784719 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:13.787220 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_team_team_id .................................... [[33mSKIP[0m]
[0m19:53:13.789116 [info ] [Thread-4 (]: 9 of 15 SKIP test unique_dim_team_team_id ...................................... [[33mSKIP[0m]
[0m19:53:13.791389 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:13.805722 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:13.808417 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:53:13.810304 [info ] [Thread-2 (]: 10 of 15 SKIP relation football_analytics_football_analytics.fct_match_results . [[33mSKIP[0m]
[0m19:53:13.812362 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:53:13.840023 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:13.843009 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:13.844586 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:13.846351 [info ] [Thread-4 (]: 12 of 15 SKIP test not_null_fct_match_results_match_id ......................... [[33mSKIP[0m]
[0m19:53:13.848525 [info ] [Thread-1 (]: 11 of 15 SKIP test accepted_values_fct_match_results_result__H__A__D ........... [[33mSKIP[0m]
[0m19:53:13.850733 [info ] [Thread-3 (]: 13 of 15 SKIP test unique_fct_match_results_match_id ........................... [[33mSKIP[0m]
[0m19:53:13.854472 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:13.858859 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:13.860633 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:13.863172 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:13.864531 [info ] [Thread-2 (]: 14 of 15 SKIP relation football_analytics_football_analytics.fct_team_season_stats  [[33mSKIP[0m]
[0m19:53:13.866884 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:13.868459 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:13.871106 [info ] [Thread-1 (]: 15 of 15 SKIP test unique_fct_team_season_stats_team_id_season ................. [[33mSKIP[0m]
[0m19:53:13.875051 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:13.883425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:13.886024 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2' was properly closed.
[0m19:53:13.888435 [debug] [MainThread]: Connection 'model.premier_league_analytics.dim_team' was properly closed.
[0m19:53:13.892045 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666' was properly closed.
[0m19:53:13.893554 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8' was properly closed.
[0m19:53:13.895324 [info ] [MainThread]: 
[0m19:53:13.896898 [info ] [MainThread]: Finished running 1 view model, 11 tests, 3 table models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m19:53:13.905810 [debug] [MainThread]: Command end result
[0m19:53:14.007098 [info ] [MainThread]: 
[0m19:53:14.010204 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:14.011590 [info ] [MainThread]: 
[0m19:53:14.012905 [error] [MainThread]:   Database Error in model dim_team (models/marts/dim_team.sql)
  Syntax error: Expected ")" but got ";" at [39:20]
  compiled Code at target/run/premier_league_analytics/models/marts/dim_team.sql
[0m19:53:14.014893 [info ] [MainThread]: 
[0m19:53:14.016635 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=8 TOTAL=15
[0m19:53:14.048012 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 15.83146, "process_user_time": 10.837635, "process_kernel_time": 2.065311, "process_mem_max_rss": "217841664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:14.049818 [debug] [MainThread]: Command `dbt build` failed at 19:53:14.049329 after 15.83 seconds
[0m19:53:14.054191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30f150>]}
[0m19:53:14.056302 [debug] [MainThread]: Flushing usage events
[0m19:56:50.157221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d96050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de1510>]}


============================== 19:56:50.180615 | 38c65768-5bea-40d4-9308-1125a370148c ==============================
[0m19:56:50.180615 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:56:50.183077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir dbt --target ci', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:57:01.074116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d6f9d0>]}
[0m19:57:01.263369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb41790>]}
[0m19:57:01.267014 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:57:01.378552 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:57:02.213226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:57:02.215414 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_match_results.sql
[0m19:57:02.217101 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/dim_team.sql
[0m19:57:02.218666 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:57:03.264022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c43c150>]}
[0m19:57:03.346149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0a1550>]}
[0m19:57:03.349198 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:57:03.409102 [info ] [MainThread]: 
[0m19:57:03.412742 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:03.418271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:57:03.420826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:57:03.423063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:03.425657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:04.148241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:57:04.150678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:57:04.152084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:04.153558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:04.579883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3b5cd0>]}
[0m19:57:04.581692 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:57:04.582697 [info ] [MainThread]: 
[0m19:57:04.593621 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:57:04.595574 [info ] [Thread-1 (]: 1 of 15 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:57:04.603403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:57:04.605016 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:57:04.634979 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:57:04.640125 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:57:04.605971 => 19:57:04.639246
[0m19:57:04.641681 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:57:04.782057 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:57:04.788101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:04.795968 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw
    where season is not null
      and match_num is not null

)

select * from typed;


[0m19:57:05.461750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:87d28658-66c4-4814-ac87-1d34af4afa00&page=queryresults
[0m19:57:05.714788 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:57:04.642634 => 19:57:05.714052
[0m19:57:05.717052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5334d0>]}
[0m19:57:05.718752 [info ] [Thread-1 (]: 1 of 15 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m19:57:05.721760 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:57:05.724185 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:57:05.725750 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:57:05.728718 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:57:05.733073 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:57:05.731186 [info ] [Thread-3 (]: 2 of 15 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m19:57:05.735353 [info ] [Thread-4 (]: 3 of 15 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m19:57:05.743143 [info ] [Thread-2 (]: 4 of 15 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m19:57:05.744966 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m19:57:05.752657 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:57:05.755613 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663'
[0m19:57:05.763200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:57:05.768242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:57:05.770259 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:57:05.771858 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:57:05.774430 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:57:05.776446 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:57:05.808695 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:57:05.819585 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:57:05.829104 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:57:05.860602 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (compile): 19:57:05.777426 => 19:57:05.859903
[0m19:57:05.874111 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (compile): 19:57:05.809473 => 19:57:05.873408
[0m19:57:05.881143 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:57:05.892151 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (compile): 19:57:05.820449 => 19:57:05.890986
[0m19:57:05.894248 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:57:05.895843 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:57:05.919209 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:57:05.934387 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:57:05.944455 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:57:05.951897 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (compile): 19:57:05.829854 => 19:57:05.951055
[0m19:57:05.955086 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:57:05.957839 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:57:05.959976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:57:05.966305 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:57:05.967897 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:57:05.969106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:05.973271 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



      
    ) dbt_internal_test
[0m19:57:05.974963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:05.979064 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



      
    ) dbt_internal_test
[0m19:57:06.049149 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



      
    ) dbt_internal_test
[0m19:57:06.181252 [debug] [Thread-1 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



      
    ) dbt_internal_test
[0m19:57:07.135003 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:1fdeaa4d-e697-413c-9508-5a1d95324cd2&page=queryresults
[0m19:57:07.143261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c08a5a0d-eeb6-472c-a876-68ac0e01f4ed&page=queryresults
[0m19:57:07.152088 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:8d2683bb-6c52-43ff-aa91-2bb6664f179e&page=queryresults
[0m19:57:07.156379 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9a206353-edc2-46e8-b2ef-c8661caf0f0f&page=queryresults
[0m19:57:07.429492 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (execute): 19:57:05.936007 => 19:57:07.428772
[0m19:57:07.431723 [info ] [Thread-4 (]: 3 of 15 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.68s]
[0m19:57:07.433616 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:57:07.435460 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:57:07.439772 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (execute): 19:57:05.960815 => 19:57:07.438650
[0m19:57:07.441952 [info ] [Thread-4 (]: 6 of 15 START test unique_stg_pl_matches_match_id .............................. [RUN]
[0m19:57:07.445208 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.68s]
[0m19:57:07.452809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:57:07.455165 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:57:07.456869 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:57:07.474800 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (execute): 19:57:05.897014 => 19:57:07.473799
[0m19:57:07.487392 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:57:07.490238 [info ] [Thread-3 (]: 2 of 15 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 1.74s]
[0m19:57:07.493225 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:57:07.501182 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (execute): 19:57:05.945501 => 19:57:07.500012
[0m19:57:07.502767 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (compile): 19:57:07.458048 => 19:57:07.502017
[0m19:57:07.506069 [info ] [Thread-2 (]: 4 of 15 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 1.75s]
[0m19:57:07.507774 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:57:07.509360 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:57:07.521868 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:57:07.525363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:57:07.533210 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:08.496096 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c2835513-a7c2-4a7c-bcf3-301538623c32&page=queryresults
[0m19:57:08.771848 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (execute): 19:57:07.510360 => 19:57:08.771332
[0m19:57:08.774169 [info ] [Thread-4 (]: 6 of 15 PASS unique_stg_pl_matches_match_id .................................... [[32mPASS[0m in 1.33s]
[0m19:57:08.775819 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:57:08.777608 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.dim_team
[0m19:57:08.779409 [info ] [Thread-1 (]: 7 of 15 START sql table model football_analytics_football_analytics.dim_team ... [RUN]
[0m19:57:08.781624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now model.premier_league_analytics.dim_team)
[0m19:57:08.784053 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:57:08.804986 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:57:08.809557 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.dim_team (compile): 19:57:08.785189 => 19:57:08.809040
[0m19:57:08.810414 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:57:08.900773 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.dim_team"
[0m19:57:08.905579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:08.909184 [debug] [Thread-1 (]: On model.premier_league_analytics.dim_team: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.dim_team"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
      
    
    

    OPTIONS()
    as (
      with teams as (

    select
      home_team_name as team_name,
      home_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

    union distinct

    select
      away_team_name as team_name,
      away_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

),

final as (

    select
      generate_uuid() as team_id,
      team_name,
      team_code
    from teams

)

select * from final
    );
  
[0m19:57:09.725917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f0eaf806-4b48-4b7d-b497-afa49bb5d28b&page=queryresults
[0m19:57:11.143336 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.dim_team (execute): 19:57:08.810900 => 19:57:11.142857
[0m19:57:11.146001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1d34d0>]}
[0m19:57:11.147878 [info ] [Thread-1 (]: 7 of 15 OK created sql table model football_analytics_football_analytics.dim_team  [[32mCREATE TABLE (0.0 rows, 346.8 KiB processed)[0m in 2.37s]
[0m19:57:11.150118 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:57:11.152390 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:57:11.153703 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:57:11.155563 [info ] [Thread-2 (]: 8 of 15 START test not_null_dim_team_team_id ................................... [RUN]
[0m19:57:11.158669 [info ] [Thread-4 (]: 9 of 15 START test unique_dim_team_team_id ..................................... [RUN]
[0m19:57:11.163195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:57:11.179584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:57:11.181912 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:57:11.184357 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:57:11.228605 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:57:11.264518 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:57:11.266035 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (compile): 19:57:11.205189 => 19:57:11.265464
[0m19:57:11.267291 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:57:11.274626 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (compile): 19:57:11.185482 => 19:57:11.273753
[0m19:57:11.275834 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:57:11.279568 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:57:11.289684 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:57:11.292251 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:57:11.298263 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_dim_team_team_id.069cd44695: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select team_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
  where team_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:11.300224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:11.306146 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
where team_id is null



      
    ) dbt_internal_test
[0m19:57:11.950239 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:b0f1f2a9-fd99-41b0-ae86-b1b283a23555&page=queryresults
[0m19:57:12.062859 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:46e71d58-b027-4bdb-a9bb-a55cffabed78&page=queryresults
[0m19:57:12.255535 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (execute): 19:57:11.268091 => 19:57:12.254783
[0m19:57:12.258048 [info ] [Thread-4 (]: 9 of 15 PASS unique_dim_team_team_id ........................................... [[32mPASS[0m in 1.08s]
[0m19:57:12.259825 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:57:12.329899 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (execute): 19:57:11.281976 => 19:57:12.329083
[0m19:57:12.332552 [info ] [Thread-2 (]: 8 of 15 PASS not_null_dim_team_team_id ......................................... [[32mPASS[0m in 1.17s]
[0m19:57:12.334560 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:57:12.337416 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:57:12.338993 [info ] [Thread-1 (]: 10 of 15 START sql table model football_analytics_football_analytics.fct_match_results  [RUN]
[0m19:57:12.341325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now model.premier_league_analytics.fct_match_results)
[0m19:57:12.343789 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:57:12.355299 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:57:12.360891 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.fct_match_results (compile): 19:57:12.345799 => 19:57:12.358564
[0m19:57:12.365323 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:57:12.375394 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_match_results"
[0m19:57:12.381172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:12.385670 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_match_results: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.fct_match_results"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
      
    
    

    OPTIONS()
    as (
      with matches as (

    select
      m.*,
      t_home.team_id as home_team_id,
      t_away.team_id as away_team_id
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches` m
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_home
      on m.home_team_name = t_home.team_name
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_away
      on m.away_team_name = t_away.team_name

),

results as (

    select
      match_id,
      season,
      season_start_year,
      season_end_year,
      match_date,
      round_number,
      round_name,

      home_team_id,
      home_team_name,
      away_team_id,
      away_team_name,

      home_goals,
      away_goals,

      case
        when home_goals > away_goals then 'H'
        when home_goals < away_goals then 'A'
        when home_goals = away_goals then 'D'
        else null
      end as result,

      case
        when home_goals > away_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as home_points,

      case
        when away_goals > home_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as away_points
    from matches

)

select * from results
    );
  
[0m19:57:13.206764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:18845034-7f5f-4d05-8bfd-99f449c608f6&page=queryresults
[0m19:57:14.624023 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.fct_match_results (execute): 19:57:12.366142 => 19:57:14.623542
[0m19:57:14.625856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5ea310>]}
[0m19:57:14.627022 [info ] [Thread-1 (]: 10 of 15 OK created sql table model football_analytics_football_analytics.fct_match_results  [[32mCREATE TABLE (0.0 rows, 712.3 KiB processed)[0m in 2.29s]
[0m19:57:14.628348 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:57:14.630174 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:57:14.631059 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:57:14.631945 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:57:14.633217 [info ] [Thread-4 (]: 11 of 15 START test accepted_values_fct_match_results_result__H__A__D .......... [RUN]
[0m19:57:14.636088 [info ] [Thread-2 (]: 12 of 15 START test not_null_fct_match_results_match_id ........................ [RUN]
[0m19:57:14.637727 [info ] [Thread-3 (]: 13 of 15 START test unique_fct_match_results_match_id .......................... [RUN]
[0m19:57:14.641117 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:57:14.650249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:57:14.652533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:57:14.655093 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:57:14.657259 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:57:14.661172 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:57:14.682746 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:57:14.683925 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:57:14.698104 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:57:14.702031 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (compile): 19:57:14.662545 => 19:57:14.701178
[0m19:57:14.704401 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (compile): 19:57:14.668039 => 19:57:14.703099
[0m19:57:14.707605 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (compile): 19:57:14.684755 => 19:57:14.706038
[0m19:57:14.709002 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:57:14.710489 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:57:14.711509 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:57:14.719947 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:57:14.735891 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:57:14.754677 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:57:14.756629 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:57:14.761842 [debug] [Thread-4 (]: On test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        result as value_field,
        count(*) as n_records

    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
    group by result

)

select *
from all_values
where value_field not in (
    'H','A','D'
)



      
    ) dbt_internal_test
[0m19:57:14.763531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:14.765120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:57:14.839149 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
where match_id is null



      
    ) dbt_internal_test
[0m19:57:14.848205 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:15.664363 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:7f94d680-8693-469a-b885-13da9ac680d7&page=queryresults
[0m19:57:15.674415 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:615272bc-a1f1-4d90-95a3-4709b3fd804a&page=queryresults
[0m19:57:15.755741 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:734868a3-8436-4b70-94ff-f1600318b168&page=queryresults
[0m19:57:15.959056 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (execute): 19:57:14.730821 => 19:57:15.958495
[0m19:57:15.960788 [info ] [Thread-3 (]: 13 of 15 PASS unique_fct_match_results_match_id ................................ [[32mPASS[0m in 1.31s]
[0m19:57:15.962332 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:57:15.977415 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (execute): 19:57:14.720741 => 19:57:15.976855
[0m19:57:15.979243 [info ] [Thread-2 (]: 12 of 15 PASS not_null_fct_match_results_match_id .............................. [[32mPASS[0m in 1.33s]
[0m19:57:15.980908 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:57:16.038535 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (execute): 19:57:14.712254 => 19:57:16.038009
[0m19:57:16.044553 [info ] [Thread-4 (]: 11 of 15 PASS accepted_values_fct_match_results_result__H__A__D ................ [[32mPASS[0m in 1.40s]
[0m19:57:16.046724 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:57:16.049167 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:57:16.050912 [info ] [Thread-1 (]: 14 of 15 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:57:16.053095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now model.premier_league_analytics.fct_team_season_stats)
[0m19:57:16.054128 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:57:16.071313 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:57:16.076232 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.fct_team_season_stats (compile): 19:57:16.054670 => 19:57:16.075127
[0m19:57:16.077654 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:57:16.097118 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:57:16.104793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:16.110904 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select * from agg
    );
  
[0m19:57:16.751340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:963082f8-d359-488e-b50a-ebb9cb471d72&page=queryresults
[0m19:57:20.212016 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.fct_team_season_stats (execute): 19:57:16.078563 => 19:57:20.211628
[0m19:57:20.213495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c65768-5bea-40d4-9308-1125a370148c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c59fd10>]}
[0m19:57:20.215087 [info ] [Thread-1 (]: 14 of 15 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.16s]
[0m19:57:20.216699 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:57:20.218187 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:57:20.219193 [info ] [Thread-2 (]: 15 of 15 START test unique_fct_team_season_stats_team_id_season ................ [RUN]
[0m19:57:20.220638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:57:20.222152 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:57:20.242011 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:57:20.244324 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (compile): 19:57:20.223338 => 19:57:20.243584
[0m19:57:20.245702 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:57:20.253458 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:57:20.257395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:20.261666 [debug] [Thread-2 (]: On test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select team_id || '-' || season as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
  where team_id || '-' || season is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:20.915629 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:da5f69d0-a22b-4e00-95b0-d03d55d7f214&page=queryresults
[0m19:57:21.227278 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (execute): 19:57:20.246585 => 19:57:21.226516
[0m19:57:21.229712 [info ] [Thread-2 (]: 15 of 15 PASS unique_fct_team_season_stats_team_id_season ...................... [[32mPASS[0m in 1.01s]
[0m19:57:21.231737 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:57:21.236687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:21.240591 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:57:21.243193 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:57:21.246885 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:57:21.249319 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:57:21.250821 [info ] [MainThread]: 
[0m19:57:21.252185 [info ] [MainThread]: Finished running 1 view model, 11 tests, 3 table models in 0 hours 0 minutes and 17.84 seconds (17.84s).
[0m19:57:21.267419 [debug] [MainThread]: Command end result
[0m19:57:21.312936 [info ] [MainThread]: 
[0m19:57:21.314387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:21.315771 [info ] [MainThread]: 
[0m19:57:21.316991 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m19:57:21.334275 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 31.643513, "process_user_time": 12.802668, "process_kernel_time": 2.29383, "process_mem_max_rss": "210669568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:57:21.336134 [debug] [MainThread]: Command `dbt build` succeeded at 19:57:21.335511 after 31.65 seconds
[0m19:57:21.338334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d422ed0>]}
[0m19:57:21.339698 [debug] [MainThread]: Flushing usage events
[0m19:58:35.652648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb9490>]}


============================== 19:58:35.669099 | e4eaa573-0645-4b2c-be09-17b2f9899ecd ==============================
[0m19:58:35.669099 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:58:35.671638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness --project-dir dbt --target ci', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:42.424941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4eaa573-0645-4b2c-be09-17b2f9899ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b57250>]}
[0m19:58:42.664734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4eaa573-0645-4b2c-be09-17b2f9899ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ffb950>]}
[0m19:58:42.668530 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:58:42.775865 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:58:43.474798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:43.476957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:43.503655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4eaa573-0645-4b2c-be09-17b2f9899ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8ee410>]}
[0m19:58:43.558717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4eaa573-0645-4b2c-be09-17b2f9899ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731c90>]}
[0m19:58:43.560026 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:58:43.561443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4eaa573-0645-4b2c-be09-17b2f9899ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140cfd90>]}
[0m19:58:43.572496 [info ] [MainThread]: 
[0m19:58:43.575603 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:58:43.890967 [info ] [MainThread]: Done.
[0m19:58:43.908358 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 8.455747, "process_user_time": 7.827717, "process_kernel_time": 1.839138, "process_mem_max_rss": "193380352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:58:43.911632 [debug] [MainThread]: Command `dbt source freshness` succeeded at 19:58:43.911103 after 8.46 seconds
[0m19:58:43.913455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a39990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105577290>]}
[0m19:58:43.915794 [debug] [MainThread]: Flushing usage events
[0m19:59:12.614916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105462390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105438290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a9590>]}


============================== 19:59:12.625017 | b0f4fa07-c5b4-430b-829a-2238d5d8dd6e ==============================
[0m19:59:12.625017 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:59:12.626063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --project-dir dbt --target ci', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:59:17.959213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f614ad0>]}
[0m19:59:18.074148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a0510>]}
[0m19:59:18.077449 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:59:18.137165 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m19:59:18.609651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:18.610815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:18.625592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f82c950>]}
[0m19:59:18.635557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ffa10>]}
[0m19:59:18.637296 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:59:18.638861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf03d0>]}
[0m19:59:18.647384 [info ] [MainThread]: 
[0m19:59:18.656067 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:59:18.663342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:59:18.664583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:18.667480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:59:18.670159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:19.311799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0f4fa07-c5b4-430b-829a-2238d5d8dd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a5c10>]}
[0m19:59:19.313345 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m19:59:19.314382 [info ] [MainThread]: 
[0m19:59:19.322743 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:59:19.326390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:59:19.331310 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:59:19.358868 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:59:19.362768 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 19:59:19.332480 => 19:59:19.362195
[0m19:59:19.363584 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:59:19.364499 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 19:59:19.364064 => 19:59:19.364112
[0m19:59:19.366495 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:59:19.368714 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m19:59:19.369931 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:59:19.371335 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:59:19.373851 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:59:19.376177 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:59:19.379285 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:59:19.380832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:59:19.382783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:59:19.384233 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:59:19.385781 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:59:19.387292 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:59:19.389055 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:59:19.399521 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:59:19.426565 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:59:19.437257 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:59:19.451561 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:59:19.463317 [debug] [Thread-3 (]: Timing info for model.premier_league_analytics.dim_team (compile): 19:59:19.390636 => 19:59:19.462467
[0m19:59:19.465066 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:59:19.466114 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (compile): 19:59:19.400558 => 19:59:19.465566
[0m19:59:19.467070 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (compile): 19:59:19.427055 => 19:59:19.466665
[0m19:59:19.467950 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (compile): 19:59:19.438244 => 19:59:19.467505
[0m19:59:19.468775 [debug] [Thread-3 (]: Timing info for model.premier_league_analytics.dim_team (execute): 19:59:19.468370 => 19:59:19.468391
[0m19:59:19.469512 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:59:19.470192 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:59:19.470840 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:59:19.473146 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:59:19.475057 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (execute): 19:59:19.474355 => 19:59:19.474378
[0m19:59:19.476370 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (execute): 19:59:19.475847 => 19:59:19.475866
[0m19:59:19.477299 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (execute): 19:59:19.476890 => 19:59:19.476904
[0m19:59:19.478353 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:59:19.480744 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:59:19.483431 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:59:19.487003 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:59:19.489066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:59:19.490798 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:59:19.492438 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:59:19.495116 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:59:19.496574 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:59:19.499223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:59:19.501470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now model.premier_league_analytics.fct_match_results)
[0m19:59:19.503605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:59:19.515850 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:59:19.516883 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:59:19.517684 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:59:19.518607 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:59:19.539598 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:59:19.549005 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:59:19.556718 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (compile): 19:59:19.504566 => 19:59:19.555842
[0m19:59:19.560375 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:59:19.562111 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:59:19.563636 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (compile): 19:59:19.519618 => 19:59:19.562877
[0m19:59:19.565340 [debug] [Thread-2 (]: Timing info for model.premier_league_analytics.fct_match_results (compile): 19:59:19.532924 => 19:59:19.564673
[0m19:59:19.566652 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (execute): 19:59:19.566015 => 19:59:19.566038
[0m19:59:19.567818 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:59:19.569226 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (compile): 19:59:19.540572 => 19:59:19.568539
[0m19:59:19.570446 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:59:19.572586 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:59:19.573876 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (execute): 19:59:19.573174 => 19:59:19.573190
[0m19:59:19.574876 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:59:19.576125 [debug] [Thread-2 (]: Timing info for model.premier_league_analytics.fct_match_results (execute): 19:59:19.575640 => 19:59:19.575657
[0m19:59:19.577567 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:59:19.579804 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:59:19.581004 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (execute): 19:59:19.580520 => 19:59:19.580538
[0m19:59:19.583825 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:59:19.586049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:59:19.589517 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:59:19.591676 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:59:19.593417 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:59:19.594854 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:59:19.596533 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:59:19.598846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m19:59:19.601022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:59:19.611072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:59:19.623983 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:59:19.625035 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:59:19.626341 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:59:19.627424 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:59:19.637059 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:59:19.644804 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (compile): 19:59:19.602024 => 19:59:19.643753
[0m19:59:19.671438 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:59:19.672542 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:59:19.674718 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:59:19.677382 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (execute): 19:59:19.676625 => 19:59:19.676647
[0m19:59:19.679565 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:59:19.680513 [debug] [Thread-4 (]: Timing info for model.premier_league_analytics.fct_team_season_stats (compile): 19:59:19.628333 => 19:59:19.680063
[0m19:59:19.681772 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:59:19.683519 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (compile): 19:59:19.638138 => 19:59:19.682811
[0m19:59:19.687786 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (compile): 19:59:19.651385 => 19:59:19.685181
[0m19:59:19.689365 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:59:19.692315 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:59:19.693898 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:59:19.695564 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:59:19.697727 [debug] [Thread-4 (]: Timing info for model.premier_league_analytics.fct_team_season_stats (execute): 19:59:19.696931 => 19:59:19.696958
[0m19:59:19.699239 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:59:19.701191 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (execute): 19:59:19.700389 => 19:59:19.700410
[0m19:59:19.702724 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (execute): 19:59:19.702065 => 19:59:19.702083
[0m19:59:19.705820 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:59:19.716517 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:59:19.718210 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:59:19.720505 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:59:19.722424 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:59:19.725120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:59:19.726296 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (compile): 19:59:19.708021 => 19:59:19.725769
[0m19:59:19.727351 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:59:19.728380 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:59:19.736638 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (execute): 19:59:19.735783 => 19:59:19.735806
[0m19:59:19.740337 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:59:19.745849 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:59:19.750790 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (compile): 19:59:19.729112 => 19:59:19.749436
[0m19:59:19.752371 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:59:19.754315 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (execute): 19:59:19.753598 => 19:59:19.753618
[0m19:59:19.757674 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:59:19.760754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:19.761612 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m19:59:19.762331 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:59:19.763031 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:59:19.763974 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:59:19.768673 [debug] [MainThread]: Command end result
[0m19:59:19.835688 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m19:59:19.837609 [info ] [MainThread]: Building catalog
[0m19:59:19.844841 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:59:19.862372 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:59:19.870519 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:59:19.941299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:19.952776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:19.957084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:19.960997 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:59:19.965290 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:59:19.969553 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:59:20.714638 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:cbad8704-20f7-4d25-b811-8aa601e2788e&page=queryresults
[0m19:59:20.722642 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:130fc6b7-7597-48df-8a0c-ffd0c543c826&page=queryresults
[0m19:59:20.726879 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:cfb88395-7317-4f34-bb72-d417c160c61e&page=queryresults
[0m19:59:22.055012 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:59:22.084244 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 9.608468, "process_user_time": 7.403742, "process_kernel_time": 1.558166, "process_mem_max_rss": "206303232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:59:22.086402 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:59:22.085947 after 9.61 seconds
[0m19:59:22.092245 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:59:22.093375 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:59:22.094563 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:59:22.095481 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:59:22.096512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105485a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a96ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009de6d0>]}
[0m19:59:22.097686 [debug] [MainThread]: Flushing usage events
[0m19:59:51.157451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c9690>]}


============================== 19:59:51.170644 | 945d4cb4-4955-4e93-89bd-31877d84ee13 ==============================
[0m19:59:51.170644 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:59:51.172182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir dbt --target ci --select stg_pl_matches', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:59:59.608518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112839210>]}
[0m19:59:59.807231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112826d10>]}
[0m19:59:59.810535 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:59:59.927592 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m20:00:00.491278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:00.492735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:00.515025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b2e90>]}
[0m20:00:00.564516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a12d0>]}
[0m20:00:00.567563 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:00:00.568905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112354190>]}
[0m20:00:00.573575 [info ] [MainThread]: 
[0m20:00:00.578486 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:00.584142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m20:00:00.585417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:01.176589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m20:00:01.180504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m20:00:01.182139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:01.183505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:01.757495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112747550>]}
[0m20:00:01.759927 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m20:00:01.761196 [info ] [MainThread]: 
[0m20:00:01.776801 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m20:00:01.778846 [info ] [Thread-1 (]: 1 of 1 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m20:00:01.782079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m20:00:01.783894 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m20:00:01.825844 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m20:00:01.833723 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (compile): 20:00:01.784505 => 20:00:01.831972
[0m20:00:01.835308 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m20:00:01.957644 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m20:00:01.961478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:01.965915 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw
    where season is not null
      and match_num is not null

)

select * from typed;


[0m20:00:02.678694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:1a6c844b-582f-4d69-b7c3-37e5c260cabe&page=queryresults
[0m20:00:02.988909 [debug] [Thread-1 (]: Timing info for model.premier_league_analytics.stg_pl_matches (execute): 20:00:01.837485 => 20:00:02.988202
[0m20:00:02.991362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '945d4cb4-4955-4e93-89bd-31877d84ee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112903dd0>]}
[0m20:00:02.993602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m20:00:02.997777 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m20:00:03.004038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:03.005557 [debug] [MainThread]: Connection 'list_pl-football-analytics' was properly closed.
[0m20:00:03.006696 [debug] [MainThread]: Connection 'model.premier_league_analytics.stg_pl_matches' was properly closed.
[0m20:00:03.008118 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics' was properly closed.
[0m20:00:03.009106 [info ] [MainThread]: 
[0m20:00:03.010247 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m20:00:03.012822 [debug] [MainThread]: Command end result
[0m20:00:03.118092 [info ] [MainThread]: 
[0m20:00:03.120310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:03.121655 [info ] [MainThread]: 
[0m20:00:03.122905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:00:03.149329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.220847, "process_user_time": 8.789173, "process_kernel_time": 2.017991, "process_mem_max_rss": "199806976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:00:03.152070 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:03.150828 after 12.22 seconds
[0m20:00:03.155557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b027d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c882d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c88190>]}
[0m20:00:03.156847 [debug] [MainThread]: Flushing usage events
[0m20:00:33.257994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100cd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c28d0>]}


============================== 20:00:33.272158 | 3af663bf-89d2-4518-b868-de45387d538c ==============================
[0m20:00:33.272158 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:00:33.274167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/ci', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir dbt --target ci', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:00:39.776362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b329d0>]}
[0m20:00:39.955994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ed1110>]}
[0m20:00:39.959573 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m20:00:40.042544 [debug] [MainThread]: checksum: 672a2e182aef21f249d49a3c71886963f1f73cbdda3d69cc98b4e1e110425acc, vars: {}, profile: , target: ci, version: 1.7.19
[0m20:00:40.521505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:40.522654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:40.536699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e71550>]}
[0m20:00:40.575730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a33be10>]}
[0m20:00:40.576966 [info ] [MainThread]: Found 4 models, 11 tests, 1 source, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:00:40.578276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c9b1d0>]}
[0m20:00:40.586535 [info ] [MainThread]: 
[0m20:00:40.589415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:40.596311 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m20:00:40.598050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:40.606874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m20:00:40.610221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:41.101620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af663bf-89d2-4518-b868-de45387d538c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3fb2d0>]}
[0m20:00:41.104485 [info ] [MainThread]: Concurrency: 4 threads (target='ci')
[0m20:00:41.105801 [info ] [MainThread]: 
[0m20:00:41.128657 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:00:41.130557 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_fct_match_results_result__H__A__D ........... [RUN]
[0m20:00:41.133430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m20:00:41.135293 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:00:41.137386 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:00:41.139932 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:00:41.143425 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:00:41.145059 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_team_team_id ................................... [RUN]
[0m20:00:41.147474 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_match_results_match_id ......................... [RUN]
[0m20:00:41.155514 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m20:00:41.199032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m20:00:41.227065 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f'
[0m20:00:41.225334 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m20:00:41.229572 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m20:00:41.231003 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:00:41.232510 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:00:41.234387 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:00:41.261513 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (compile): 20:00:41.148672 => 20:00:41.260500
[0m20:00:41.274968 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m20:00:41.279958 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m20:00:41.293676 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m20:00:41.295346 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:00:41.306617 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (compile): 20:00:41.235651 => 20:00:41.305684
[0m20:00:41.314413 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (compile): 20:00:41.280791 => 20:00:41.313690
[0m20:00:41.315522 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (compile): 20:00:41.254323 => 20:00:41.315083
[0m20:00:41.323632 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:00:41.334681 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:00:41.336536 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:00:41.443422 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m20:00:41.446265 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m20:00:41.456087 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m20:00:41.462530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:41.461808 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m20:00:41.464335 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:00:41.468557 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select team_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
where team_id is null



      
    ) dbt_internal_test
[0m20:00:41.470002 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:00:41.471859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:41.475322 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



      
    ) dbt_internal_test
[0m20:00:41.483292 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
where match_id is null



      
    ) dbt_internal_test
[0m20:00:41.622694 [debug] [Thread-1 (]: On test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        result as value_field,
        count(*) as n_records

    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
    group by result

)

select *
from all_values
where value_field not in (
    'H','A','D'
)



      
    ) dbt_internal_test
[0m20:00:42.154307 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:0a68f31c-7ec0-44a7-8567-be340fe6ccb0&page=queryresults
[0m20:00:42.178843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:b746119f-4245-4fa6-8e7c-bea25e036dfb&page=queryresults
[0m20:00:42.294240 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:306b3b9b-9d72-4310-92f5-d3db8e094844&page=queryresults
[0m20:00:42.466965 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:6d8de9e2-5f44-445e-af1a-09ca05f03b69&page=queryresults
[0m20:00:42.472865 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157 (execute): 20:00:41.343167 => 20:00:42.472285
[0m20:00:42.475168 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_team_team_id ......................................... [[32mPASS[0m in 1.28s]
[0m20:00:42.478119 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:00:42.479502 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:00:42.501046 [info ] [Thread-2 (]: 5 of 11 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m20:00:42.507021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m20:00:42.510373 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d (execute): 20:00:41.297657 => 20:00:42.509790
[0m20:00:42.511618 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:00:42.513272 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_fct_match_results_result__H__A__D ................. [[32mPASS[0m in 1.38s]
[0m20:00:42.524410 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m20:00:42.525805 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:00:42.529433 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:00:42.531368 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m20:00:42.534539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m20:00:42.536685 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (compile): 20:00:42.514654 => 20:00:42.536089
[0m20:00:42.538204 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:00:42.539293 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:00:42.558071 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m20:00:42.564786 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m20:00:42.570958 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (compile): 20:00:42.540117 => 20:00:42.568285
[0m20:00:42.572227 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:00:42.576363 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m20:00:42.577049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:42.579505 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



      
    ) dbt_internal_test
[0m20:00:42.580747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:42.637194 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f (execute): 20:00:41.384596 => 20:00:42.636443
[0m20:00:42.639556 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_match_results_match_id ............................... [[32mPASS[0m in 1.41s]
[0m20:00:42.642526 [debug] [Thread-1 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



      
    ) dbt_internal_test
[0m20:00:42.644387 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:00:42.714951 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:00:42.716390 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m20:00:42.718841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m20:00:42.719801 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:00:42.741991 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m20:00:42.745895 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (compile): 20:00:42.720224 => 20:00:42.745164
[0m20:00:42.747189 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:00:42.789417 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m20:00:42.793584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:00:42.798056 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



      
    ) dbt_internal_test
[0m20:00:42.862631 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666 (execute): 20:00:41.372935 => 20:00:42.862162
[0m20:00:42.865218 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 1.64s]
[0m20:00:42.866774 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:00:42.867867 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:00:42.868886 [info ] [Thread-4 (]: 8 of 11 START test unique_dim_team_team_id ..................................... [RUN]
[0m20:00:42.870164 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m20:00:42.870882 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:00:42.903651 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m20:00:42.907156 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (compile): 20:00:42.871935 => 20:00:42.906648
[0m20:00:42.908066 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:00:42.914680 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m20:00:42.918519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:42.920882 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_dim_team_team_id.069cd44695: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select team_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
  where team_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:00:43.504141 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:6b477162-e65f-4754-a7e7-cd4a525a4fad&page=queryresults
[0m20:00:43.661014 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:fe763770-60c0-4483-9442-7e33af78ec7b&page=queryresults
[0m20:00:43.682474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:19c31e07-cc5a-4e44-8096-0ace05a01b33&page=queryresults
[0m20:00:43.808707 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:36a18ac9-599e-4b44-8f82-9f45f049bfc1&page=queryresults
[0m20:00:43.822417 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_dim_team_team_id.069cd44695 (execute): 20:00:42.910943 => 20:00:43.821737
[0m20:00:43.824481 [info ] [Thread-4 (]: 8 of 11 PASS unique_dim_team_team_id ........................................... [[32mPASS[0m in 0.95s]
[0m20:00:43.825764 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:00:43.826757 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:00:43.827746 [info ] [Thread-4 (]: 9 of 11 START test unique_fct_match_results_match_id ........................... [RUN]
[0m20:00:43.829217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m20:00:43.830090 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:00:43.856536 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m20:00:43.862252 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (compile): 20:00:43.830598 => 20:00:43.861449
[0m20:00:43.863428 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:00:43.868642 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m20:00:43.871654 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:00:43.874552 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:00:43.954761 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd (execute): 20:00:42.572825 => 20:00:43.953927
[0m20:00:43.956400 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 1.42s]
[0m20:00:43.957413 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:00:43.957988 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:00:43.958585 [info ] [Thread-1 (]: 10 of 11 START test unique_fct_team_season_stats_team_id_season ................ [RUN]
[0m20:00:43.959655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m20:00:43.960213 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:00:43.966542 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m20:00:43.971922 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (compile): 20:00:43.960531 => 20:00:43.970845
[0m20:00:43.973127 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:00:43.976703 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m20:00:43.978856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:43.981383 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select team_id || '-' || season as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
  where team_id || '-' || season is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:00:44.034031 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663 (execute): 20:00:42.560067 => 20:00:44.033554
[0m20:00:44.037512 [info ] [Thread-2 (]: 5 of 11 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.53s]
[0m20:00:44.041066 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:00:44.042467 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:00:44.043919 [info ] [Thread-2 (]: 11 of 11 START test unique_stg_pl_matches_match_id ............................. [RUN]
[0m20:00:44.046756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m20:00:44.048292 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:00:44.063171 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m20:00:44.066662 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (compile): 20:00:44.049799 => 20:00:44.066152
[0m20:00:44.071584 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:00:44.079505 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m20:00:44.082663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:44.090881 [debug] [Thread-2 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "premier_league_analytics", "target_name": "ci", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:00:44.162081 [debug] [Thread-3 (]: Timing info for test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2 (execute): 20:00:42.748081 => 20:00:44.161575
[0m20:00:44.163660 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.45s]
[0m20:00:44.165330 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:00:44.591747 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:ca3da709-4f51-446f-9833-b1ff2953b12f&page=queryresults
[0m20:00:44.642114 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:a565fef4-80c4-4a9d-9a4a-a7cbcaa41e17&page=queryresults
[0m20:00:44.914178 [debug] [Thread-4 (]: Timing info for test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162 (execute): 20:00:43.863948 => 20:00:44.913625
[0m20:00:44.915826 [info ] [Thread-4 (]: 9 of 11 PASS unique_fct_match_results_match_id ................................. [[32mPASS[0m in 1.09s]
[0m20:00:44.917312 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:00:44.941096 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:64ecca03-2b87-4f72-ae4c-43c14f0bf5fe&page=queryresults
[0m20:00:44.954904 [debug] [Thread-1 (]: Timing info for test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5 (execute): 20:00:43.973646 => 20:00:44.953883
[0m20:00:44.957516 [info ] [Thread-1 (]: 10 of 11 PASS unique_fct_team_season_stats_team_id_season ...................... [[32mPASS[0m in 1.00s]
[0m20:00:44.959196 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:00:45.200075 [debug] [Thread-2 (]: Timing info for test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8 (execute): 20:00:44.072834 => 20:00:45.198949
[0m20:00:45.203456 [info ] [Thread-2 (]: 11 of 11 PASS unique_stg_pl_matches_match_id ................................... [[32mPASS[0m in 1.16s]
[0m20:00:45.205762 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:00:45.212088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:45.213663 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m20:00:45.214877 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8' was properly closed.
[0m20:00:45.216440 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2' was properly closed.
[0m20:00:45.217410 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m20:00:45.218381 [info ] [MainThread]: 
[0m20:00:45.219421 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m20:00:45.230301 [debug] [MainThread]: Command end result
[0m20:00:45.294746 [info ] [MainThread]: 
[0m20:00:45.295930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:45.297075 [info ] [MainThread]: 
[0m20:00:45.298112 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m20:00:45.310307 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.260499, "process_user_time": 10.109233, "process_kernel_time": 1.941461, "process_mem_max_rss": "211800064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:00:45.311654 [debug] [MainThread]: Command `dbt test` succeeded at 20:00:45.311317 after 12.26 seconds
[0m20:00:45.312502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed73e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11013f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b63a710>]}
[0m20:00:45.313352 [debug] [MainThread]: Flushing usage events
[0m18:36:12.641973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109162510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916e690>]}


============================== 18:36:12.667632 | d973c7da-2fe2-4a8b-bca9-26184883fbe4 ==============================
[0m18:36:12.667632 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:36:12.674395 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/adilosman/.dbt', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'static_parser': 'True', 'empty': 'None', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m18:36:34.290863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7f1f90>]}
[0m18:36:34.475637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106711d10>]}
[0m18:36:34.476952 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:36:36.373796 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:36:36.946965 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:36:36.954546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a4190>]}
[0m18:36:42.635644 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:36:42.636951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf29cd0>]}
[0m18:36:43.224414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bda3850>]}
[0m18:36:43.359033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c18ae50>]}
[0m18:36:43.360225 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m18:36:43.360885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd973c7da-2fe2-4a8b-bca9-26184883fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082304d0>]}
[0m18:36:43.366519 [info ] [MainThread]: 
[0m18:36:43.368698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:43.374752 [info ] [MainThread]: 
[0m18:36:43.378474 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:36:43.441586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m18:36:43.443337 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m18:36:43.445529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.449849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.451001 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/absolute/path/to/your/service-account.json''
[0m18:36:43.461985 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/absolute/path/to/your/service-account.json''
[0m18:36:43.470683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:43.472109 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/absolute/path/to/your/service-account.json''
[0m18:36:43.473633 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/absolute/path/to/your/service-account.json'
[0m18:36:43.478808 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:36:43.546560 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 31.79444, "process_in_blocks": "0", "process_kernel_time": 3.402878, "process_mem_max_rss": "371359744", "process_out_blocks": "0", "process_user_time": 13.469994}
[0m18:36:43.548277 [debug] [MainThread]: Command `dbt docs generate` failed at 18:36:43.547995 after 31.80 seconds
[0m18:36:43.549138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109107150>]}
[0m18:36:43.549855 [debug] [MainThread]: Flushing usage events
[0m18:36:44.141096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:39.874424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc64290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf7a90>]}


============================== 18:49:39.888752 | ad1d659c-bb82-4a8c-97d6-bddf15877d14 ==============================
[0m18:49:39.888752 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:49:39.890012 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'no_print': 'None'}
[0m18:49:48.963180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad1d659c-bb82-4a8c-97d6-bddf15877d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9d210>]}
[0m18:49:49.062736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad1d659c-bb82-4a8c-97d6-bddf15877d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b208190>]}
[0m18:49:49.063780 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:49:50.237994 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:49:52.378808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:52.379745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:52.612963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1d659c-bb82-4a8c-97d6-bddf15877d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120755350>]}
[0m18:49:52.712984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1d659c-bb82-4a8c-97d6-bddf15877d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12035dfd0>]}
[0m18:49:52.722060 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m18:49:52.740010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1d659c-bb82-4a8c-97d6-bddf15877d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120765c50>]}
[0m18:49:52.768618 [info ] [MainThread]: 
[0m18:49:52.770852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:52.772841 [info ] [MainThread]: 
[0m18:49:52.782855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:49:52.818799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m18:49:52.820704 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m18:49:52.823775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:52.826452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:52.828323 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/Users/adilosman/Desktop/pl-football-analytics-7d994e79a010''
[0m18:49:52.829431 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/Users/adilosman/Desktop/pl-football-analytics-7d994e79a010''
[0m18:49:52.831843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:52.833632 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/Users/adilosman/Desktop/pl-football-analytics-7d994e79a010''
[0m18:49:52.838567 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/Users/adilosman/Desktop/pl-football-analytics-7d994e79a010'
[0m18:49:52.871805 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 13.150076, "process_in_blocks": "0", "process_kernel_time": 2.200659, "process_mem_max_rss": "358244352", "process_out_blocks": "0", "process_user_time": 6.821633}
[0m18:49:52.874950 [debug] [MainThread]: Command `dbt docs generate` failed at 18:49:52.874215 after 13.15 seconds
[0m18:49:52.876759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120809190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbfffd0>]}
[0m18:49:52.877893 [debug] [MainThread]: Flushing usage events
[0m18:49:53.448871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:20.886636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108119950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ea090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108127d90>]}


============================== 18:51:20.899567 | 8cef8dec-704d-45f6-8573-95821d025dc6 ==============================
[0m18:51:20.899567 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:51:20.901040 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt docs serve --no-browser --port 8080', 'profiles_dir': '/Users/adilosman/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None'}
[0m18:51:36.696985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cef8dec-704d-45f6-8573-95821d025dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a824610>]}
[0m18:51:36.829773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cef8dec-704d-45f6-8573-95821d025dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a9cd0>]}
[0m18:53:39.478867 [error] [MainThread]: Encountered an error:

[0m18:53:39.518753 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:53:39.557145 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 138.80609, "process_in_blocks": "0", "process_kernel_time": 2.174066, "process_mem_max_rss": "357269504", "process_out_blocks": "0", "process_user_time": 7.664451}
[0m18:53:39.558128 [debug] [MainThread]: Command `dbt docs serve` failed at 18:53:39.557978 after 138.81 seconds
[0m18:53:39.558602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108134b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c3fd0>]}
[0m18:53:39.559057 [debug] [MainThread]: Flushing usage events
[0m18:53:40.029942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:04.655210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1db290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e175b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e20cd90>]}


============================== 18:54:04.665965 | 7ada415e-a5a5-4253-9c60-cc2d26b74226 ==============================
[0m18:54:04.665965 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:54:04.667054 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/adilosman/.dbt', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'None'}
[0m18:54:12.233417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad2590>]}
[0m18:54:12.318975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b765e10>]}
[0m18:54:12.320077 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:54:12.842059 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:54:13.227077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:13.227734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:13.297980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12073fb50>]}
[0m18:54:13.368617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120840690>]}
[0m18:54:13.369442 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m18:54:13.370179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120838450>]}
[0m18:54:13.373545 [info ] [MainThread]: 
[0m18:54:13.374394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:13.375182 [info ] [MainThread]: 
[0m18:54:13.377863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:13.388898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m18:54:13.390166 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m18:54:13.391319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:13.392019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:13.888166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ada415e-a5a5-4253-9c60-cc2d26b74226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b40e90>]}
[0m18:54:13.889308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:13.906230 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m18:54:13.907273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m18:54:13.908053 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m18:54:13.929112 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m18:54:13.932045 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m18:54:13.933042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:13.937170 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m18:54:13.939888 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m18:54:13.940810 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:54:13.941638 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:54:13.942946 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:54:13.943988 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m18:54:13.944954 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m18:54:13.945646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m18:54:13.946283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m18:54:13.946914 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.dim_team
[0m18:54:13.947495 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:54:13.948066 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:54:13.948583 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:54:13.953305 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m18:54:13.969022 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m18:54:13.976092 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m18:54:13.981094 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m18:54:13.983909 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:54:13.984861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:54:13.985613 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:54:13.986188 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:54:13.986751 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.dim_team
[0m18:54:13.987372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:13.989876 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:54:13.990577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:13.991259 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:54:13.993544 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:54:13.994162 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:54:13.996778 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:54:13.997511 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:54:13.999451 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m18:54:14.000048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m18:54:14.000745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m18:54:14.001534 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:54:14.001957 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_match_results
[0m18:54:14.002397 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:54:14.002766 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:54:14.007456 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m18:54:14.008115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now model.premier_league_analytics.fct_match_results)
[0m18:54:14.008625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m18:54:14.015337 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m18:54:14.016185 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m18:54:14.016838 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:54:14.017927 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:54:14.022395 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m18:54:14.031416 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m18:54:14.031960 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:54:14.032565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:54:14.033546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:14.036652 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:54:14.038708 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:54:14.039324 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:54:14.040386 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:54:14.041095 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m18:54:14.041703 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m18:54:14.042430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:54:14.043161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.043651 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:54:14.045839 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:54:14.048117 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m18:54:14.053144 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m18:54:14.054344 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m18:54:14.054882 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:54:14.055302 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:54:14.055982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m18:54:14.056758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m18:54:14.057525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m18:54:14.058152 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m18:54:14.058673 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:54:14.059133 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:54:14.059633 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:54:14.063469 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m18:54:14.064279 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:54:14.077896 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m18:54:14.084280 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m18:54:14.087872 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:54:14.089133 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m18:54:14.090167 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:54:14.091267 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:14.092101 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:54:14.092607 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:54:14.093335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m18:54:14.094171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.096374 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m18:54:14.097067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:54:14.097687 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:54:14.100589 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:54:14.102846 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:54:14.103326 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:54:14.108567 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m18:54:14.110016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m18:54:14.110850 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:54:14.116351 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m18:54:14.117359 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:54:14.118400 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:54:14.119441 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:54:14.120251 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:14.122837 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:54:14.126027 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:54:14.127913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:14.128554 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m18:54:14.129061 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m18:54:14.129894 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m18:54:14.130625 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m18:54:14.134118 [debug] [MainThread]: Command end result
[0m18:54:14.300530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:54:14.306829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:54:14.321547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m18:54:14.330106 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:54:14.331180 [info ] [MainThread]: Building catalog
[0m18:54:14.344702 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:54:14.362077 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:54:14.368838 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:54:14.391293 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:54:14.397877 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:54:14.402952 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:54:14.404239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:14.404943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:14.406470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:15.116759 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:b6485801-80ea-4b6c-ae26-c05618ea68d6&page=queryresults
[0m18:54:15.199266 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9bba3518-cf48-4163-86b8-daf6422a82a0&page=queryresults
[0m18:54:15.330804 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c6e8e7b2-6044-4b53-b51d-6a1370eb1e73&page=queryresults
[0m18:54:16.967069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:16.994099 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:54:17.026191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:54:17.031948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:54:17.032867 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:54:17.042442 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.520529, "process_in_blocks": "0", "process_kernel_time": 2.151716, "process_mem_max_rss": "377389056", "process_out_blocks": "0", "process_user_time": 7.742006}
[0m18:54:17.043599 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:54:17.043286 after 12.52 seconds
[0m18:54:17.044407 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:54:17.045186 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:54:17.045665 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:54:17.046053 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:54:17.046776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e20c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1dbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120900650>]}
[0m18:54:17.052543 [debug] [MainThread]: Flushing usage events
[0m18:54:17.482381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:36.344892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c51ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f30f10>]}


============================== 18:55:36.354794 | 1b654471-8c77-43fc-8e3e-be2bc203e8e8 ==============================
[0m18:55:36.354794 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:55:36.356299 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt docs generate', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs'}
[0m18:55:44.235008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e72d190>]}
[0m18:55:44.335098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4a1d50>]}
[0m18:55:44.336375 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:55:44.874930 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:55:45.277246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:45.278109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:45.361730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12351d190>]}
[0m18:55:45.426471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236fc090>]}
[0m18:55:45.427425 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m18:55:45.428313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12355ddd0>]}
[0m18:55:45.431944 [info ] [MainThread]: 
[0m18:55:45.433423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:45.435055 [info ] [MainThread]: 
[0m18:55:45.436909 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:45.444616 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m18:55:45.445541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m18:55:45.446149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:45.446710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:45.943455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b654471-8c77-43fc-8e3e-be2bc203e8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12386f8d0>]}
[0m18:55:45.944652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:45.959989 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m18:55:45.961046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m18:55:45.961857 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m18:55:45.986959 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m18:55:45.990936 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m18:55:45.991684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:45.994338 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m18:55:45.995593 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m18:55:45.996171 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:55:45.996817 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:55:45.997456 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:55:45.998098 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m18:55:45.998762 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m18:55:45.999273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m18:55:45.999774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m18:55:46.000250 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.dim_team
[0m18:55:46.000999 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:55:46.001633 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:55:46.002352 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:55:46.007214 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m18:55:46.023065 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m18:55:46.029892 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m18:55:46.035301 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m18:55:46.037710 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.dim_team
[0m18:55:46.038448 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:46.039319 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:55:46.039932 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:55:46.042124 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m18:55:46.042611 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:55:46.043082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:46.043615 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:46.044117 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:55:46.044827 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:46.047817 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:55:46.048605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m18:55:46.050661 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:55:46.053942 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:55:46.054475 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:55:46.055096 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:55:46.055636 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_match_results
[0m18:55:46.056170 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:55:46.056682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m18:55:46.061876 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m18:55:46.062954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.fct_match_results)
[0m18:55:46.064708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m18:55:46.066408 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:55:46.067712 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m18:55:46.068790 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:55:46.075166 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:55:46.079285 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m18:55:46.086230 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m18:55:46.094460 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m18:55:46.095312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:46.099875 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:55:46.100719 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:55:46.101293 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:55:46.101760 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m18:55:46.102575 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:55:46.103244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:46.103871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m18:55:46.104407 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:46.104974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:46.106405 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:55:46.109135 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:55:46.113483 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m18:55:46.114823 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:55:46.121727 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m18:55:46.123360 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m18:55:46.123955 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:55:46.124742 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:55:46.125959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m18:55:46.127456 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m18:55:46.128671 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:55:46.129757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m18:55:46.130714 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m18:55:46.131403 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:55:46.132124 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:46.132821 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:55:46.137739 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m18:55:46.153293 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m18:55:46.156092 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:55:46.162932 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m18:55:46.164393 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:55:46.165861 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m18:55:46.166677 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m18:55:46.167826 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:55:46.168736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:46.170127 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:55:46.170827 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:55:46.171666 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:46.179000 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m18:55:46.181714 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m18:55:46.183015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:46.187943 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:55:46.189571 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:55:46.193078 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:55:46.193886 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:55:46.194600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m18:55:46.195408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:46.195968 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:55:46.205492 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:55:46.203615 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m18:55:46.208273 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:55:46.208977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:46.212239 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:55:46.214268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:46.214894 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m18:55:46.215435 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m18:55:46.215979 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m18:55:46.216804 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m18:55:46.220967 [debug] [MainThread]: Command end result
[0m18:55:46.476610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:55:46.487900 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:55:46.518087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m18:55:46.528272 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:55:46.529894 [info ] [MainThread]: Building catalog
[0m18:55:46.550530 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:55:46.551849 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:55:46.553022 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:55:46.622155 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:55:46.614720 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:55:46.632769 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:55:46.635923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:46.637455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:46.644597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:47.723097 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:d18177c0-ea0c-4a55-95f9-5097ddaedef6&page=queryresults
[0m18:55:47.725513 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:8f844338-8034-42c3-a0e7-5701c282a520&page=queryresults
[0m18:55:47.734128 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:2a0bbbeb-7a3e-4dff-845c-251fe2e7cc45&page=queryresults
[0m18:55:48.909298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:48.948719 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:55:49.011475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:55:49.019006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:55:49.020486 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:55:49.041590 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.838912, "process_in_blocks": "0", "process_kernel_time": 2.06187, "process_mem_max_rss": "378454016", "process_out_blocks": "0", "process_user_time": 8.537134}
[0m18:55:49.043884 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:55:49.043471 after 12.84 seconds
[0m18:55:49.050994 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:55:49.066725 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:55:49.068454 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:55:49.069931 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:55:49.072161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f30d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f31990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100268d0>]}
[0m18:55:49.073941 [debug] [MainThread]: Flushing usage events
[0m18:55:49.630046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:08.373845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deba010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df279d0>]}


============================== 18:56:08.382683 | b4fac0c4-7bd8-45f1-a277-43dfa336bcfe ==============================
[0m18:56:08.382683 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:56:08.384060 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'printer_width': '80', 'invocation_command': 'dbt docs serve --no-browser --port 8080', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'fail_fast': 'False'}
[0m18:56:15.387689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4fac0c4-7bd8-45f1-a277-43dfa336bcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dee8a90>]}
[0m18:56:15.484599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4fac0c4-7bd8-45f1-a277-43dfa336bcfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d5850>]}
[0m18:57:51.079973 [error] [MainThread]: Encountered an error:

[0m18:57:51.131312 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:57:51.163927 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 102.915695, "process_in_blocks": "0", "process_kernel_time": 1.452137, "process_mem_max_rss": "357302272", "process_out_blocks": "0", "process_user_time": 6.02424}
[0m18:57:51.166746 [debug] [MainThread]: Command `dbt docs serve` failed at 18:57:51.166241 after 102.92 seconds
[0m18:57:51.168727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df445d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec3350>]}
[0m18:57:51.170688 [debug] [MainThread]: Flushing usage events
[0m18:57:51.661028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:12.208437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834bfd0>]}


============================== 18:58:12.217995 | 6c3214c7-fcff-44eb-a6a6-40b4de2fdde0 ==============================
[0m18:58:12.217995 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:58:12.219079 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/adilosman/.dbt', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --no-browser --port 8081', 'introspect': 'True'}
[0m18:58:20.268916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3214c7-fcff-44eb-a6a6-40b4de2fdde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107579990>]}
[0m18:58:20.363294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3214c7-fcff-44eb-a6a6-40b4de2fdde0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f9b10>]}
[0m18:58:34.617985 [error] [MainThread]: Encountered an error:

[0m18:58:34.651946 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:58:34.668631 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 22.57211, "process_in_blocks": "0", "process_kernel_time": 1.638053, "process_mem_max_rss": "358731776", "process_out_blocks": "0", "process_user_time": 5.603273}
[0m18:58:34.673462 [debug] [MainThread]: Command `dbt docs serve` failed at 18:58:34.672655 after 22.58 seconds
[0m18:58:34.675277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108368690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e7f10>]}
[0m18:58:34.677054 [debug] [MainThread]: Flushing usage events
[0m18:58:35.117474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:27.097457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113629390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142e06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445d290>]}


============================== 18:59:27.108044 | 7e98b560-1d58-4f68-b039-5b16c3f238f0 ==============================
[0m18:59:27.108044 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:59:27.109923 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True'}
[0m18:59:38.802966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135fd490>]}
[0m18:59:38.935112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a1690>]}
[0m18:59:38.936340 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:59:39.628017 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:59:40.237823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:40.238674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:40.347571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126eb1e90>]}
[0m18:59:40.435432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fabd10>]}
[0m18:59:40.436380 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m18:59:40.437225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c386d0>]}
[0m18:59:40.441516 [info ] [MainThread]: 
[0m18:59:40.442350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:40.444165 [info ] [MainThread]: 
[0m18:59:40.446749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:59:40.468745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m18:59:40.472161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m18:59:40.474020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:40.474935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:40.980700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e98b560-1d58-4f68-b039-5b16c3f238f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a72410>]}
[0m18:59:40.981664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:40.992825 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m18:59:40.993906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m18:59:40.994819 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m18:59:41.017287 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m18:59:41.020585 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m18:59:41.021564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:41.025198 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m18:59:41.027033 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m18:59:41.027954 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:59:41.028860 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m18:59:41.029508 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:59:41.030624 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:59:41.031634 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m18:59:41.032575 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.dim_team
[0m18:59:41.033478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m18:59:41.034273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m18:59:41.034943 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:59:41.039859 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m18:59:41.040638 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:59:41.041185 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:59:41.057991 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m18:59:41.063282 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m18:59:41.068984 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m18:59:41.070271 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.dim_team
[0m18:59:41.071479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:59:41.072146 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:59:41.073055 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:59:41.073645 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:59:41.074235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:59:41.076309 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m18:59:41.077010 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:59:41.077699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:41.078494 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:59:41.080480 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m18:59:41.083435 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m18:59:41.085342 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m18:59:41.085884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m18:59:41.086401 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:59:41.087057 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_match_results
[0m18:59:41.087636 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:59:41.088192 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:59:41.088750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m18:59:41.089256 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.fct_match_results)
[0m18:59:41.089727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m18:59:41.094823 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m18:59:41.095481 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:59:41.095980 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m18:59:41.096568 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:59:41.105602 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m18:59:41.110912 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m18:59:41.111607 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:59:41.118260 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m18:59:41.119567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:59:41.120763 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:59:41.121795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:59:41.126152 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m18:59:41.126622 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m18:59:41.127416 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:59:41.127930 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:59:41.129928 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m18:59:41.130775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:59:41.131468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:41.132180 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m18:59:41.134857 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m18:59:41.135640 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:59:41.137616 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m18:59:41.142990 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m18:59:41.143598 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m18:59:41.144210 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:59:41.144844 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:59:41.145711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m18:59:41.146479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m18:59:41.147137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m18:59:41.147784 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m18:59:41.148350 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:59:41.148789 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:59:41.149398 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:59:41.154050 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m18:59:41.154881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:59:41.169716 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m18:59:41.176054 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m18:59:41.179534 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m18:59:41.180599 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m18:59:41.181700 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:59:41.182691 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:59:41.183308 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:59:41.183854 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:59:41.184471 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m18:59:41.185027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:59:41.185528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:41.186229 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:59:41.188524 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m18:59:41.191622 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m18:59:41.197416 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m18:59:41.200217 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m18:59:41.201394 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:59:41.202835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m18:59:41.203842 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:59:41.204545 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:59:41.211121 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m18:59:41.211949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:59:41.215632 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m18:59:41.217023 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:59:41.218036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:59:41.220956 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m18:59:41.222845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:41.223523 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m18:59:41.224068 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m18:59:41.224605 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m18:59:41.225030 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m18:59:41.228578 [debug] [MainThread]: Command end result
[0m18:59:41.397525 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:59:41.403035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:59:41.418189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m18:59:41.424322 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:59:41.424905 [info ] [MainThread]: Building catalog
[0m18:59:41.433308 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:59:41.435077 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:59:41.436400 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m18:59:41.494867 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:59:41.496576 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:59:41.504716 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:59:41.506444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:41.508021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:41.509075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:42.305129 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:54a7934d-d831-47f6-8393-22ba97f00bea&page=queryresults
[0m18:59:42.306377 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:a77c49a2-6e25-484f-a421-7c0b4c6309c1&page=queryresults
[0m18:59:42.384053 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:fcda0a1b-5805-4b06-89a9-9b530e5db0f9&page=queryresults
[0m18:59:43.690427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:43.709539 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:59:43.746494 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m18:59:43.751056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m18:59:43.751707 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m18:59:43.760001 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 16.833029, "process_in_blocks": "0", "process_kernel_time": 2.821229, "process_mem_max_rss": "378216448", "process_out_blocks": "0", "process_user_time": 10.266372}
[0m18:59:43.761694 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:59:43.761317 after 16.83 seconds
[0m18:59:43.765536 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:59:43.766698 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:59:43.767633 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:59:43.768430 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m18:59:43.769338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270a8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d88710>]}
[0m18:59:43.770350 [debug] [MainThread]: Flushing usage events
[0m18:59:44.213233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:11.160091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f19b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f3bc90>]}


============================== 19:01:11.174253 | 612a4c5c-dd9f-4de9-be58-80eaa4b65d83 ==============================
[0m19:01:11.174253 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:01:11.175263 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None'}
[0m19:01:11.242787 [info ] [MainThread]: dbt version: 1.10.15
[0m19:01:11.243701 [info ] [MainThread]: python version: 3.11.14
[0m19:01:11.244261 [info ] [MainThread]: python path: /Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/bin/python3.11
[0m19:01:11.244818 [info ] [MainThread]: os info: macOS-15.7.2-x86_64-i386-64bit
[0m19:01:19.855478 [info ] [MainThread]: Using profiles dir at /Users/adilosman/.dbt
[0m19:01:19.856690 [info ] [MainThread]: Using profiles.yml file at /Users/adilosman/.dbt/profiles.yml
[0m19:01:19.857705 [info ] [MainThread]: Using dbt_project.yml file at /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/dbt_project.yml
[0m19:01:19.858436 [info ] [MainThread]: adapter type: bigquery
[0m19:01:19.859119 [info ] [MainThread]: adapter version: 1.10.3
[0m19:01:20.156032 [info ] [MainThread]: Configuration:
[0m19:01:20.162925 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:01:20.164416 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:01:20.165494 [info ] [MainThread]: Required dependencies:
[0m19:01:20.174184 [debug] [MainThread]: Executing "git --help"
[0m19:01:20.311719 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:01:20.315069 [debug] [MainThread]: STDERR: "b''"
[0m19:01:20.316307 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:01:20.319291 [info ] [MainThread]: Connection:
[0m19:01:20.320338 [info ] [MainThread]:   method: service-account
[0m19:01:20.320938 [info ] [MainThread]:   database: pl-football-analytics
[0m19:01:20.321696 [info ] [MainThread]:   execution_project: pl-football-analytics
[0m19:01:20.324013 [info ] [MainThread]:   schema: football_analytics
[0m19:01:20.325560 [info ] [MainThread]:   location: EU
[0m19:01:20.327084 [info ] [MainThread]:   priority: interactive
[0m19:01:20.329472 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:01:20.333895 [info ] [MainThread]:   impersonate_service_account: None
[0m19:01:20.336085 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:01:20.338035 [info ] [MainThread]:   job_retries: 1
[0m19:01:20.339309 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:01:20.341029 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m19:01:20.342857 [info ] [MainThread]:   timeout_seconds: None
[0m19:01:20.345303 [info ] [MainThread]:   client_id: None
[0m19:01:20.346887 [info ] [MainThread]:   token_uri: None
[0m19:01:20.372404 [info ] [MainThread]:   compute_region: None
[0m19:01:20.374407 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:01:20.375447 [info ] [MainThread]:   gcs_bucket: None
[0m19:01:20.377162 [info ] [MainThread]:   dataproc_batch: None
[0m19:01:20.380025 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:01:21.165931 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:01:21.167212 [debug] [MainThread]: On debug: select 1 as id
[0m19:01:21.168474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:22.554706 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:2fcd6574-ad97-4887-8bf8-edc3513d2f12&page=queryresults
[0m19:01:23.584786 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:01:23.586612 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:01:23.624645 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 12.599904, "process_in_blocks": "0", "process_kernel_time": 2.019391, "process_mem_max_rss": "366108672", "process_out_blocks": "0", "process_user_time": 7.000166}
[0m19:01:23.626362 [debug] [MainThread]: Command `dbt debug` succeeded at 19:01:23.626032 after 12.60 seconds
[0m19:01:23.627253 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:01:23.627877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d68d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f3bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247bd2d0>]}
[0m19:01:23.628593 [debug] [MainThread]: Flushing usage events
[0m19:01:24.101267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:39.585578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b85f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c14d90>]}


============================== 19:01:39.596873 | 741ca25f-fbf7-4a59-bd1d-1826ed8d31c7 ==============================
[0m19:01:39.596873 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:01:39.601223 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'empty': 'None', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/adilosman/.dbt', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None'}
[0m19:01:48.840087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651b450>]}
[0m19:01:48.977052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416dd90>]}
[0m19:01:48.978244 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:01:49.670846 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:01:50.196236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:50.197340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:50.298002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196c8410>]}
[0m19:01:50.501318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:01:50.512641 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:01:50.661388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11991b0d0>]}
[0m19:01:50.662350 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m19:01:50.663224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195b3810>]}
[0m19:01:50.668187 [info ] [MainThread]: 
[0m19:01:50.669182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:01:50.671536 [info ] [MainThread]: 
[0m19:01:50.672836 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:50.704826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:01:50.696201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:01:50.706754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:50.708179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:51.174381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741ca25f-fbf7-4a59-bd1d-1826ed8d31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119549550>]}
[0m19:01:51.175530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:51.188361 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:01:51.189258 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:01:51.190093 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:01:51.190838 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:01:51.191625 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_fct_match_results_result__H__A__D ........... [RUN]
[0m19:01:51.193023 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_team_team_id ................................... [RUN]
[0m19:01:51.194338 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_match_results_match_id ......................... [RUN]
[0m19:01:51.196286 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m19:01:51.198836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:01:51.200452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:01:51.202608 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f'
[0m19:01:51.213564 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:01:51.215016 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:01:51.216070 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:01:51.217258 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:01:51.217992 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:01:51.251605 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:01:51.260952 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:01:51.271177 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:01:51.276933 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:01:51.279558 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:01:51.291559 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:01:51.292192 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:01:51.315951 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:01:51.338166 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:01:51.340881 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:01:51.345407 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:01:51.353832 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:01:51.357738 [debug] [Thread-1 (]: On test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        result as value_field,
        count(*) as n_records

    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
    group by result

)

select *
from all_values
where value_field not in (
    'H','A','D'
)



  
  
      
    ) dbt_internal_test
[0m19:01:51.359399 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select team_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
where team_id is null



  
  
      
    ) dbt_internal_test
[0m19:01:51.360331 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m19:01:51.361192 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



  
  
      
    ) dbt_internal_test
[0m19:01:51.361841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:51.362713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:01:51.363501 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:01:51.368866 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:01:52.135307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:69813d5a-84e1-4f3b-98e7-6cc4e3a35ad5&page=queryresults
[0m19:01:53.115813 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:2dc95d03-997d-4e1a-9e32-3478a15e647a&page=queryresults
[0m19:01:53.119322 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:89b0067c-1b41-48a7-94d5-4af5c1f36b30&page=queryresults
[0m19:01:53.265054 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f9e965a7-14b3-40d9-975b-78bfb92c11fb&page=queryresults
[0m19:01:53.693748 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 2.49s]
[0m19:01:53.696147 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:01:53.697657 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:01:53.700167 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m19:01:53.708717 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_team_team_id ......................................... [[32mPASS[0m in 2.51s]
[0m19:01:53.784170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:01:53.793356 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:01:53.799413 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_match_results_match_id ............................... [[32mPASS[0m in 2.60s]
[0m19:01:53.790440 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_fct_match_results_result__H__A__D ................. [[32mPASS[0m in 2.59s]
[0m19:01:53.801549 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:01:53.808419 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:01:53.810547 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:01:53.812915 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:01:53.831153 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:01:53.832374 [info ] [Thread-2 (]: 6 of 11 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m19:01:53.833913 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:01:53.834892 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:01:53.836292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:01:53.837344 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m19:01:53.840160 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:01:53.840959 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:01:53.839111 [info ] [Thread-1 (]: 8 of 11 START test unique_dim_team_team_id ..................................... [RUN]
[0m19:01:53.845102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:01:53.874230 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:01:53.876327 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:01:53.882618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:01:53.884111 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:01:53.885673 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:01:53.899399 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:01:53.901123 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:01:53.931474 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



  
  
      
    ) dbt_internal_test
[0m19:01:53.942705 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:01:53.953629 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:01:53.958119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:01:53.959812 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:01:53.973075 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:01:54.078924 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m19:01:54.082767 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:01:54.084897 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



  
  
      
    ) dbt_internal_test
[0m19:01:54.086008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:01:54.091705 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:01:54.093198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:01:54.177549 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_dim_team_team_id.069cd44695: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
  where team_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:01:54.256520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:55.008937 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:852fa079-c026-4393-bb10-ba82cdd74048&page=queryresults
[0m19:01:55.039383 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c4f2d558-b057-4eed-992f-f155f388d079&page=queryresults
[0m19:01:55.377723 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.54s]
[0m19:01:55.385149 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.60s]
[0m19:01:55.390170 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:01:55.391928 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:01:55.410821 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:01:55.418462 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:01:55.420166 [info ] [Thread-3 (]: 9 of 11 START test unique_fct_match_results_match_id ........................... [RUN]
[0m19:01:55.421952 [info ] [Thread-4 (]: 10 of 11 START test unique_fct_team_season_stats_team_id_season ................ [RUN]
[0m19:01:55.423081 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:01:55.424072 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:01:55.424922 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:01:55.425650 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:01:55.440904 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:01:55.450818 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:01:55.453769 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:01:55.458592 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:01:55.459429 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:01:55.469444 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:01:55.470440 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:01:55.471066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:01:55.538534 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id || '-' || season as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
  where team_id || '-' || season is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:01:55.540079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c5ab81cf-0cd8-4769-9682-bf345da48ae8&page=queryresults
[0m19:01:55.541257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:01:55.630171 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:b78117f2-f5c6-4a8b-af5b-a916cd7b414e&page=queryresults
[0m19:01:55.939257 [info ] [Thread-1 (]: 8 of 11 PASS unique_dim_team_team_id ........................................... [[32mPASS[0m in 2.06s]
[0m19:01:55.940762 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:01:55.941902 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:01:55.943446 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_pl_matches_match_id ............................. [RUN]
[0m19:01:55.946443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:01:55.947976 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:01:55.972691 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:01:55.981957 [info ] [Thread-2 (]: 6 of 11 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 2.15s]
[0m19:01:55.983263 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:01:55.987525 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:01:55.992924 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:01:55.996388 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:01:55.997473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:56.064874 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:56a84ee1-97e1-4a5a-849a-44007fcacd9a&page=queryresults
[0m19:01:56.429428 [info ] [Thread-4 (]: 10 of 11 PASS unique_fct_team_season_stats_team_id_season ...................... [[32mPASS[0m in 1.01s]
[0m19:01:56.430931 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:01:56.654010 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:90574797-4267-42cd-8683-90cd99f4410b&page=queryresults
[0m19:01:56.740680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:3cbda3f8-733d-4d31-a22c-efd644a73a4a&page=queryresults
[0m19:01:56.971672 [info ] [Thread-3 (]: 9 of 11 PASS unique_fct_match_results_match_id ................................. [[32mPASS[0m in 1.55s]
[0m19:01:56.972872 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:01:57.313299 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_pl_matches_match_id ................................... [[32mPASS[0m in 1.37s]
[0m19:01:57.315567 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:01:57.330022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:57.339034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:57.340107 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8' was properly closed.
[0m19:01:57.341576 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd' was properly closed.
[0m19:01:57.346376 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:01:57.347327 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:01:57.348722 [info ] [MainThread]: 
[0m19:01:57.353673 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m19:01:57.361062 [debug] [MainThread]: Command end result
[0m19:01:57.522654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:01:57.536169 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:01:57.565795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:01:57.566952 [info ] [MainThread]: 
[0m19:01:57.568124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:57.569451 [info ] [MainThread]: 
[0m19:01:57.571310 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m19:01:57.590082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.161642, "process_in_blocks": "0", "process_kernel_time": 2.372133, "process_mem_max_rss": "382128128", "process_out_blocks": "0", "process_user_time": 10.230817}
[0m19:01:57.591243 [debug] [MainThread]: Command `dbt test` succeeded at 19:01:57.591059 after 18.16 seconds
[0m19:01:57.591933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023f2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102449850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c1990>]}
[0m19:01:57.593118 [debug] [MainThread]: Flushing usage events
[0m19:01:57.997564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:09.430642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100cdd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137fd0>]}


============================== 19:02:09.441372 | e9485353-8164-4dfc-bf49-36c33362fbce ==============================
[0m19:02:09.441372 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:02:09.442650 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True'}
[0m19:02:26.709963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227b73d0>]}
[0m19:02:26.881713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6e1850>]}
[0m19:02:26.883268 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:02:28.126042 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:02:28.768367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:28.769759 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:02:30.019496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b14190>]}
[0m19:02:30.238085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:02:30.246813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:02:30.338113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230ba850>]}
[0m19:02:30.339061 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 520 macros
[0m19:02:30.339931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122da0110>]}
[0m19:02:30.343820 [info ] [MainThread]: 
[0m19:02:30.345097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:30.346982 [info ] [MainThread]: 
[0m19:02:30.348617 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:30.380352 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:02:30.383014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:02:30.384264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:30.384963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:31.116665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:02:31.117738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:02:31.118558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:31.119483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:31.606193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e90a10>]}
[0m19:02:31.608148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:31.626989 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:02:31.629337 [info ] [Thread-1 (]: 1 of 4 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m19:02:31.633303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:02:31.636159 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:02:31.687672 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:02:31.692848 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:02:31.833742 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m19:02:31.838257 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw
    where season is not null
      and match_num is not null

)

select * from typed;


[0m19:02:31.839525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:32.271461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f4c25c01-7d7f-458f-b7c2-faaa73c74547&page=queryresults
[0m19:02:33.474793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b0e350>]}
[0m19:02:33.479405 [info ] [Thread-1 (]: 1 of 4 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m19:02:33.482434 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:02:33.484033 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.dim_team
[0m19:02:33.485037 [info ] [Thread-3 (]: 2 of 4 START sql table model football_analytics_football_analytics.dim_team .... [RUN]
[0m19:02:33.487047 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:02:33.488466 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:02:33.510573 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:02:33.514663 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:02:33.545941 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:02:33.920828 [debug] [Thread-3 (]: Writing runtime sql for node "model.premier_league_analytics.dim_team"
[0m19:02:33.923837 [debug] [Thread-3 (]: On model.premier_league_analytics.dim_team: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.dim_team"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
      
    
    

    
    OPTIONS()
    as (
      with teams as (

    select
      home_team_name as team_name,
      home_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

    union distinct

    select
      away_team_name as team_name,
      away_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

),

final as (

    select
      generate_uuid() as team_id,
      team_name,
      team_code
    from teams

)

select * from final
    );
  
[0m19:02:35.095228 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:391e2c9f-80dc-417f-aa3b-518f23f60f82&page=queryresults
[0m19:02:36.519950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230af510>]}
[0m19:02:36.528252 [info ] [Thread-3 (]: 2 of 4 OK created sql table model football_analytics_football_analytics.dim_team  [[32mCREATE TABLE (0.0 rows, 346.8 KiB processed)[0m in 3.03s]
[0m19:02:36.529728 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:02:36.531117 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:02:36.532477 [info ] [Thread-2 (]: 3 of 4 START sql table model football_analytics_football_analytics.fct_match_results  [RUN]
[0m19:02:36.535143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.fct_match_results)
[0m19:02:36.536803 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:02:36.559064 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:02:36.561734 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:02:36.565567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:36.823149 [debug] [Thread-2 (]: Writing runtime sql for node "model.premier_league_analytics.fct_match_results"
[0m19:02:36.826894 [debug] [Thread-2 (]: On model.premier_league_analytics.fct_match_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_match_results"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
      
    
    

    
    OPTIONS()
    as (
      with matches as (

    select
      m.*,
      t_home.team_id as home_team_id,
      t_away.team_id as away_team_id
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches` m
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_home
      on m.home_team_name = t_home.team_name
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_away
      on m.away_team_name = t_away.team_name

),

results as (

    select
      match_id,
      season,
      season_start_year,
      season_end_year,
      match_date,
      round_number,
      round_name,

      home_team_id,
      home_team_name,
      away_team_id,
      away_team_name,

      home_goals,
      away_goals,

      case
        when home_goals > away_goals then 'H'
        when home_goals < away_goals then 'A'
        when home_goals = away_goals then 'D'
        else null
      end as result,

      case
        when home_goals > away_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as home_points,

      case
        when away_goals > home_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as away_points
    from matches

)

select * from results
    );
  
[0m19:02:37.446615 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f91e2ee0-ecce-4329-a155-924cc4b65b45&page=queryresults
[0m19:02:39.190399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234ecb90>]}
[0m19:02:39.191856 [info ] [Thread-2 (]: 3 of 4 OK created sql table model football_analytics_football_analytics.fct_match_results  [[32mCREATE TABLE (0.0 rows, 712.3 KiB processed)[0m in 2.66s]
[0m19:02:39.193510 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:02:39.195243 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:02:39.196750 [info ] [Thread-4 (]: 4 of 4 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:02:39.201628 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.fct_team_season_stats'
[0m19:02:39.203054 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:02:39.223485 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:02:39.226620 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:02:39.231019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:02:39.532663 [debug] [Thread-4 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:02:39.539193 [debug] [Thread-4 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select * from agg
  ,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:02:39.621680 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:eed7beba-5dac-409f-80e7-02f27935e2db&page=queryresults
[0m19:02:39.623035 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:eed7beba-5dac-409f-80e7-02f27935e2db&page=queryresults
[0m19:02:39.770973 [debug] [Thread-4 (]: Database Error in model fct_team_season_stats (models/marts/fct_team_season_stats.sql)
  Syntax error: Expected ")" but got keyword FROM at [80:1]
  compiled code at target/run/premier_league_analytics/models/marts/fct_team_season_stats.sql
[0m19:02:39.771896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9485353-8164-4dfc-bf49-36c33362fbce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235be490>]}
[0m19:02:39.773181 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model football_analytics_football_analytics.fct_team_season_stats  [[31mERROR[0m in 0.57s]
[0m19:02:39.774577 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:02:39.775408 [debug] [Thread-7 (]: Marking all children of 'model.premier_league_analytics.fct_team_season_stats' to be skipped because of status 'error'.  Reason: Database Error in model fct_team_season_stats (models/marts/fct_team_season_stats.sql)
  Syntax error: Expected ")" but got keyword FROM at [80:1]
  compiled code at target/run/premier_league_analytics/models/marts/fct_team_season_stats.sql.
[0m19:02:39.778284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:39.785887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:39.786525 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_match_results' was properly closed.
[0m19:02:39.792596 [debug] [MainThread]: Connection 'model.premier_league_analytics.stg_pl_matches' was properly closed.
[0m19:02:39.793840 [debug] [MainThread]: Connection 'model.premier_league_analytics.dim_team' was properly closed.
[0m19:02:39.794812 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:02:39.795576 [info ] [MainThread]: 
[0m19:02:39.796327 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 9.45 seconds (9.45s).
[0m19:02:39.803743 [debug] [MainThread]: Command end result
[0m19:02:39.893574 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:02:39.899898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:02:39.923631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:02:39.924438 [info ] [MainThread]: 
[0m19:02:39.925319 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:02:39.925987 [info ] [MainThread]: 
[0m19:02:39.926705 [error] [MainThread]: [31mFailure in model fct_team_season_stats (models/marts/fct_team_season_stats.sql)[0m
[0m19:02:39.927529 [error] [MainThread]:   Database Error in model fct_team_season_stats (models/marts/fct_team_season_stats.sql)
  Syntax error: Expected ")" but got keyword FROM at [80:1]
  compiled code at target/run/premier_league_analytics/models/marts/fct_team_season_stats.sql
[0m19:02:39.928483 [info ] [MainThread]: 
[0m19:02:39.929468 [info ] [MainThread]:   compiled code at target/compiled/premier_league_analytics/models/marts/fct_team_season_stats.sql
[0m19:02:39.930780 [info ] [MainThread]: 
[0m19:02:39.932912 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m19:02:39.979353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.742262, "process_in_blocks": "0", "process_kernel_time": 2.965113, "process_mem_max_rss": "383959040", "process_out_blocks": "0", "process_user_time": 11.996763}
[0m19:02:39.980785 [debug] [MainThread]: Command `dbt run` failed at 19:02:39.980483 after 30.74 seconds
[0m19:02:39.981665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b976910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11012aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba49bd0>]}
[0m19:02:39.982300 [debug] [MainThread]: Flushing usage events
[0m19:02:40.449561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:00.163264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd8c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd8c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde8810>]}


============================== 19:03:00.174680 | 5ba1339d-4702-47d5-8dc0-1f1f856c750f ==============================
[0m19:03:00.174680 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:03:00.176532 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve --no-browser --port 8080', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/Users/adilosman/.dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:03:14.861671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ba1339d-4702-47d5-8dc0-1f1f856c750f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12033b250>]}
[0m19:03:15.107047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ba1339d-4702-47d5-8dc0-1f1f856c750f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b379a10>]}
[0m19:04:30.594407 [error] [MainThread]: Encountered an error:

[0m19:04:30.621096 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:04:30.643464 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 90.63884, "process_in_blocks": "0", "process_kernel_time": 2.363278, "process_mem_max_rss": "357220352", "process_out_blocks": "0", "process_user_time": 8.065126}
[0m19:04:30.652145 [debug] [MainThread]: Command `dbt docs serve` failed at 19:04:30.650173 after 90.65 seconds
[0m19:04:30.654913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd67450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd67ed0>]}
[0m19:04:30.656946 [debug] [MainThread]: Flushing usage events
[0m19:04:31.275274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:05.731342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd12210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1fc50>]}


============================== 19:05:05.740606 | a1d9daa4-9f0c-4a04-91de-2eb9e0bca60d ==============================
[0m19:05:05.740606 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:05:05.741542 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/adilosman/.dbt', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select fct_team_season_stats', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m19:05:15.805327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d9daa4-9f0c-4a04-91de-2eb9e0bca60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c667b50>]}
[0m19:05:15.999854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1d9daa4-9f0c-4a04-91de-2eb9e0bca60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29ddd0>]}
[0m19:05:16.001268 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:05:17.861207 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:05:18.490164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:05:18.491086 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:05:18.491702 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:05:18.997176 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='marts/metrics.yml', modification_time=1764270183.5022998, project_root='/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt') @ metrics: {'name': 'avg_goals_per_match', 'label': 'Avg goals per match', 'model': "ref('fct_team_season_stats')", 'description': 'Average goals scored per match by team and season.', 'calculation_method': 'expression', 'expression': 'sum(goals_for) / sum(matches_played)', 'timestamp': 'season_start_date', 'time_grains': ['year'], 'dimensions': ['team_name', 'season']} - at path []: Additional properties are not allowed ('calculation_method', 'dimensions', 'expression', 'model', 'time_grains', 'timestamp' were unexpected)
[0m19:05:19.028394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.438792, "process_in_blocks": "0", "process_kernel_time": 2.1834, "process_mem_max_rss": "368132096", "process_out_blocks": "0", "process_user_time": 6.991127}
[0m19:05:19.030610 [debug] [MainThread]: Command `dbt run` failed at 19:05:19.030217 after 13.44 seconds
[0m19:05:19.032284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd2ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd2ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f19d0>]}
[0m19:05:19.034059 [debug] [MainThread]: Flushing usage events
[0m19:05:19.500590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:57.476918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e57e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecbf50>]}


============================== 19:06:57.490681 | b58f277f-6ca7-48f9-b39b-e6ab957b1a69 ==============================
[0m19:06:57.490681 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:06:57.492571 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_team_season_stats', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:07:08.354939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58f277f-6ca7-48f9-b39b-e6ab957b1a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e52ad0>]}
[0m19:07:08.518046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58f277f-6ca7-48f9-b39b-e6ab957b1a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643dd50>]}
[0m19:07:08.519177 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:07:09.440713 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:07:10.054217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:07:10.055555 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:07:10.056701 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:07:10.666946 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='marts/metrics.yml', modification_time=1764270396.4110308, project_root='/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt') @ metrics: {'name': 'avg_goals_per_match', 'label': 'Avg goals per match', 'description': 'Average goals scored per match by team and season.', 'type': 'ratio', 'numerator': 'goals_for_total', 'denominator': 'matches_played_total', 'type_params': {'numerator_aggregation': 'sum', 'denominator_aggregation': 'sum'}} - at path ['type_params']: Additional properties are not allowed ('denominator_aggregation', 'numerator_aggregation' were unexpected)
[0m19:07:10.693512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.373628, "process_in_blocks": "0", "process_kernel_time": 2.216323, "process_mem_max_rss": "367824896", "process_out_blocks": "0", "process_user_time": 7.374137}
[0m19:07:10.695082 [debug] [MainThread]: Command `dbt run` failed at 19:07:10.694834 after 13.38 seconds
[0m19:07:10.695963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063efa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046be750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc40850>]}
[0m19:07:10.696868 [debug] [MainThread]: Flushing usage events
[0m19:07:11.169650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:33.929307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f950>]}


============================== 19:07:33.946427 | 6cc674ab-e2aa-4465-b92a-4ca0cecb1d15 ==============================
[0m19:07:33.946427 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:07:33.953204 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_team_season_stats'}
[0m19:07:47.667778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cc674ab-e2aa-4465-b92a-4ca0cecb1d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192e25d0>]}
[0m19:07:47.837678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cc674ab-e2aa-4465-b92a-4ca0cecb1d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9990>]}
[0m19:07:47.838752 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:07:48.670822 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:07:49.352645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:07:49.356032 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:07:49.359717 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:07:50.104323 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='marts/metrics.yml', modification_time=1764270442.496803, project_root='/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt') @ metrics: {'name': 'avg_goals_per_match', 'label': 'Avg goals per match', 'description': 'Average goals scored per match by team and season.', 'type': 'ratio', 'numerator': 'goals_for_total', 'denominator': 'matches_played_total'} - at path []: Additional properties are not allowed ('denominator', 'numerator' were unexpected)
[0m19:07:50.133119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.405632, "process_in_blocks": "0", "process_kernel_time": 2.798235, "process_mem_max_rss": "367865856", "process_out_blocks": "0", "process_user_time": 9.913653}
[0m19:07:50.135549 [debug] [MainThread]: Command `dbt run` failed at 19:07:50.135175 after 16.41 seconds
[0m19:07:50.136940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11933c850>]}
[0m19:07:50.142722 [debug] [MainThread]: Flushing usage events
[0m19:07:50.584288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:18.107868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109205d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109213fd0>]}


============================== 19:08:18.169173 | 433e4f03-221c-4317-8595-599e6e228d5a ==============================
[0m19:08:18.169173 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:08:18.171598 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_team_season_stats', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True'}
[0m19:09:04.971232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '433e4f03-221c-4317-8595-599e6e228d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d5bd0>]}
[0m19:09:05.158170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '433e4f03-221c-4317-8595-599e6e228d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677d9d0>]}
[0m19:09:05.159499 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:09:06.603686 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:09:07.957122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:09:07.958486 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:09:07.959597 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:09:09.749225 [error] [MainThread]: Encountered an error:
Parsing Error in metric avg_goals_per_match (models/marts/metrics.yml)
  The metric `goals_for_total` does not exist but was referenced.
[0m19:09:09.777979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 52.039803, "process_in_blocks": "0", "process_kernel_time": 2.789856, "process_mem_max_rss": "370393088", "process_out_blocks": "0", "process_user_time": 11.140323}
[0m19:09:09.780678 [debug] [MainThread]: Command `dbt run` failed at 19:09:09.780113 after 52.04 seconds
[0m19:09:09.782586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a06810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109213e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5d850>]}
[0m19:09:09.784138 [debug] [MainThread]: Flushing usage events
[0m19:09:10.359017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:47.800881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105552010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3ed0>]}


============================== 19:09:47.816845 | b572ca3c-c0f4-4c8b-bfba-f120d38f3d11 ==============================
[0m19:09:47.816845 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:09:47.819152 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select fct_team_season_stats', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'log_format': 'default'}
[0m19:10:02.183068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b572ca3c-c0f4-4c8b-bfba-f120d38f3d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c15e50>]}
[0m19:10:02.388768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b572ca3c-c0f4-4c8b-bfba-f120d38f3d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b30450>]}
[0m19:10:02.390326 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:10:03.505788 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:10:04.292441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:10:04.293700 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:10:04.298614 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:10:05.740811 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m19:10:05.766440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 18.19473, "process_in_blocks": "0", "process_kernel_time": 2.809821, "process_mem_max_rss": "370860032", "process_out_blocks": "0", "process_user_time": 10.455396}
[0m19:10:05.772028 [debug] [MainThread]: Command `dbt run` failed at 19:10:05.770932 after 18.20 seconds
[0m19:10:05.773459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dba810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11855d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b8090>]}
[0m19:10:05.774732 [debug] [MainThread]: Flushing usage events
[0m19:10:06.238959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:31.858647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d59c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dec110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dec5d0>]}


============================== 19:10:31.879449 | ea054d8d-2dc3-4bd3-8c71-88d3b134d3bc ==============================
[0m19:10:31.879449 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:10:31.882096 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select time_spine fct_team_season_stats', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'empty': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m19:10:45.742703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea054d8d-2dc3-4bd3-8c71-88d3b134d3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f9a10>]}
[0m19:10:45.893703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea054d8d-2dc3-4bd3-8c71-88d3b134d3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107371a50>]}
[0m19:10:45.895234 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:10:46.732431 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:10:47.435664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:10:47.437641 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:10:47.438939 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/time_spine.sql
[0m19:10:47.440358 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:10:48.675248 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m19:10:48.694264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.064793, "process_in_blocks": "0", "process_kernel_time": 2.665631, "process_mem_max_rss": "371171328", "process_out_blocks": "0", "process_user_time": 9.649415}
[0m19:10:48.695623 [debug] [MainThread]: Command `dbt run` failed at 19:10:48.695366 after 17.07 seconds
[0m19:10:48.698385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d19d0>]}
[0m19:10:48.701287 [debug] [MainThread]: Flushing usage events
[0m19:10:49.242788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:29.902182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a70250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572e210>]}


============================== 19:11:29.913613 | 9c83fa20-7a81-44c5-90f6-a68b550e8e17 ==============================
[0m19:11:29.913613 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:11:29.922083 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt run --select mf_time_spine fct_team_season_stats', 'version_check': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'use_colors': 'True'}
[0m19:11:41.948048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c83fa20-7a81-44c5-90f6-a68b550e8e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e99d0>]}
[0m19:11:42.148135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c83fa20-7a81-44c5-90f6-a68b550e8e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d4dcd0>]}
[0m19:11:42.149679 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:11:43.120670 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:11:43.825040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:11:43.828178 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:11:43.829506 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/time_spine.sql
[0m19:11:43.830829 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:11:45.686996 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m19:11:45.722165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.117872, "process_in_blocks": "0", "process_kernel_time": 2.546255, "process_mem_max_rss": "370937856", "process_out_blocks": "0", "process_user_time": 9.428864}
[0m19:11:45.723955 [debug] [MainThread]: Command `dbt run` failed at 19:11:45.723648 after 16.12 seconds
[0m19:11:45.725201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105795850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105794b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105793fd0>]}
[0m19:11:45.730815 [debug] [MainThread]: Flushing usage events
[0m19:11:46.174264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:59.855395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c577c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5dfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5dfbd0>]}


============================== 19:13:59.878324 | 07686a0c-2f5e-44a7-99ad-b5f88b2ba50c ==============================
[0m19:13:59.878324 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:13:59.895186 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select mf_time_spine fct_team_season_stats', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80'}
[0m19:14:35.342652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07686a0c-2f5e-44a7-99ad-b5f88b2ba50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecdc910>]}
[0m19:14:35.660313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07686a0c-2f5e-44a7-99ad-b5f88b2ba50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b81a10>]}
[0m19:14:35.661434 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:14:36.742059 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:14:37.805848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m19:14:37.807229 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:14:37.807941 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/time_spine.sql
[0m19:14:37.808553 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/project_configuration.yml
[0m19:14:37.809240 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:14:39.262873 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m19:14:39.293769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 39.71541, "process_in_blocks": "0", "process_kernel_time": 2.391828, "process_mem_max_rss": "371208192", "process_out_blocks": "0", "process_user_time": 9.636359}
[0m19:14:39.295000 [debug] [MainThread]: Command `dbt run` failed at 19:14:39.294792 after 39.72 seconds
[0m19:14:39.295749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c600950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c602c50>]}
[0m19:14:39.296447 [debug] [MainThread]: Flushing usage events
[0m19:14:39.967152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:12.062242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108907f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108907fd0>]}


============================== 19:15:12.080010 | 0ab27ebe-5704-4005-944b-2d4fa3d9dadb ==============================
[0m19:15:12.080010 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:15:12.083592 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select mf_time_spine fct_team_season_stats', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:15:24.167341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab27ebe-5704-4005-944b-2d4fa3d9dadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aef8110>]}
[0m19:15:24.330662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab27ebe-5704-4005-944b-2d4fa3d9dadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e64450>]}
[0m19:15:24.332110 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:15:25.291695 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:15:26.004829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m19:15:26.005940 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/time_spine.sql
[0m19:15:26.006616 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/project_configuration.yml
[0m19:15:26.007467 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/metrics.yml
[0m19:15:26.008530 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:15:27.360167 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a time spine model with granularity DAY or smaller in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine).
[0m19:15:27.387344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.52801, "process_in_blocks": "0", "process_kernel_time": 2.543996, "process_mem_max_rss": "371085312", "process_out_blocks": "0", "process_user_time": 9.274603}
[0m19:15:27.389835 [debug] [MainThread]: Command `dbt run` failed at 19:15:27.389566 after 15.53 seconds
[0m19:15:27.390684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108629610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ec150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b816ad0>]}
[0m19:15:27.391910 [debug] [MainThread]: Flushing usage events
[0m19:15:28.052533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:53.834783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b796650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7f2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b80bfd0>]}


============================== 19:16:53.856884 | dcf665ad-aeb0-4a8f-a90f-c3527da9e575 ==============================
[0m19:16:53.856884 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:16:53.858619 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select mf_time_spine fct_team_season_stats', 'log_cache_events': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80'}
[0m19:17:09.706301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcf665ad-aeb0-4a8f-a90f-c3527da9e575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7920d0>]}
[0m19:17:09.859376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcf665ad-aeb0-4a8f-a90f-c3527da9e575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6a410>]}
[0m19:17:09.861579 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:17:11.019534 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:17:11.310102 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading premier_league_analytics: marts/metrics.yml - Runtime Error
    Syntax error near line 38
    ------------------------------
    35 |     - name: points_total
    36 |       agg: sum
    37 |       expr: points
    38 | ---
    39 | mf_config_schema: https://github.com/dbt-labs/metricflow/semantic_manifest/v1
    40 | 
    41 | metric:
    
    Raw Error:
    ------------------------------
    expected a single document in the stream
      in "<unicode string>", line 1, column 1
    but found another document
      in "<unicode string>", line 38, column 1
[0m19:17:11.338560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.73754, "process_in_blocks": "0", "process_kernel_time": 2.762891, "process_mem_max_rss": "364052480", "process_out_blocks": "0", "process_user_time": 9.670773}
[0m19:17:11.341249 [debug] [MainThread]: Command `dbt run` failed at 19:17:11.340905 after 17.74 seconds
[0m19:17:11.342256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f252d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e254250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070497d0>]}
[0m19:17:11.343325 [debug] [MainThread]: Flushing usage events
[0m19:17:11.826720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:13.052540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9bd50>]}


============================== 19:18:13.064853 | b051bb51-f2f5-495f-8652-4fbe1f05ed94 ==============================
[0m19:18:13.064853 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:18:13.066469 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_team_season_stats'}
[0m19:18:25.949493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4c550>]}
[0m19:18:26.109351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104205e10>]}
[0m19:18:26.110668 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:18:27.296096 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:18:27.934795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:18:27.937771 [debug] [MainThread]: Partial parsing: added file: premier_league_analytics://models/marts/time_spine.sql
[0m19:18:27.940702 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/fct_team_season_stats.sql
[0m19:18:29.044483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ac2ed0>]}
[0m19:18:29.289413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:18:29.305377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:18:29.571187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11997acd0>]}
[0m19:18:29.572633 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:18:29.576394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199ce350>]}
[0m19:18:29.585215 [info ] [MainThread]: 
[0m19:18:29.588096 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:29.594533 [info ] [MainThread]: 
[0m19:18:29.600417 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:18:29.602904 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:18:29.603990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:30.150384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:18:30.151631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:18:30.157858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:30.152849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:30.896910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a6ad50>]}
[0m19:18:30.899809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:30.928604 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:18:30.932090 [info ] [Thread-1 (]: 1 of 1 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:18:30.934009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.fct_team_season_stats)
[0m19:18:30.935025 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:18:30.976832 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:18:30.989182 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:18:31.080358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:32.378711 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:18:32.383889 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:18:32.865729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:e02c2e0a-8493-4323-b087-bd9a67f2d930&page=queryresults
[0m19:18:38.064405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b051bb51-f2f5-495f-8652-4fbe1f05ed94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a06a810>]}
[0m19:18:38.065724 [info ] [Thread-1 (]: 1 of 1 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 7.12s]
[0m19:18:38.080234 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:18:38.100988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:38.105110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:38.105856 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:18:38.107475 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics' was properly closed.
[0m19:18:38.108497 [info ] [MainThread]: 
[0m19:18:38.110054 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m19:18:38.111640 [debug] [MainThread]: Command end result
[0m19:18:38.197288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:18:38.206183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:18:38.229779 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:18:38.231178 [info ] [MainThread]: 
[0m19:18:38.232546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:38.234285 [info ] [MainThread]: 
[0m19:18:38.236523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:18:38.252533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.377388, "process_in_blocks": "0", "process_kernel_time": 2.782295, "process_mem_max_rss": "381952000", "process_out_blocks": "0", "process_user_time": 10.080747}
[0m19:18:38.253654 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:38.253451 after 25.38 seconds
[0m19:18:38.254379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102486750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023d2010>]}
[0m19:18:38.255088 [debug] [MainThread]: Flushing usage events
[0m19:18:38.713789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:00.977074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe9df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff0f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff34d50>]}


============================== 19:30:00.990785 | edc5f5bd-72c2-4468-8ca7-0375dc774f3c ==============================
[0m19:30:00.990785 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:30:00.991768 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_team_season_stats', 'profiles_dir': '/Users/adilosman/.dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'empty': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80'}
[0m19:30:11.151021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f890cd0>]}
[0m19:30:11.240267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d479650>]}
[0m19:30:11.241210 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:30:11.726587 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:30:12.112894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:12.113881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:12.192738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a5db90>]}
[0m19:30:12.341996 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:30:12.348607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:30:12.441166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09dfd0>]}
[0m19:30:12.442409 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:30:12.443354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b8d510>]}
[0m19:30:12.448502 [info ] [MainThread]: 
[0m19:30:12.449505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:12.463380 [info ] [MainThread]: 
[0m19:30:12.465433 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:30:12.468025 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:30:12.470016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:13.235667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:30:13.236393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:30:13.236857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:13.237332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:13.605360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a2a690>]}
[0m19:30:13.606626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:13.620810 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:30:13.622618 [info ] [Thread-1 (]: 1 of 1 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:30:13.624233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.fct_team_season_stats)
[0m19:30:13.625426 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:30:13.655640 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:30:13.659644 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:30:13.684502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:14.039921 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:30:14.043184 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:30:14.526799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:41b56dd7-ff22-4347-b9a6-aaf96be6b350&page=queryresults
[0m19:30:16.821161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc5f5bd-72c2-4468-8ca7-0375dc774f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fe46d0>]}
[0m19:30:16.823274 [info ] [Thread-1 (]: 1 of 1 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.19s]
[0m19:30:16.825309 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:30:16.827829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:16.855633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:16.858180 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:30:16.859212 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics_staging' was properly closed.
[0m19:30:16.860023 [info ] [MainThread]: 
[0m19:30:16.860992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m19:30:16.862421 [debug] [MainThread]: Command end result
[0m19:30:16.906924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:30:16.912181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:30:16.925312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:30:16.925853 [info ] [MainThread]: 
[0m19:30:16.926430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:16.926873 [info ] [MainThread]: 
[0m19:30:16.927331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:30:16.934970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.064342, "process_in_blocks": "0", "process_kernel_time": 2.263857, "process_mem_max_rss": "358191104", "process_out_blocks": "0", "process_user_time": 7.374984}
[0m19:30:16.935747 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:16.935609 after 16.07 seconds
[0m19:30:16.936341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7029d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff34750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64e290>]}
[0m19:30:16.936908 [debug] [MainThread]: Flushing usage events
[0m19:30:17.468764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:10.795217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105701590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7e10>]}


============================== 19:33:10.803921 | 8f272919-39e9-4fa1-8e17-00bc45480693 ==============================
[0m19:33:10.803921 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:33:10.804812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt parse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'profiles_dir': '/Users/adilosman/.dbt', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'None', 'no_print': 'None'}
[0m19:33:17.901517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f272919-39e9-4fa1-8e17-00bc45480693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966310>]}
[0m19:33:17.984248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f272919-39e9-4fa1-8e17-00bc45480693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f79bd0>]}
[0m19:33:17.985292 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:33:18.448268 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:33:18.805637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:18.806195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:18.872465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f272919-39e9-4fa1-8e17-00bc45480693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184a9bd0>]}
[0m19:33:18.879427 [info ] [MainThread]: Performance info: /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/perf_info.json
[0m19:33:19.016311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:33:19.021740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:33:19.030993 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 8.337151, "process_in_blocks": "0", "process_kernel_time": 1.746772, "process_mem_max_rss": "365170688", "process_out_blocks": "0", "process_user_time": 5.751695}
[0m19:33:19.031993 [debug] [MainThread]: Command `dbt parse` succeeded at 19:33:19.031837 after 8.34 seconds
[0m19:33:19.032562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101139390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012617d0>]}
[0m19:33:19.033072 [debug] [MainThread]: Flushing usage events
[0m19:33:19.449599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:32.780533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a24e490>]}


============================== 19:33:32.789368 | 3d2da440-f956-4ecc-8df6-683bbdfc94c6 ==============================
[0m19:33:32.789368 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:33:32.790202 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'no_print': 'None', 'invocation_command': 'dbt compile'}
[0m19:33:39.273805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a237bd0>]}
[0m19:33:39.353414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107809a90>]}
[0m19:33:39.354951 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:33:39.830594 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:33:40.189990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:40.190574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:40.258070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ccb47d0>]}
[0m19:33:40.388703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:33:40.393933 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:33:40.457848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd61950>]}
[0m19:33:40.458614 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:33:40.459208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca23190>]}
[0m19:33:40.462230 [info ] [MainThread]: 
[0m19:33:40.462961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:40.463538 [info ] [MainThread]: 
[0m19:33:40.465782 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:40.478280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:33:40.479644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:33:40.480698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:40.481164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:40.880213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d2da440-f956-4ecc-8df6-683bbdfc94c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc6a450>]}
[0m19:33:40.881196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:40.892557 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:33:40.893538 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:33:40.894454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:33:40.895314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.time_spine)
[0m19:33:40.896080 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:33:40.896764 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:33:40.925972 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:33:40.927750 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:33:40.929428 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:33:40.930286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:40.931020 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:33:40.933441 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:33:40.933956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:40.936500 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:33:40.937650 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:33:40.938181 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:33:40.938658 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:33:40.939067 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:33:40.939585 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:33:40.940296 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:33:40.940878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:33:40.941383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:33:40.942056 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:33:40.942771 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:33:40.943427 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:33:40.943953 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:33:40.947392 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:33:40.964355 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:33:40.976076 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:33:40.977705 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:33:40.981007 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:33:40.981893 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:33:40.982495 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:33:40.983019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:33:40.983461 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:33:40.984052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:33:40.984595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:40.985257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:40.987721 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:33:40.990387 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:33:40.993085 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:33:40.993871 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:33:40.996235 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:33:40.996885 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:33:40.997505 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:33:40.998111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:33:40.998722 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:33:40.999813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:33:41.000759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now model.premier_league_analytics.fct_match_results)
[0m19:33:41.001436 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:33:41.002125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:33:41.002733 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:33:41.003308 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:33:41.012141 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:33:41.013191 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:33:41.025646 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:33:41.032925 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:33:41.039325 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:33:41.040558 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:33:41.042012 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:33:41.043135 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:33:41.043768 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:33:41.044714 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:33:41.045246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:41.048041 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:33:41.049018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:33:41.050095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:41.051397 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:33:41.055185 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:33:41.060328 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:33:41.064003 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:33:41.064954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:33:41.066771 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:33:41.067839 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:33:41.086121 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:33:41.105328 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:33:41.123972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now model.premier_league_analytics.fct_team_season_stats)
[0m19:33:41.143178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:33:41.144610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:33:41.155727 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:33:41.157047 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:33:41.158124 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:33:41.159226 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:33:41.168630 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:33:41.169818 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:33:41.186873 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:33:41.194920 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:33:41.196286 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:33:41.198262 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:33:41.202633 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:33:41.203499 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:33:41.204224 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:33:41.204995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:41.205908 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:33:41.206836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:41.207865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:33:41.209655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:33:41.214087 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:33:41.218985 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:33:41.220290 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:33:41.220879 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:33:41.221966 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:33:41.228238 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:33:41.228981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:33:41.229803 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:33:41.235035 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:33:41.236080 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:33:41.236730 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:33:41.237522 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:33:41.239524 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:33:41.240051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:33:41.242196 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:33:41.243560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:41.244052 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m19:33:41.244399 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:33:41.244706 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:33:41.245021 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:33:41.247479 [debug] [MainThread]: Command end result
[0m19:33:41.286295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:33:41.289490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:33:41.298814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:33:41.307010 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.627212, "process_in_blocks": "0", "process_kernel_time": 1.678988, "process_mem_max_rss": "371634176", "process_out_blocks": "0", "process_user_time": 6.33217}
[0m19:33:41.308262 [debug] [MainThread]: Command `dbt compile` succeeded at 19:33:41.307979 after 8.63 seconds
[0m19:33:41.309236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae5850>]}
[0m19:33:41.309981 [debug] [MainThread]: Flushing usage events
[0m19:33:41.712047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:07.234313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148ad750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114927bd0>]}


============================== 19:37:07.242659 | a16b0261-35a1-4297-9427-8e6edea60046 ==============================
[0m19:37:07.242659 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:37:07.243415 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt parse', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'empty': 'None', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m19:37:14.287802 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('semantic-models-paths' was unexpected)

Error encountered in /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/dbt_project.yml
[0m19:37:14.297438 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 7.160675, "process_in_blocks": "0", "process_kernel_time": 1.497559, "process_mem_max_rss": "355241984", "process_out_blocks": "0", "process_user_time": 4.985223}
[0m19:37:14.298980 [debug] [MainThread]: Command `dbt parse` failed at 19:37:14.298700 after 7.16 seconds
[0m19:37:14.299843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110079390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110219a50>]}
[0m19:37:14.303478 [debug] [MainThread]: Flushing usage events
[0m19:37:14.734390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:27.741069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abfd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac56210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac6fd90>]}


============================== 19:40:27.755695 | c507c476-da99-463f-92d5-f6b00aecc9df ==============================
[0m19:40:27.755695 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:40:27.756882 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'empty': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'write_json': 'True', 'partial_parse': 'True'}
[0m19:40:36.907794 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'model-paths' in "<unicode string>", line 8, column 1 in file `/Us
ers/adilosman/Desktop/premier-league-analytics-warehouse/dbt/dbt_project.yml`
[0m19:40:36.909434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c507c476-da99-463f-92d5-f6b00aecc9df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d26d3d0>]}
[0m19:40:37.233479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c507c476-da99-463f-92d5-f6b00aecc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac2a390>]}
[0m19:40:37.340536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c507c476-da99-463f-92d5-f6b00aecc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108211990>]}
[0m19:40:37.341710 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:40:37.913991 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:40:38.137226 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:40:38.138354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c507c476-da99-463f-92d5-f6b00aecc9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54ae90>]}
[0m19:40:38.180814 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading premier_league_analytics: metrics.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |   type: simple
    8  |   type_params:
    9  |     measure: goals_for_total
    10 | ---
    11 | mf_config_schema: https://github.com/dbt-labs/metricflow/semantic_manifest/v1
    12 | 
    13 | metric:
    
    Raw Error:
    ------------------------------
    expected a single document in the stream
      in "<unicode string>", line 1, column 1
    but found another document
      in "<unicode string>", line 10, column 1
[0m19:40:38.181986 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:40:38.198291 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 10.591487, "process_in_blocks": "0", "process_kernel_time": 2.191559, "process_mem_max_rss": "364273664", "process_out_blocks": "0", "process_user_time": 7.128325}
[0m19:40:38.200641 [debug] [MainThread]: Command `dbt parse` failed at 19:40:38.199890 after 10.59 seconds
[0m19:40:38.201482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106579c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d598b50>]}
[0m19:40:38.202177 [debug] [MainThread]: Flushing usage events
[0m19:40:38.680516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:26.036131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8bd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d7d90>]}


============================== 19:43:26.058297 | 60a87800-3ab1-4d05-9d22-d74b39f225bc ==============================
[0m19:43:26.058297 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:43:26.060988 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt parse', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'partial_parse': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'log_format': 'default', 'empty': 'None'}
[0m19:43:45.114463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a87800-3ab1-4d05-9d22-d74b39f225bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe96c10>]}
[0m19:43:45.767989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a87800-3ab1-4d05-9d22-d74b39f225bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae799d0>]}
[0m19:43:45.771778 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:43:47.440413 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:43:47.909715 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:43:47.913132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60a87800-3ab1-4d05-9d22-d74b39f225bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca401d0>]}
[0m19:43:52.305799 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m19:43:52.307147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60a87800-3ab1-4d05-9d22-d74b39f225bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202cde90>]}
[0m19:43:53.076357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a87800-3ab1-4d05-9d22-d74b39f225bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205d7190>]}
[0m19:43:53.094155 [info ] [MainThread]: Performance info: /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/perf_info.json
[0m19:43:53.418993 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:43:53.427197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:43:53.433509 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:43:53.463902 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 27.671892, "process_in_blocks": "0", "process_kernel_time": 3.668247, "process_mem_max_rss": "374231040", "process_out_blocks": "0", "process_user_time": 14.21655}
[0m19:43:53.465590 [debug] [MainThread]: Command `dbt parse` succeeded at 19:43:53.465252 after 27.67 seconds
[0m19:43:53.466826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109169790>]}
[0m19:43:53.481859 [debug] [MainThread]: Flushing usage events
[0m19:43:54.031149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:39.061072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108569c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b036ed0>]}


============================== 19:44:39.072985 | 0fbe500f-81ed-4309-9f5a-c330d57fe57a ==============================
[0m19:44:39.072985 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:44:39.073995 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mf_time_spine fct_team_season_stats', 'profiles_dir': '/Users/adilosman/.dbt', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m19:44:51.694323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f4690>]}
[0m19:44:51.854375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a4510>]}
[0m19:44:51.856421 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:44:53.030357 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:44:53.653901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:53.655192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:53.775496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11daa5150>]}
[0m19:44:53.989398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:44:54.007974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:44:54.109369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6fbcd0>]}
[0m19:44:54.110897 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:44:54.112336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db41550>]}
[0m19:44:54.114588 [warn ] [MainThread]: The selection criterion 'mf_time_spine' does not match any enabled nodes
[0m19:44:54.124486 [info ] [MainThread]: 
[0m19:44:54.125625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:44:54.131746 [info ] [MainThread]: 
[0m19:44:54.133576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:54.135271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:44:54.136112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:54.576971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:44:54.578326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:54.583279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:44:54.667603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:55.078752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9c43d0>]}
[0m19:44:55.079734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:55.093566 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:44:55.095630 [info ] [Thread-1 (]: 1 of 1 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:44:55.097345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.fct_team_season_stats)
[0m19:44:55.098630 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:44:55.145848 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:44:55.150299 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:44:55.194380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:55.587222 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:44:55.591239 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:44:55.907281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:22df8d75-25fa-4d39-b76e-261c96bd0892&page=queryresults
[0m19:44:58.417821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbe500f-81ed-4309-9f5a-c330d57fe57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dca9510>]}
[0m19:44:58.419452 [info ] [Thread-1 (]: 1 of 1 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.32s]
[0m19:44:58.420518 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:44:58.422383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:58.425282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:58.431364 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:44:58.434230 [debug] [MainThread]: Connection 'list_pl-football-analytics_football_analytics_football_analytics' was properly closed.
[0m19:44:58.435769 [info ] [MainThread]: 
[0m19:44:58.436737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m19:44:58.437724 [debug] [MainThread]: Command end result
[0m19:44:58.491616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:44:58.497694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:44:58.511208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:44:58.512434 [info ] [MainThread]: 
[0m19:44:58.514132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:44:58.515566 [info ] [MainThread]: 
[0m19:44:58.517190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:44:58.529681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.6335, "process_in_blocks": "0", "process_kernel_time": 2.981237, "process_mem_max_rss": "376184832", "process_out_blocks": "0", "process_user_time": 10.857482}
[0m19:44:58.530702 [debug] [MainThread]: Command `dbt run` succeeded at 19:44:58.530503 after 19.63 seconds
[0m19:44:58.531750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b021cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677ac50>]}
[0m19:44:58.532481 [debug] [MainThread]: Flushing usage events
[0m19:44:59.092035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:17.483143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b95f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113baa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113baae90>]}


============================== 19:45:17.493266 | be472879-afaf-45f9-b516-c8b12b29d490 ==============================
[0m19:45:17.493266 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:45:17.494544 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'None', 'log_format': 'default', 'profiles_dir': '/Users/adilosman/.dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs generate'}
[0m19:45:28.565582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261c6410>]}
[0m19:45:30.047154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111185d0>]}
[0m19:45:30.051888 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:45:31.188922 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:45:31.708438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:31.709632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:31.802987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126370590>]}
[0m19:45:31.899501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126554690>]}
[0m19:45:31.900450 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:45:31.901362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12666c990>]}
[0m19:45:31.905190 [info ] [MainThread]: 
[0m19:45:31.906070 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:45:31.907880 [info ] [MainThread]: 
[0m19:45:31.912070 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:45:31.926740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:45:31.929818 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:45:31.934449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:31.935143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:32.431535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be472879-afaf-45f9-b516-c8b12b29d490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126393cd0>]}
[0m19:45:32.432413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:32.458746 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:45:32.459925 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:45:32.463387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:45:32.465093 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.time_spine)
[0m19:45:32.466359 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:45:32.467545 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:45:32.496362 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:45:32.505422 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:45:32.513364 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:45:32.515174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:45:32.520359 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:45:32.521572 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:45:32.522296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.527224 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:45:32.529791 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:45:32.530528 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:45:32.531717 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:45:32.532765 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:45:32.533637 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:45:32.534456 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:45:32.535084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:45:32.535697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:45:32.536289 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:45:32.536853 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:45:32.537406 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:45:32.537959 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:45:32.543012 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:45:32.582028 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:45:32.586395 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:45:32.594064 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:45:32.600157 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:45:32.602300 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:45:32.603957 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:45:32.604785 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:45:32.605815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:45:32.606644 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:45:32.613612 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:45:32.615706 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:45:32.620609 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:45:32.621515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.622325 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:45:32.624050 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:45:32.626884 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:45:32.628721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:45:32.632352 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:45:32.633288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:45:32.634148 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:45:32.634847 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:45:32.635518 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:45:32.636128 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:45:32.636753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.fct_match_results)
[0m19:45:32.643824 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:45:32.645805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:45:32.662480 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:45:32.663860 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:45:32.665770 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:45:32.675512 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:45:32.682126 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:45:32.683637 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:45:32.686965 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:45:32.688481 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:45:32.690945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:45:32.692410 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:45:32.698245 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:45:32.700923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:45:32.703655 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:45:32.705983 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:45:32.707462 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:45:32.709139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.717438 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:45:32.719149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:45:32.723386 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:45:32.724709 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:45:32.725358 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:45:32.726014 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:45:32.726591 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:45:32.737166 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:45:32.738548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m19:45:32.739650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:45:32.740318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:45:32.741199 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:45:32.742033 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:45:32.742868 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:45:32.743570 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:45:32.767039 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:45:32.789504 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:45:32.792209 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:45:32.793147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:45:32.802939 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:45:32.804720 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:45:32.806091 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:45:32.807396 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:45:32.808397 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:45:32.809556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.816253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:45:32.817675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:45:32.819399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:45:32.821064 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:45:32.824315 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:45:32.828508 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:45:32.835486 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:45:32.842947 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:45:32.848387 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:45:32.850278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:45:32.851612 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:45:32.859192 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:45:32.868597 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:45:32.870647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:45:32.874592 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:45:32.876166 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:45:32.878865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:32.883542 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:45:32.888663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:32.889387 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:45:32.889924 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:45:32.890415 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:45:32.890897 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:45:32.899492 [debug] [MainThread]: Command end result
[0m19:45:33.123290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:45:33.131019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:45:33.144492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:45:33.309788 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m19:45:33.310844 [info ] [MainThread]: Building catalog
[0m19:45:33.323525 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:45:33.325045 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:45:33.326243 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:45:33.401775 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:45:33.392580 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('mf_time_spine')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:45:33.415751 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:45:33.418200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:33.419473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:33.420703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:34.222196 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:1fe413c1-9c3c-4df9-8271-87966bcb2dbb&page=queryresults
[0m19:45:34.235845 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:adc89cd0-c9e9-461e-b6e9-e9e330e04e76&page=queryresults
[0m19:45:34.287280 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:7ab65956-9c54-4d8f-b341-0f40039de333&page=queryresults
[0m19:45:35.652059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:35.682059 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:45:35.731042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:45:35.736484 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:45:35.737187 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:45:35.749819 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 18.456654, "process_in_blocks": "0", "process_kernel_time": 2.83376, "process_mem_max_rss": "355033088", "process_out_blocks": "0", "process_user_time": 10.216759}
[0m19:45:35.753771 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:45:35.753213 after 18.46 seconds
[0m19:45:35.755305 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:45:35.756140 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:45:35.757117 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:45:35.758307 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:45:35.760012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bcbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138bbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113be4210>]}
[0m19:45:35.763382 [debug] [MainThread]: Flushing usage events
[0m19:45:36.139956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:25.548672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f584d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd2b10>]}


============================== 19:47:25.561617 | 5b139624-7aff-41c0-ae08-1644f2e7a375 ==============================
[0m19:47:25.561617 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:47:25.563697 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/adilosman/.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select time_spine fct_team_season_stats', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m19:47:37.612226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1271d0>]}
[0m19:47:37.806604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e540150>]}
[0m19:47:37.811595 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:47:38.600126 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:47:38.925219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:38.926020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:39.035874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a3bf50>]}
[0m19:47:39.237615 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:47:39.242249 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:47:39.287946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123693dd0>]}
[0m19:47:39.288971 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:47:39.289734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12356b590>]}
[0m19:47:39.292887 [info ] [MainThread]: 
[0m19:47:39.293855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:39.294747 [info ] [MainThread]: 
[0m19:47:39.298648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:39.329357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:47:39.331302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:39.925178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m19:47:39.926678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:47:39.927710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:39.928551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:40.334939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123618150>]}
[0m19:47:40.336340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:40.356783 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:47:40.357805 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:47:40.359293 [info ] [Thread-1 (]: 1 of 2 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:47:40.360805 [info ] [Thread-2 (]: 2 of 2 START sql table model football_analytics_football_analytics.mf_time_spine  [RUN]
[0m19:47:40.362210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.fct_team_season_stats)
[0m19:47:40.363443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.time_spine)
[0m19:47:40.364614 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:47:40.366694 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:47:40.392943 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:47:40.400335 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:47:40.407172 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:47:40.408617 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:47:40.442983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:40.448369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:40.893853 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:47:40.894654 [debug] [Thread-2 (]: Writing runtime sql for node "model.premier_league_analytics.time_spine"
[0m19:47:40.897610 [debug] [Thread-2 (]: On model.premier_league_analytics.time_spine: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.time_spine"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`mf_time_spine`
      
    
    

    
    OPTIONS()
    as (
      

-- Time spine for MetricFlow (daily grain).
with spine as (
  select day as date_day
  from unnest(generate_date_array(date '2014-07-01', date '2025-06-30', interval 1 day)) as day
)

select * from spine
    );
  
[0m19:47:40.901100 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:47:41.142218 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:7b0867e7-cebf-4e0c-81bf-b0950ecc7e8c&page=queryresults
[0m19:47:41.245177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:42d0e029-4c97-45e7-90f1-dfae9a5dff4b&page=queryresults
[0m19:47:44.584969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ba2dd0>]}
[0m19:47:44.585676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b139624-7aff-41c0-ae08-1644f2e7a375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a7c850>]}
[0m19:47:44.587462 [info ] [Thread-2 (]: 2 of 2 OK created sql table model football_analytics_football_analytics.mf_time_spine  [[32mCREATE TABLE (4.0k rows, 0 processed)[0m in 4.21s]
[0m19:47:44.589140 [info ] [Thread-1 (]: 1 of 2 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.22s]
[0m19:47:44.590856 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:47:44.591935 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:47:44.595763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:44.605423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:44.610590 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:47:44.611788 [debug] [MainThread]: Connection 'model.premier_league_analytics.time_spine' was properly closed.
[0m19:47:44.613174 [info ] [MainThread]: 
[0m19:47:44.614749 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m19:47:44.617170 [debug] [MainThread]: Command end result
[0m19:47:44.699927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:47:44.712246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:47:44.741750 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:47:44.742861 [info ] [MainThread]: 
[0m19:47:44.745865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:44.747006 [info ] [MainThread]: 
[0m19:47:44.748934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:47:44.778441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.385822, "process_in_blocks": "0", "process_kernel_time": 2.386743, "process_mem_max_rss": "369303552", "process_out_blocks": "0", "process_user_time": 10.336361}
[0m19:47:44.780710 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:44.780333 after 19.39 seconds
[0m19:47:44.781983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbe5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f4ff50>]}
[0m19:47:44.783129 [debug] [MainThread]: Flushing usage events
[0m19:47:45.179564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:04.076808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bf250>]}


============================== 19:48:04.105261 | 067bb33d-6f87-465b-8d19-0dad3e75a300 ==============================
[0m19:48:04.105261 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:48:04.106882 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/Users/adilosman/.dbt', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'printer_width': '80', 'warn_error': 'None'}
[0m19:48:35.049873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783c550>]}
[0m19:48:35.149378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e34790>]}
[0m19:48:35.150615 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:48:35.791346 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:48:36.506371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:36.507082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:36.595639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2dab50>]}
[0m19:48:36.776509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e55410>]}
[0m19:48:36.777331 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:48:36.778026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2ee090>]}
[0m19:48:36.781356 [info ] [MainThread]: 
[0m19:48:36.782048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:36.782562 [info ] [MainThread]: 
[0m19:48:36.783831 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:48:36.797055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:48:36.798240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:48:36.799275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:36.799904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:37.184069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067bb33d-6f87-465b-8d19-0dad3e75a300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df9910>]}
[0m19:48:37.185132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:37.196642 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:48:37.197484 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:48:37.198506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:48:37.199408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.time_spine)
[0m19:48:37.200407 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:48:37.201768 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:48:37.226252 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:48:37.231252 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:48:37.235447 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:48:37.236465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:37.237661 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:48:37.240811 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:48:37.241455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:37.244936 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:48:37.247230 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:48:37.248096 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:48:37.248811 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:48:37.249744 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:48:37.250967 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:48:37.252233 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:48:37.253190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:48:37.254081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:48:37.255255 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:48:37.256253 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:48:37.257252 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:48:37.258294 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:48:37.264410 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:48:37.278770 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:48:37.283312 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:48:37.288236 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:48:37.294157 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:48:37.294737 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:48:37.295213 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:48:37.295945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:37.296484 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:48:37.297093 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:48:37.297658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:48:37.298411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:37.300898 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:48:37.303403 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:48:37.306289 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:48:37.307331 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:48:37.310476 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:48:37.311484 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:48:37.312727 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:48:37.313729 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:48:37.314494 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:48:37.315439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:48:37.316204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.fct_match_results)
[0m19:48:37.317136 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:48:37.318330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:48:37.318957 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:48:37.319439 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:48:37.324406 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:48:37.325097 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:48:37.334751 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:48:37.339162 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:48:37.345083 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:48:37.346051 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:48:37.347337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:37.350907 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:48:37.351947 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:48:37.352595 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:48:37.353272 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:48:37.353995 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:48:37.354959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:48:37.356094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:48:37.357112 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:48:37.358047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:37.359230 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:48:37.362549 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:48:37.366635 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:48:37.368971 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:48:37.374362 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:48:37.375586 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:48:37.376062 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:48:37.376553 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:48:37.377749 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m19:48:37.379620 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:48:37.380354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:48:37.381110 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:48:37.381781 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:48:37.382353 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:48:37.382797 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:48:37.386834 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:48:37.399552 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:48:37.400496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:37.409588 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:48:37.414794 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:48:37.416279 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:48:37.417400 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:48:37.418709 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:48:37.420244 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:48:37.421077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:48:37.421885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:48:37.422733 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:48:37.425294 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:48:37.427980 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:48:37.428529 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:48:37.429195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:37.430062 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:48:37.436391 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:48:37.437489 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:48:37.439798 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:48:37.440652 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:48:37.450414 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:48:37.452126 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:48:37.453256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:37.457863 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:48:37.459153 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:48:37.460403 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:48:37.464875 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:48:37.467362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:37.468301 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m19:48:37.468818 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:48:37.469251 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:48:37.469668 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:48:37.473015 [debug] [MainThread]: Command end result
[0m19:48:37.645575 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:48:37.653332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:48:37.672074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:48:37.805462 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m19:48:37.806358 [info ] [MainThread]: Building catalog
[0m19:48:37.818842 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:48:37.829404 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:48:37.825379 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:48:38.107732 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:48:38.117511 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:48:38.118998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:38.122989 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('mf_time_spine')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:48:38.124456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:38.200799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:38.895005 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:d65ede75-d680-432b-a788-1915deabe470&page=queryresults
[0m19:48:38.898759 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:36fe17ff-bd21-4403-91d1-14e43ded4c79&page=queryresults
[0m19:48:38.913956 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5a4941f5-7a40-475d-8816-0291d9eda54f&page=queryresults
[0m19:48:40.346078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:40.394599 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:48:40.468159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:48:40.473954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:48:40.474648 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:48:40.485131 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 36.599564, "process_in_blocks": "0", "process_kernel_time": 2.443656, "process_mem_max_rss": "379412480", "process_out_blocks": "0", "process_user_time": 9.909012}
[0m19:48:40.487636 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:48:40.487282 after 36.60 seconds
[0m19:48:40.488666 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:48:40.495739 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:48:40.497295 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:48:40.500280 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:48:40.503781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078dbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ddbbd0>]}
[0m19:48:40.507995 [debug] [MainThread]: Flushing usage events
[0m19:48:40.875117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:58.496258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126ec90>]}


============================== 19:48:58.511293 | 53d8eb87-72d0-4220-8598-a57a2b615308 ==============================
[0m19:48:58.511293 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:48:58.513175 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'introspect': 'True', 'empty': 'None', 'invocation_command': 'dbt docs serve --no-browser --port 8080', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m19:49:08.944820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53d8eb87-72d0-4220-8598-a57a2b615308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f431850>]}
[0m19:49:09.052816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53d8eb87-72d0-4220-8598-a57a2b615308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d8650>]}
[0m19:50:23.794200 [error] [MainThread]: Encountered an error:

[0m19:50:23.877893 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:50:23.889908 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 85.570625, "process_in_blocks": "0", "process_kernel_time": 2.207449, "process_mem_max_rss": "357277696", "process_out_blocks": "0", "process_user_time": 8.044673}
[0m19:50:23.894911 [debug] [MainThread]: Command `dbt docs serve` failed at 19:50:23.894452 after 85.58 seconds
[0m19:50:23.897636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e79e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111eb650>]}
[0m19:50:23.899720 [debug] [MainThread]: Flushing usage events
[0m19:50:24.507636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:45.184692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2f1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd7abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd7b490>]}


============================== 19:52:45.221061 | 3c8060b0-a0a8-41e0-a5b4-e539faaeea79 ==============================
[0m19:52:45.221061 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:52:45.222814 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m19:53:10.082114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1fb50>]}
[0m19:53:10.173169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d308450>]}
[0m19:53:10.174214 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:53:10.864608 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:53:11.715318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:11.716365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:11.808197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12285d110>]}
[0m19:53:12.005950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122683a90>]}
[0m19:53:12.007384 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:53:12.008563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12271abd0>]}
[0m19:53:12.014929 [info ] [MainThread]: 
[0m19:53:12.016448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:12.017326 [info ] [MainThread]: 
[0m19:53:12.018386 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:12.031184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:53:12.032488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:53:12.033243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:12.033894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:12.498001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c8060b0-a0a8-41e0-a5b4-e539faaeea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28cad0>]}
[0m19:53:12.499025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:12.518618 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:53:12.519724 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:53:12.522089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m19:53:12.523320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.time_spine)
[0m19:53:12.524164 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:53:12.524900 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:53:12.542546 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:53:12.551275 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:53:12.557816 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:53:12.559026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:12.559937 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:53:12.561464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:12.565376 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:53:12.569233 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:53:12.570002 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:53:12.570453 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:12.570918 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:12.571330 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:12.571990 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:53:12.572538 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:53:12.573003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:53:12.573466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:53:12.573876 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:53:12.574383 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:12.574879 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:12.575287 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:12.580203 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:53:12.595753 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:53:12.605002 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:53:12.615337 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:53:12.620979 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:12.621672 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:53:12.622478 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:53:12.623062 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:12.623504 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:12.623940 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:12.624673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:12.627236 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:53:12.627869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:12.630383 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:53:12.632877 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:53:12.633507 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:12.634399 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:12.636563 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:53:12.637730 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:53:12.638451 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:53:12.639068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:53:12.639630 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:12.640226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now model.premier_league_analytics.fct_match_results)
[0m19:53:12.640799 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:12.641353 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:12.642268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:53:12.643416 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:53:12.653766 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:53:12.670975 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:53:12.671808 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:12.676959 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:53:12.687775 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:53:12.688796 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:12.691756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:53:12.689948 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:12.696526 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:53:12.697876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:53:12.699429 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:12.701084 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:53:12.702665 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:12.704183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:53:12.708672 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:53:12.710141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:12.713948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:12.715781 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:12.720057 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:53:12.722962 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:53:12.729756 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:53:12.731417 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:12.732377 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:12.733158 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:12.734524 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m19:53:12.735867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:53:12.737188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:53:12.738093 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:53:12.738867 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:12.739618 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:12.740295 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:12.748209 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:53:12.749535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:53:12.782637 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:53:12.787071 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:53:12.788524 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:12.795829 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:53:12.793869 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:53:12.797064 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:12.798330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:53:12.805420 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:12.811854 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:53:12.816825 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:12.792504 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:53:12.817745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:12.819304 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:12.823720 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:53:12.824558 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_team_season_stats, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:53:12.825477 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:12.826152 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:12.826953 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:12.827562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:53:12.828128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:12.834902 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:53:12.837579 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:53:12.841026 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:53:12.842465 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:12.843670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:53:12.848364 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:53:12.850935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:12.852032 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f' was properly closed.
[0m19:53:12.853018 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:53:12.853915 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:53:12.854875 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:53:12.861674 [debug] [MainThread]: Command end result
[0m19:53:13.078226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:53:13.086246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:53:13.119023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:53:13.280266 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m19:53:13.280881 [info ] [MainThread]: Building catalog
[0m19:53:13.308296 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:53:13.310597 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:53:13.312427 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:53:13.395596 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('mf_time_spine')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:53:13.397474 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:53:13.399399 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:53:13.401679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:13.402814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:13.404260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:13.978370 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5a53d5c3-56f2-431a-b879-b2813f394481&page=queryresults
[0m19:53:14.029953 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:fce373ed-8d8d-485b-a906-ce1065e31f10&page=queryresults
[0m19:53:14.560766 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:98df4b85-83ca-4731-b377-f728de974978&page=queryresults
[0m19:53:16.121158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:16.152093 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:53:16.224317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:53:16.231361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:53:16.232407 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:53:16.253280 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 31.350317, "process_in_blocks": "0", "process_kernel_time": 2.31469, "process_mem_max_rss": "379006976", "process_out_blocks": "0", "process_user_time": 9.247099}
[0m19:53:16.254922 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:53:16.254587 after 31.35 seconds
[0m19:53:16.256041 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:53:16.257077 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:53:16.258041 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:53:16.259193 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:53:16.260345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd7a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd62690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b8250>]}
[0m19:53:16.261695 [debug] [MainThread]: Flushing usage events
[0m19:53:16.680943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:37.740504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f75b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8ac90>]}


============================== 19:53:37.750095 | ecfd4b00-c00d-4741-84ef-8c380051fc2d ==============================
[0m19:53:37.750095 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:53:37.751190 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'invocation_command': 'dbt run --select time_spine fct_team_season_stats', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m19:53:47.338928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f08590>]}
[0m19:53:47.446267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51cf90>]}
[0m19:53:47.447458 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:53:47.978782 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:53:48.406398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:48.407869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:48.574807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12395a710>]}
[0m19:53:48.854817 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:53:48.863772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:53:48.945256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123629ad0>]}
[0m19:53:48.946682 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:53:48.947754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12396a7d0>]}
[0m19:53:48.953828 [info ] [MainThread]: 
[0m19:53:48.957938 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:48.959105 [info ] [MainThread]: 
[0m19:53:48.966949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:48.975319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m19:53:48.976190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:49.372285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m19:53:49.373768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:53:49.374705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:49.375368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:49.722090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100eb4d0>]}
[0m19:53:49.722851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:49.730699 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:49.731303 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:53:49.732000 [info ] [Thread-1 (]: 1 of 2 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m19:53:49.732756 [info ] [Thread-2 (]: 2 of 2 START sql table model football_analytics_football_analytics.mf_time_spine  [RUN]
[0m19:53:49.733493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.fct_team_season_stats)
[0m19:53:49.734048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.time_spine)
[0m19:53:49.734543 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:53:49.734975 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:53:49.763577 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:53:49.762881 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:53:49.767093 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:53:49.773127 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:53:49.801536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:49.795376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:50.230661 [debug] [Thread-2 (]: Writing runtime sql for node "model.premier_league_analytics.time_spine"
[0m19:53:50.231365 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:53:50.236024 [debug] [Thread-1 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m19:53:50.238079 [debug] [Thread-2 (]: On model.premier_league_analytics.time_spine: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.time_spine"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`mf_time_spine`
      
    
    

    
    OPTIONS()
    as (
      

-- Time spine for MetricFlow (daily grain).
with spine as (
  select day as date_day
  from unnest(generate_date_array(date '2014-07-01', date '2025-06-30', interval 1 day)) as day
)

select * from spine
    );
  
[0m19:53:50.516294 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:dc83ddfc-1442-4bef-b302-e6ceb2f27150&page=queryresults
[0m19:53:50.697777 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:4c08dafb-f18f-4e78-8e05-ddd64a6b3854&page=queryresults
[0m19:53:52.634787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123be0ad0>]}
[0m19:53:52.636404 [info ] [Thread-2 (]: 2 of 2 OK created sql table model football_analytics_football_analytics.mf_time_spine  [[32mCREATE TABLE (4.0k rows, 0 processed)[0m in 2.89s]
[0m19:53:52.637191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfd4b00-c00d-4741-84ef-8c380051fc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b0c410>]}
[0m19:53:52.638344 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:53:52.639440 [info ] [Thread-1 (]: 1 of 2 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.90s]
[0m19:53:52.641057 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:53:52.645753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:52.655233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:52.656325 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:53:52.657237 [debug] [MainThread]: Connection 'model.premier_league_analytics.time_spine' was properly closed.
[0m19:53:52.658262 [info ] [MainThread]: 
[0m19:53:52.659392 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m19:53:52.662156 [debug] [MainThread]: Command end result
[0m19:53:52.703844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:53:52.710195 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:53:52.722210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:53:52.722744 [info ] [MainThread]: 
[0m19:53:52.723411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:52.723942 [info ] [MainThread]: 
[0m19:53:52.724454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:53:52.732035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.137694, "process_in_blocks": "0", "process_kernel_time": 2.313569, "process_mem_max_rss": "376815616", "process_out_blocks": "0", "process_user_time": 9.165532}
[0m19:53:52.732962 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:52.732748 after 15.14 seconds
[0m19:53:52.733608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f07ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6fad10>]}
[0m19:53:52.734135 [debug] [MainThread]: Flushing usage events
[0m19:53:53.082226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:04.729088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140995d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141126d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114112fd0>]}


============================== 19:54:04.739960 | c4507636-22a7-4d3b-8978-bbca9f9cf8b7 ==============================
[0m19:54:04.739960 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:54:04.741595 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/Users/adilosman/.dbt', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None'}
[0m19:54:15.532558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267f9e50>]}
[0m19:54:15.635823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11165c7d0>]}
[0m19:54:15.636910 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:54:16.266329 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m19:54:16.754796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:16.756042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:16.855202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140d7190>]}
[0m19:54:16.933029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266e6810>]}
[0m19:54:16.933853 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m19:54:16.934603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ab90d0>]}
[0m19:54:16.937939 [info ] [MainThread]: 
[0m19:54:16.938621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:16.939124 [info ] [MainThread]: 
[0m19:54:16.940676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:54:16.952976 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m19:54:16.954699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m19:54:16.957218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:16.958281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:17.373575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4507636-22a7-4d3b-8978-bbca9f9cf8b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266c7750>]}
[0m19:54:17.374780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:17.385445 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m19:54:17.386346 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m19:54:17.387340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.stg_pl_matches)
[0m19:54:17.388215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.time_spine)
[0m19:54:17.389006 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m19:54:17.389685 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m19:54:17.411828 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m19:54:17.418764 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m19:54:17.421885 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m19:54:17.422874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:17.426340 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m19:54:17.428042 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m19:54:17.429068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:17.432423 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m19:54:17.434214 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m19:54:17.434854 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:54:17.435567 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:54:17.436071 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:54:17.436760 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.premier_league_analytics.dim_team'
[0m19:54:17.437376 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m19:54:17.438027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m19:54:17.438561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m19:54:17.439036 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m19:54:17.439499 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:54:17.439962 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:54:17.440476 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:54:17.446468 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m19:54:17.476126 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m19:54:17.476572 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m19:54:17.482017 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m19:54:17.484465 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m19:54:17.485442 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:54:17.486146 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:54:17.486667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:17.487107 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:54:17.489362 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m19:54:17.489914 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:54:17.490421 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:54:17.494637 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m19:54:17.495591 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:54:17.496699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:17.497598 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:54:17.500009 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m19:54:17.500747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m19:54:17.501661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m19:54:17.504041 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m19:54:17.505136 [debug] [Thread-3 (]: Began running node model.premier_league_analytics.fct_match_results
[0m19:54:17.506219 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:54:17.507227 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:54:17.508254 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:54:17.509542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.fct_match_results)
[0m19:54:17.518963 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m19:54:17.527589 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m19:54:17.528462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m19:54:17.529033 [debug] [Thread-3 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m19:54:17.530075 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:54:17.537249 [debug] [Thread-3 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m19:54:17.543557 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m19:54:17.544644 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:54:17.545252 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:54:17.546506 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:54:17.547629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:17.548766 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:54:17.549437 [debug] [Thread-3 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m19:54:17.551780 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m19:54:17.552666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:17.556652 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m19:54:17.557932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:54:17.559319 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:54:17.565070 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m19:54:17.566285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m19:54:17.568493 [debug] [Thread-3 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m19:54:17.569372 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:54:17.570297 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m19:54:17.577800 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:54:17.579034 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m19:54:17.579537 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:54:17.580186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now model.premier_league_analytics.fct_team_season_stats)
[0m19:54:17.580958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m19:54:17.581753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m19:54:17.582456 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m19:54:17.583103 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:54:17.583726 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:54:17.584308 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:54:17.588470 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m19:54:17.605136 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m19:54:17.616661 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m19:54:17.618206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:54:17.621879 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m19:54:17.622850 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:54:17.623620 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:54:17.624254 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m19:54:17.624836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m19:54:17.625607 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:54:17.626137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:54:17.626903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:54:17.628086 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:54:17.628836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:17.631703 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m19:54:17.638740 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m19:54:17.641659 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m19:54:17.646431 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m19:54:17.648171 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:54:17.649303 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:54:17.650443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m19:54:17.651592 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:54:17.652629 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:54:17.662816 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m19:54:17.667372 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m19:54:17.669817 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:54:17.670534 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:54:17.673033 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m19:54:17.674594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:17.675172 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m19:54:17.675619 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m19:54:17.676024 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m19:54:17.676423 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m19:54:17.682157 [debug] [MainThread]: Command end result
[0m19:54:17.878854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:54:17.888507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:54:17.906911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m19:54:17.915153 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m19:54:17.916524 [info ] [MainThread]: Building catalog
[0m19:54:17.924619 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:54:17.928336 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:54:17.929731 [debug] [ThreadPool]: Acquiring new bigquery connection 'pl-football-analytics.information_schema'
[0m19:54:18.007605 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('mf_time_spine')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_team_season_stats')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('dim_team')
                            ) or (
                                upper(table_schema) = upper('football_analytics_football_analytics')
                            and upper(table_name) = upper('fct_match_results')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:54:18.023030 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.__TABLES__ tables
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_analytics_football_analytics_staging')
                            and upper(table_name) = upper('stg_pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_analytics_football_analytics_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:54:18.024568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:18.026323 [debug] [ThreadPool]: On pl-football-analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "connection_name": "pl-football-analytics.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `pl-football-analytics`.`football_raw`.__TABLES__ tables
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('football_raw')
                            and upper(table_name) = upper('pl_matches')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `pl-football-analytics`.`football_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m19:54:18.028278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:18.091902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:18.646163 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5a17a942-480b-4e6a-a678-6212d861a1b8&page=queryresults
[0m19:54:18.698848 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:184eb231-a56a-4d05-a68c-46bf4e75aa5e&page=queryresults
[0m19:54:18.741115 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:6c6ecf88-4fe6-4ce4-b93d-50ffb338d8fb&page=queryresults
[0m19:54:20.015073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:20.046100 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:54:20.099644 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m19:54:20.106337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m19:54:20.108075 [info ] [MainThread]: Catalog written to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/catalog.json
[0m19:54:20.137281 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 15.5838585, "process_in_blocks": "0", "process_kernel_time": 2.494008, "process_mem_max_rss": "378785792", "process_out_blocks": "0", "process_user_time": 9.855587}
[0m19:54:20.138395 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:54:20.138194 after 15.59 seconds
[0m19:54:20.139034 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:54:20.139687 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:54:20.140575 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:54:20.141465 [debug] [MainThread]: Connection 'pl-football-analytics.information_schema' was properly closed.
[0m19:54:20.144411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11412f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11412ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a58490>]}
[0m19:54:20.145760 [debug] [MainThread]: Flushing usage events
[0m19:54:20.506333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:03.778929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134eba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134eb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350aa10>]}


============================== 19:55:03.797964 | c8c10b05-fa56-4bcb-a7de-550bb7629549 ==============================
[0m19:55:03.797964 [info ] [MainThread]: Running with dbt=1.10.15
[0m19:55:03.800015 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/adilosman/.dbt', 'invocation_command': 'dbt docs serve --no-browser --port 8080'}
[0m19:55:14.831858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8c10b05-fa56-4bcb-a7de-550bb7629549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b10cd0>]}
[0m19:55:14.973457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8c10b05-fa56-4bcb-a7de-550bb7629549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a74810>]}
[0m20:04:33.915763 [error] [MainThread]: Encountered an error:

[0m20:04:33.985924 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/adilosman/Desktop/premier-league-analytics-warehouse/.venv/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:04:34.017988 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 570.4224, "process_in_blocks": "0", "process_kernel_time": 2.326548, "process_mem_max_rss": "356831232", "process_out_blocks": "0", "process_user_time": 8.781816}
[0m20:04:34.028800 [debug] [MainThread]: Command `dbt docs serve` failed at 20:04:34.028161 after 570.44 seconds
[0m20:04:34.032795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113484b90>]}
[0m20:04:34.035346 [debug] [MainThread]: Flushing usage events
[0m20:04:34.601249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:38.833487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac77110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac8aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac8b050>]}


============================== 20:05:38.878540 | 88b6cbd4-ff52-48eb-bad3-ee0d100c570c ==============================
[0m20:05:38.878540 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:05:38.880658 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None', 'profiles_dir': '/Users/adilosman/.dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'fail_fast': 'False'}
[0m20:06:19.964198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2b9fd0>]}
[0m20:06:20.381991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e8110>]}
[0m20:06:20.386221 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:06:22.000754 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:06:23.245293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:23.246486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:23.449883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7e32d0>]}
[0m20:06:24.013221 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m20:06:24.022546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m20:06:24.411623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da2fed0>]}
[0m20:06:24.413376 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m20:06:24.414777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da13350>]}
[0m20:06:24.425022 [info ] [MainThread]: 
[0m20:06:24.563598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:06:24.565375 [info ] [MainThread]: 
[0m20:06:24.567220 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:06:24.583278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics'
[0m20:06:24.584823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics_football_analytics_football_analytics_staging'
[0m20:06:24.586675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:24.587990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:25.158516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b6cbd4-ff52-48eb-bad3-ee0d100c570c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d815b90>]}
[0m20:06:25.160143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:25.181758 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:06:25.183086 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:06:25.184303 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:06:25.185491 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:06:25.186882 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_fct_match_results_result__H__A__D ........... [RUN]
[0m20:06:25.188785 [info ] [Thread-2 (]: 2 of 11 START test not_null_dim_team_team_id ................................... [RUN]
[0m20:06:25.191960 [info ] [Thread-3 (]: 3 of 11 START test not_null_fct_match_results_match_id ......................... [RUN]
[0m20:06:25.193652 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m20:06:25.195592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m20:06:25.197089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m20:06:25.198991 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f'
[0m20:06:25.201998 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m20:06:25.203480 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:06:25.204873 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:06:25.207345 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:06:25.208853 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:06:25.367982 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m20:06:25.374231 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m20:06:25.378666 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m20:06:25.359901 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m20:06:25.380679 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:06:25.381832 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:06:25.384798 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:06:25.467370 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:06:25.668068 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m20:06:25.676959 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m20:06:25.686568 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m20:06:25.689636 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select team_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
where team_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:25.691512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:25.685269 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m20:06:25.695082 [debug] [Thread-1 (]: On test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        result as value_field,
        count(*) as n_records

    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
    group by result

)

select *
from all_values
where value_field not in (
    'H','A','D'
)



  
  
      
    ) dbt_internal_test
[0m20:06:25.813572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:25.912384 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:25.914601 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:25.918385 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:06:25.920025 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:06:26.641407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:a68deb38-4c15-4de1-bd7a-b3ac0a38cb05&page=queryresults
[0m20:06:26.661031 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f477de02-13d0-441c-8240-d58659c7d6cf&page=queryresults
[0m20:06:26.850275 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:27ab4003-3a89-49dc-bbe4-c97715fe3118&page=queryresults
[0m20:06:26.991579 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:55a066de-622a-419b-9977-e5680d797f4f&page=queryresults
[0m20:06:29.482530 [info ] [Thread-2 (]: 2 of 11 PASS not_null_dim_team_team_id ......................................... [[32mPASS[0m in 4.29s]
[0m20:06:29.486030 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m20:06:29.496225 [info ] [Thread-3 (]: 3 of 11 PASS not_null_fct_match_results_match_id ............................... [[32mPASS[0m in 4.30s]
[0m20:06:29.507175 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:06:29.531988 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m20:06:29.522873 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_fct_match_results_result__H__A__D ................. [[32mPASS[0m in 4.33s]
[0m20:06:29.547799 [info ] [Thread-2 (]: 5 of 11 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m20:06:29.550347 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 4.35s]
[0m20:06:29.552595 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:06:29.579439 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m20:06:29.567482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663)
[0m20:06:29.569137 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m20:06:29.581545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m20:06:29.565811 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m20:06:29.583441 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:06:29.584893 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:06:29.585776 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:06:29.587986 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:06:29.615495 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m20:06:29.610897 [info ] [Thread-4 (]: 7 of 11 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m20:06:29.635042 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m20:06:29.636067 [info ] [Thread-1 (]: 8 of 11 START test unique_dim_team_team_id ..................................... [RUN]
[0m20:06:29.641297 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m20:06:29.645036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m20:06:29.646829 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:06:29.648440 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:06:29.649817 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:06:29.651064 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:06:29.664345 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m20:06:29.675194 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m20:06:29.681772 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m20:06:29.700373 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m20:06:29.706404 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:06:29.708323 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



  
  
      
    ) dbt_internal_test
[0m20:06:29.709687 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:06:29.715540 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m20:06:29.716887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:29.717922 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



  
  
      
    ) dbt_internal_test
[0m20:06:29.724141 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m20:06:29.726250 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:29.728046 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m20:06:29.806912 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_dim_team_team_id.069cd44695: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
  where team_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:29.873852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:29.875718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:30.730315 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:aded6d71-7ef8-44fb-a8f2-f9f6467e6e6d&page=queryresults
[0m20:06:30.837340 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5146043a-5232-4bcd-9d0c-1a4c21bd7bac&page=queryresults
[0m20:06:30.874872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:fb83474e-f648-4834-b4cb-f13d08bdd134&page=queryresults
[0m20:06:31.114250 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9887b487-3351-42a8-8c96-3f14eb06ceff&page=queryresults
[0m20:06:31.204396 [info ] [Thread-1 (]: 8 of 11 PASS unique_dim_team_team_id ........................................... [[32mPASS[0m in 1.55s]
[0m20:06:31.211099 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 1.63s]
[0m20:06:31.213692 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m20:06:31.215356 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m20:06:31.216822 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:06:31.226734 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:06:31.228404 [info ] [Thread-1 (]: 9 of 11 START test unique_fct_match_results_match_id ........................... [RUN]
[0m20:06:31.230485 [info ] [Thread-3 (]: 10 of 11 START test unique_fct_team_season_stats_team_id_season ................ [RUN]
[0m20:06:31.231888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m20:06:31.232783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m20:06:31.233616 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:06:31.234416 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:06:31.274626 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m20:06:31.272311 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m20:06:31.276951 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:06:31.277490 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:06:31.283653 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m20:06:31.292449 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m20:06:31.299862 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id || '-' || season as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
  where team_id || '-' || season is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:31.301049 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:31.303709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:31.305373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:31.413683 [info ] [Thread-4 (]: 7 of 11 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.77s]
[0m20:06:31.521366 [info ] [Thread-2 (]: 5 of 11 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.95s]
[0m20:06:31.525805 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m20:06:31.527680 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m20:06:31.533492 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:06:31.537791 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_pl_matches_match_id ............................. [RUN]
[0m20:06:31.539638 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m20:06:31.540831 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:06:31.566159 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m20:06:31.575504 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:06:31.588058 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m20:06:31.594156 [debug] [Thread-4 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:06:31.595545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:06:32.164979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:9568522f-338a-45f7-ac83-f263056e10d3&page=queryresults
[0m20:06:32.166025 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:55cb3ef0-7917-40c9-b1af-ef28446a6a4c&page=queryresults
[0m20:06:32.220851 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:a571630d-185e-4cc5-8cd1-88d6a5301a71&page=queryresults
[0m20:06:32.476786 [info ] [Thread-1 (]: 9 of 11 PASS unique_fct_match_results_match_id ................................. [[32mPASS[0m in 1.24s]
[0m20:06:32.478035 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m20:06:32.571132 [info ] [Thread-3 (]: 10 of 11 PASS unique_fct_team_season_stats_team_id_season ...................... [[32mPASS[0m in 1.34s]
[0m20:06:32.573633 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m20:06:32.976989 [info ] [Thread-4 (]: 11 of 11 PASS unique_stg_pl_matches_match_id ................................... [[32mPASS[0m in 1.44s]
[0m20:06:32.978402 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m20:06:32.981120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:32.991710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:32.993025 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m20:06:32.994113 [debug] [MainThread]: Connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663' was properly closed.
[0m20:06:32.995273 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m20:06:32.996463 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8' was properly closed.
[0m20:06:32.998240 [info ] [MainThread]: 
[0m20:06:33.001692 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m20:06:33.012643 [debug] [MainThread]: Command end result
[0m20:06:33.083378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m20:06:33.090350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m20:06:33.121078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m20:06:33.122049 [info ] [MainThread]: 
[0m20:06:33.123042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:33.123903 [info ] [MainThread]: 
[0m20:06:33.124778 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m20:06:33.143622 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 54.85574, "process_in_blocks": "0", "process_kernel_time": 3.550434, "process_mem_max_rss": "383606784", "process_out_blocks": "0", "process_user_time": 15.028359}
[0m20:06:33.145179 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:33.144845 after 54.86 seconds
[0m20:06:33.146438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac97850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac97c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b0250>]}
[0m20:06:33.147980 [debug] [MainThread]: Flushing usage events
[0m20:06:33.574474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:25.717074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107285d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d18250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2f3d0>]}


============================== 20:27:25.759069 | c4d51772-d4d9-4cde-bb15-99e52807484c ==============================
[0m20:27:25.759069 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:27:25.761419 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt ls', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/adilosman/.dbt', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m20:27:59.011397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d51772-d4d9-4cde-bb15-99e52807484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3fdd0>]}
[0m20:27:59.271929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d51772-d4d9-4cde-bb15-99e52807484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c4290>]}
[0m20:27:59.276405 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:28:00.915902 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:28:01.653430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:01.654599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:01.786662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d51772-d4d9-4cde-bb15-99e52807484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c858850>]}
[0m20:28:02.052046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m20:28:02.062779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m20:28:02.255390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d51772-d4d9-4cde-bb15-99e52807484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4aced0>]}
[0m20:28:02.257377 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m20:28:02.258594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d51772-d4d9-4cde-bb15-99e52807484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962f3d0>]}
[0m20:28:02.262219 [info ] [MainThread]: premier_league_analytics.marts.dim_team
[0m20:28:02.264380 [info ] [MainThread]: premier_league_analytics.marts.fct_match_results
[0m20:28:02.266875 [info ] [MainThread]: premier_league_analytics.marts.fct_team_season_stats
[0m20:28:02.267923 [info ] [MainThread]: premier_league_analytics.staging.stg_pl_matches
[0m20:28:02.269047 [info ] [MainThread]: premier_league_analytics.marts.time_spine
[0m20:28:02.273545 [info ] [MainThread]: source:premier_league_analytics.football_raw.pl_matches
[0m20:28:02.274919 [info ] [MainThread]: premier_league_analytics.accepted_values_fct_match_results_result__H__A__D
[0m20:28:02.289574 [info ] [MainThread]: premier_league_analytics.not_null_dim_team_team_id
[0m20:28:02.291498 [info ] [MainThread]: premier_league_analytics.not_null_fct_match_results_match_id
[0m20:28:02.300690 [info ] [MainThread]: premier_league_analytics.not_null_stg_pl_matches_away_team_name
[0m20:28:02.302456 [info ] [MainThread]: premier_league_analytics.not_null_stg_pl_matches_home_team_name
[0m20:28:02.303976 [info ] [MainThread]: premier_league_analytics.not_null_stg_pl_matches_match_date
[0m20:28:02.305001 [info ] [MainThread]: premier_league_analytics.not_null_stg_pl_matches_match_id
[0m20:28:02.307049 [info ] [MainThread]: premier_league_analytics.unique_dim_team_team_id
[0m20:28:02.322698 [info ] [MainThread]: premier_league_analytics.unique_fct_match_results_match_id
[0m20:28:02.323770 [info ] [MainThread]: premier_league_analytics.unique_fct_team_season_stats_team_id_season
[0m20:28:02.324709 [info ] [MainThread]: premier_league_analytics.unique_stg_pl_matches_match_id
[0m20:28:02.395496 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 37.05825, "process_in_blocks": "0", "process_kernel_time": 3.156815, "process_mem_max_rss": "362987520", "process_out_blocks": "0", "process_user_time": 10.610061}
[0m20:28:02.397485 [debug] [MainThread]: Command `dbt ls` succeeded at 20:28:02.397093 after 37.06 seconds
[0m20:28:02.398786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105546f10>]}
[0m20:28:02.408909 [debug] [MainThread]: Flushing usage events
[0m20:28:02.946588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:33.598685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a24cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11374b710>]}


============================== 15:35:33.613194 | b8c0f55e-fb27-4183-a952-2e35d3b58171 ==============================
[0m15:35:33.613194 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:35:33.616518 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/Users/adilosman/.dbt', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'static_parser': 'True'}
[0m15:36:02.689281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fb1850>]}
[0m15:36:02.805858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6ff50>]}
[0m15:36:02.806813 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:36:03.596374 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:36:04.395172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:36:04.397243 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/schema.yml
[0m15:36:04.398047 [debug] [MainThread]: Partial parsing: updated file: premier_league_analytics://models/marts/dim_team.sql
[0m15:36:05.300119 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:36:05.301735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126087f50>]}
[0m15:36:05.748236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126593fd0>]}
[0m15:36:05.948574 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m15:36:05.959068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m15:36:06.339027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b0b810>]}
[0m15:36:06.340148 [info ] [MainThread]: Found 5 models, 11 data tests, 1 source, 520 macros
[0m15:36:06.345859 [info ] [MainThread]: 
[0m15:36:06.350644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:06.355498 [info ] [MainThread]: 
[0m15:36:06.357181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:06.382064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m15:36:06.385796 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pl-football-analytics'
[0m15:36:06.386968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:06.388126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:07.034062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics)
[0m15:36:07.035247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pl-football-analytics, now list_pl-football-analytics_football_analytics_football_analytics_staging)
[0m15:36:07.035887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:07.036464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:07.424493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266a18d0>]}
[0m15:36:07.426084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:07.444620 [debug] [Thread-1 (]: Began running node model.premier_league_analytics.stg_pl_matches
[0m15:36:07.447826 [debug] [Thread-2 (]: Began running node model.premier_league_analytics.time_spine
[0m15:36:07.448985 [info ] [Thread-1 (]: 1 of 16 START sql view model football_analytics_football_analytics_staging.stg_pl_matches  [RUN]
[0m15:36:07.450186 [info ] [Thread-2 (]: 2 of 16 START sql table model football_analytics_football_analytics.mf_time_spine  [RUN]
[0m15:36:07.451385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics, now model.premier_league_analytics.stg_pl_matches)
[0m15:36:07.452237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pl-football-analytics_football_analytics_football_analytics_staging, now model.premier_league_analytics.time_spine)
[0m15:36:07.453033 [debug] [Thread-1 (]: Began compiling node model.premier_league_analytics.stg_pl_matches
[0m15:36:07.453752 [debug] [Thread-2 (]: Began compiling node model.premier_league_analytics.time_spine
[0m15:36:07.486130 [debug] [Thread-1 (]: Writing injected SQL for node "model.premier_league_analytics.stg_pl_matches"
[0m15:36:07.488992 [debug] [Thread-2 (]: Writing injected SQL for node "model.premier_league_analytics.time_spine"
[0m15:36:07.493836 [debug] [Thread-2 (]: Began executing node model.premier_league_analytics.time_spine
[0m15:36:07.494476 [debug] [Thread-1 (]: Began executing node model.premier_league_analytics.stg_pl_matches
[0m15:36:07.521745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:07.564856 [debug] [Thread-1 (]: Writing runtime sql for node "model.premier_league_analytics.stg_pl_matches"
[0m15:36:07.627027 [debug] [Thread-1 (]: On model.premier_league_analytics.stg_pl_matches: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.stg_pl_matches"} */


  create or replace view `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  OPTIONS()
  as with raw as (

    select
      season,
      round_number,
      round_name,
      match_num,
      date,
      time,
      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,
      home_goals_ft,
      away_goals_ft,
      home_goals_ht,
      away_goals_ht,
      stadium_name,
      city,
      `group`
    from `pl-football-analytics`.`football_raw`.`pl_matches`

),

typed as (

    select
      -- Create a stable ID
      concat(season, '-', cast(match_num as string)) as match_id,

      season,
      safe_cast(split(season, '-')[offset(0)] as int64) as season_start_year,
      safe_cast(split(season, '-')[offset(1)] as int64) as season_end_year,

      round_number,
      round_name,
      match_num,
      safe_cast(date as date) as match_date,
      time as match_time,

      home_team_name,
      home_team_code,
      away_team_name,
      away_team_code,

      safe_cast(home_goals_ft as int64) as home_goals,
      safe_cast(away_goals_ft as int64) as away_goals,
      safe_cast(home_goals_ht as int64) as home_goals_ht,
      safe_cast(away_goals_ht as int64) as away_goals_ht,

      stadium_name,
      city,
      `group` as round_group
    from raw
    where season is not null
      and match_num is not null

)

select * from typed;


[0m15:36:07.628689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:07.948162 [debug] [Thread-2 (]: Writing runtime sql for node "model.premier_league_analytics.time_spine"
[0m15:36:07.954142 [debug] [Thread-2 (]: On model.premier_league_analytics.time_spine: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.time_spine"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`mf_time_spine`
      
    
    

    
    OPTIONS()
    as (
      

-- Time spine for MetricFlow (daily grain).
with spine as (
  select day as date_day
  from unnest(generate_date_array(date '2014-07-01', date '2025-06-30', interval 1 day)) as day
)

select * from spine
    );
  
[0m15:36:08.303129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:5b36c64b-7553-4ee6-ad77-a9446a9cddb7&page=queryresults
[0m15:36:08.549008 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:4dcae944-1783-4b15-b870-79e66f7a8f80&page=queryresults
[0m15:36:10.894148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126784610>]}
[0m15:36:10.895573 [info ] [Thread-1 (]: 1 of 16 OK created sql view model football_analytics_football_analytics_staging.stg_pl_matches  [[32mCREATE VIEW (0 processed)[0m in 3.44s]
[0m15:36:10.896791 [debug] [Thread-1 (]: Finished running node model.premier_league_analytics.stg_pl_matches
[0m15:36:10.897918 [debug] [Thread-4 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m15:36:10.898610 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m15:36:10.899132 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m15:36:10.899687 [info ] [Thread-4 (]: 3 of 16 START test not_null_stg_pl_matches_away_team_name ...................... [RUN]
[0m15:36:10.900457 [info ] [Thread-3 (]: 4 of 16 START test not_null_stg_pl_matches_home_team_name ...................... [RUN]
[0m15:36:10.901793 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_pl_matches_match_date .......................... [RUN]
[0m15:36:10.903725 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666'
[0m15:36:10.905332 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663'
[0m15:36:10.906560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.stg_pl_matches, now test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd)
[0m15:36:10.907807 [debug] [Thread-4 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m15:36:10.909134 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m15:36:10.920426 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m15:36:10.940560 [debug] [Thread-4 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m15:36:10.947641 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m15:36:10.954337 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m15:36:10.963543 [debug] [Thread-4 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m15:36:10.964602 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m15:36:10.971168 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m15:36:11.003905 [debug] [Thread-4 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"
[0m15:36:11.012114 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"
[0m15:36:11.024392 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"
[0m15:36:11.032364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e48210>]}
[0m15:36:11.034725 [info ] [Thread-2 (]: 2 of 16 OK created sql table model football_analytics_football_analytics.mf_time_spine  [[32mCREATE TABLE (4.0k rows, 0 processed)[0m in 3.58s]
[0m15:36:11.036565 [debug] [Thread-2 (]: Finished running node model.premier_league_analytics.time_spine
[0m15:36:11.037744 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m15:36:11.039113 [debug] [Thread-4 (]: On test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select away_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where away_team_name is null



  
  
      
    ) dbt_internal_test
[0m15:36:11.040060 [info ] [Thread-2 (]: 6 of 16 START test not_null_stg_pl_matches_match_id ............................ [RUN]
[0m15:36:11.041392 [debug] [Thread-1 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_date
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_date is null



  
  
      
    ) dbt_internal_test
[0m15:36:11.058643 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:36:11.055852 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select home_team_name
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where home_team_name is null



  
  
      
    ) dbt_internal_test
[0m15:36:11.061041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.time_spine, now test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2)
[0m15:36:11.062361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:11.063816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:36:11.065047 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m15:36:11.201132 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m15:36:11.269383 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m15:36:11.277557 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"
[0m15:36:11.283326 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m15:36:11.284742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:12.099696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:e011992a-4e51-4bdd-9328-6672dec18c2b&page=queryresults
[0m15:36:12.130166 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:fcae804b-3ee4-4466-93ab-5d981aa0de4a&page=queryresults
[0m15:36:12.134524 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:0390bad4-7695-44c9-8035-f6230c469b77&page=queryresults
[0m15:36:12.206128 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:8afce29c-d946-457f-95fa-16536c56f802&page=queryresults
[0m15:36:12.427977 [info ] [Thread-3 (]: 4 of 16 PASS not_null_stg_pl_matches_home_team_name ............................ [[32mPASS[0m in 1.52s]
[0m15:36:12.439480 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663
[0m15:36:12.444972 [info ] [Thread-4 (]: 3 of 16 PASS not_null_stg_pl_matches_away_team_name ............................ [[32mPASS[0m in 1.54s]
[0m15:36:12.448845 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m15:36:12.450232 [debug] [Thread-4 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666
[0m15:36:12.451325 [info ] [Thread-3 (]: 7 of 16 START test unique_stg_pl_matches_match_id .............................. [RUN]
[0m15:36:12.460334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_home_team_name.6b9c416663, now test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8)
[0m15:36:12.474079 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_pl_matches_match_date ................................ [[32mPASS[0m in 1.57s]
[0m15:36:12.488138 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m15:36:12.489342 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd
[0m15:36:12.518602 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m15:36:12.525737 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m15:36:12.531757 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"
[0m15:36:12.537034 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:36:12.538185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:12.634587 [info ] [Thread-2 (]: 6 of 16 PASS not_null_stg_pl_matches_match_id .................................. [[32mPASS[0m in 1.57s]
[0m15:36:12.636924 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2
[0m15:36:13.384691 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:78abb126-5857-4cd5-8e23-8f8b981eb47c&page=queryresults
[0m15:36:13.639704 [info ] [Thread-3 (]: 7 of 16 PASS unique_stg_pl_matches_match_id .................................... [[32mPASS[0m in 1.18s]
[0m15:36:13.640913 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8
[0m15:36:13.642195 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.dim_team
[0m15:36:13.643377 [info ] [Thread-4 (]: 8 of 16 START sql table model football_analytics_football_analytics.dim_team ... [RUN]
[0m15:36:13.644270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_away_team_name.631f27b666, now model.premier_league_analytics.dim_team)
[0m15:36:13.644948 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.dim_team
[0m15:36:13.653021 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.dim_team"
[0m15:36:13.659209 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.dim_team
[0m15:36:13.674271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:36:13.999963 [debug] [Thread-4 (]: Writing runtime sql for node "model.premier_league_analytics.dim_team"
[0m15:36:14.007972 [debug] [Thread-4 (]: On model.premier_league_analytics.dim_team: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.dim_team"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
      
    
    

    
    OPTIONS()
    as (
      with teams as (

    select
      home_team_name as team_name,
      home_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

    union distinct

    select
      away_team_name as team_name,
      away_team_code as team_code
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches`

),

final as (

    select
      -- Deterministic ID so it stays stable across builds
      to_hex(md5(lower(trim(team_name)))) as team_id,
      team_name,
      team_code
    from teams

)

select * from final
    );
  
[0m15:36:14.416514 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:c3ae9069-16bf-4d94-a272-d8cc7e439cf6&page=queryresults
[0m15:36:15.924822 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e53e10>]}
[0m15:36:15.927183 [info ] [Thread-4 (]: 8 of 16 OK created sql table model football_analytics_football_analytics.dim_team  [[32mCREATE TABLE (0.0 rows, 346.8 KiB processed)[0m in 2.28s]
[0m15:36:15.929628 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.dim_team
[0m15:36:15.931587 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m15:36:15.932832 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m15:36:15.933900 [info ] [Thread-2 (]: 9 of 16 START test not_null_dim_team_team_id ................................... [RUN]
[0m15:36:15.950023 [info ] [Thread-3 (]: 10 of 16 START test unique_dim_team_team_id .................................... [RUN]
[0m15:36:15.951967 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_id.c1376eedf2, now test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157)
[0m15:36:15.954047 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m15:36:15.953033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_stg_pl_matches_match_id.8c0a9521d8, now test.premier_league_analytics.unique_dim_team_team_id.069cd44695)
[0m15:36:15.963550 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m15:36:15.964447 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m15:36:15.982726 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m15:36:15.991814 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m15:36:15.999240 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"
[0m15:36:16.001404 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m15:36:16.008464 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"
[0m15:36:16.010533 [debug] [Thread-2 (]: On test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select team_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
where team_id is null



  
  
      
    ) dbt_internal_test
[0m15:36:16.011835 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:16.067873 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_dim_team_team_id.069cd44695: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_dim_team_team_id.069cd44695"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team`
  where team_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:36:16.069063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:16.721753 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:771f9f08-a4ad-463a-a43d-4e3d2a3be497&page=queryresults
[0m15:36:16.745549 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f2de227e-fdd3-4e57-8a54-7357f68f656d&page=queryresults
[0m15:36:16.982693 [info ] [Thread-2 (]: 9 of 16 PASS not_null_dim_team_team_id ......................................... [[32mPASS[0m in 1.03s]
[0m15:36:16.984313 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157
[0m15:36:17.037298 [info ] [Thread-3 (]: 10 of 16 PASS unique_dim_team_team_id .......................................... [[32mPASS[0m in 1.08s]
[0m15:36:17.039601 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_dim_team_team_id.069cd44695
[0m15:36:17.042714 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_match_results
[0m15:36:17.044093 [info ] [Thread-4 (]: 11 of 16 START sql table model football_analytics_football_analytics.fct_match_results  [RUN]
[0m15:36:17.045724 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.dim_team, now model.premier_league_analytics.fct_match_results)
[0m15:36:17.047979 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_match_results
[0m15:36:17.067729 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_match_results"
[0m15:36:17.075016 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_match_results
[0m15:36:17.083491 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:36:17.364258 [debug] [Thread-4 (]: Writing runtime sql for node "model.premier_league_analytics.fct_match_results"
[0m15:36:17.370043 [debug] [Thread-4 (]: On model.premier_league_analytics.fct_match_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_match_results"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
      
    
    

    
    OPTIONS()
    as (
      with matches as (

    select
      m.*,
      t_home.team_id as home_team_id,
      t_away.team_id as away_team_id
    from `pl-football-analytics`.`football_analytics_football_analytics_staging`.`stg_pl_matches` m
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_home
      on m.home_team_name = t_home.team_name
    left join `pl-football-analytics`.`football_analytics_football_analytics`.`dim_team` t_away
      on m.away_team_name = t_away.team_name

),

results as (

    select
      match_id,
      season,
      season_start_year,
      season_end_year,
      match_date,
      round_number,
      round_name,

      home_team_id,
      home_team_name,
      away_team_id,
      away_team_name,

      home_goals,
      away_goals,

      case
        when home_goals > away_goals then 'H'
        when home_goals < away_goals then 'A'
        when home_goals = away_goals then 'D'
        else null
      end as result,

      case
        when home_goals > away_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as home_points,

      case
        when away_goals > home_goals then 3
        when home_goals = away_goals then 1
        else 0
      end as away_points
    from matches

)

select * from results
    );
  
[0m15:36:17.644425 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:58de19f2-26ee-4c6a-ab9e-c1f552afa702&page=queryresults
[0m15:36:19.257548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebec50>]}
[0m15:36:19.259623 [info ] [Thread-4 (]: 11 of 16 OK created sql table model football_analytics_football_analytics.fct_match_results  [[32mCREATE TABLE (0.0 rows, 712.3 KiB processed)[0m in 2.21s]
[0m15:36:19.261636 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_match_results
[0m15:36:19.263865 [debug] [Thread-2 (]: Began running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m15:36:19.265174 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m15:36:19.266339 [debug] [Thread-1 (]: Began running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m15:36:19.271440 [info ] [Thread-2 (]: 12 of 16 START test accepted_values_fct_match_results_result__H__A__D .......... [RUN]
[0m15:36:19.273606 [info ] [Thread-3 (]: 13 of 16 START test not_null_fct_match_results_match_id ........................ [RUN]
[0m15:36:19.286168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_dim_team_team_id.7b67f9e157, now test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d)
[0m15:36:19.275484 [info ] [Thread-1 (]: 14 of 16 START test unique_fct_match_results_match_id .......................... [RUN]
[0m15:36:19.287608 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.unique_dim_team_team_id.069cd44695, now test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f)
[0m15:36:19.289301 [debug] [Thread-2 (]: Began compiling node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m15:36:19.290350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_stg_pl_matches_match_date.16fd9fb8fd, now test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162)
[0m15:36:19.294007 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m15:36:19.305080 [debug] [Thread-1 (]: Began compiling node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m15:36:19.317916 [debug] [Thread-2 (]: Writing injected SQL for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m15:36:19.328596 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m15:36:19.333892 [debug] [Thread-1 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m15:36:19.338479 [debug] [Thread-2 (]: Began executing node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m15:36:19.339033 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m15:36:19.339419 [debug] [Thread-1 (]: Began executing node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m15:36:19.342907 [debug] [Thread-2 (]: Writing runtime sql for node "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"
[0m15:36:19.345970 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"
[0m15:36:19.350395 [debug] [Thread-1 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"
[0m15:36:19.354906 [debug] [Thread-2 (]: On test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        result as value_field,
        count(*) as n_records

    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
    group by result

)

select *
from all_values
where value_field not in (
    'H','A','D'
)



  
  
      
    ) dbt_internal_test
[0m15:36:19.355856 [debug] [Thread-1 (]: On test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select match_id as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
  where match_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:36:19.356770 [debug] [Thread-3 (]: On test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select match_id
from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`
where match_id is null



  
  
      
    ) dbt_internal_test
[0m15:36:19.357959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:19.359089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:19.360004 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:19.996860 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:cfd88638-58c5-45c5-b5f9-a3dcbc523b7d&page=queryresults
[0m15:36:20.055666 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:13bb7ee4-879f-4ce2-9066-29453844fd5b&page=queryresults
[0m15:36:20.275148 [info ] [Thread-2 (]: 12 of 16 PASS accepted_values_fct_match_results_result__H__A__D ................ [[32mPASS[0m in 0.99s]
[0m15:36:20.277520 [debug] [Thread-2 (]: Finished running node test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d
[0m15:36:20.379905 [info ] [Thread-3 (]: 13 of 16 PASS not_null_fct_match_results_match_id .............................. [[32mPASS[0m in 1.09s]
[0m15:36:20.382214 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f
[0m15:36:20.860101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:f8b37c14-b956-44e4-b914-0629036b5cc0&page=queryresults
[0m15:36:21.221356 [info ] [Thread-1 (]: 14 of 16 PASS unique_fct_match_results_match_id ................................ [[32mPASS[0m in 1.93s]
[0m15:36:21.223385 [debug] [Thread-1 (]: Finished running node test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162
[0m15:36:21.225399 [debug] [Thread-4 (]: Began running node model.premier_league_analytics.fct_team_season_stats
[0m15:36:21.226802 [info ] [Thread-4 (]: 15 of 16 START sql table model football_analytics_football_analytics.fct_team_season_stats  [RUN]
[0m15:36:21.228543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.premier_league_analytics.fct_match_results, now model.premier_league_analytics.fct_team_season_stats)
[0m15:36:21.230867 [debug] [Thread-4 (]: Began compiling node model.premier_league_analytics.fct_team_season_stats
[0m15:36:21.243262 [debug] [Thread-4 (]: Writing injected SQL for node "model.premier_league_analytics.fct_team_season_stats"
[0m15:36:21.248115 [debug] [Thread-4 (]: Began executing node model.premier_league_analytics.fct_team_season_stats
[0m15:36:21.252332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:36:21.547411 [debug] [Thread-4 (]: Writing runtime sql for node "model.premier_league_analytics.fct_team_season_stats"
[0m15:36:21.552637 [debug] [Thread-4 (]: On model.premier_league_analytics.fct_team_season_stats: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "model.premier_league_analytics.fct_team_season_stats"} */

  
    

    create or replace table `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
      
    
    

    
    OPTIONS()
    as (
      with all_matches as (

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      home_team_id as team_id,
      home_team_name as team_name,
      'H' as venue,
      home_goals as goals_for,
      away_goals as goals_against,
      home_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

    union all

    select
      season,
      season_start_year,
      season_end_year,
      match_date,
      away_team_id as team_id,
      away_team_name as team_name,
      'A' as venue,
      away_goals as goals_for,
      home_goals as goals_against,
      away_points as points
    from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_match_results`

),

agg as (

    select
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year,

      count(*) as matches_played,
      sum(case when points = 3 then 1 else 0 end) as wins,
      sum(case when points = 1 then 1 else 0 end) as draws,
      sum(case when points = 0 then 1 else 0 end) as losses,

      sum(goals_for) as goals_for,
      sum(goals_against) as goals_against,
      sum(goals_for - goals_against) as goal_diff,
      sum(points) as points,

      sum(case when venue = 'H' then 1 else 0 end) as home_matches,
      sum(case when venue = 'A' then 1 else 0 end) as away_matches
    from all_matches
    group by
      team_id,
      team_name,
      season,
      season_start_year,
      season_end_year
)

select
  agg.*,
  date(season_start_year, 8, 1) as season_start_date,
  date(season_end_year, 5, 31) as season_end_date
from agg
    );
  
[0m15:36:22.399368 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:49c17bea-20ec-437e-aa47-bd17f0b0c9b8&page=queryresults
[0m15:36:24.026815 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0f55e-fb27-4183-a952-2e35d3b58171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e73550>]}
[0m15:36:24.028821 [info ] [Thread-4 (]: 15 of 16 OK created sql table model football_analytics_football_analytics.fct_team_season_stats  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.80s]
[0m15:36:24.030491 [debug] [Thread-4 (]: Finished running node model.premier_league_analytics.fct_team_season_stats
[0m15:36:24.032153 [debug] [Thread-3 (]: Began running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m15:36:24.033612 [info ] [Thread-3 (]: 16 of 16 START test unique_fct_team_season_stats_team_id_season ................ [RUN]
[0m15:36:24.036622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.premier_league_analytics.not_null_fct_match_results_match_id.158786e36f, now test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5)
[0m15:36:24.038284 [debug] [Thread-3 (]: Began compiling node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m15:36:24.055723 [debug] [Thread-3 (]: Writing injected SQL for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m15:36:24.067132 [debug] [Thread-3 (]: Began executing node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m15:36:24.076171 [debug] [Thread-3 (]: Writing runtime sql for node "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"
[0m15:36:24.084859 [debug] [Thread-3 (]: On test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "premier_league_analytics", "target_name": "dev", "node_id": "test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select team_id || '-' || season as unique_field
  from `pl-football-analytics`.`football_analytics_football_analytics`.`fct_team_season_stats`
  where team_id || '-' || season is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:36:24.085844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:24.643918 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pl-football-analytics&j=bq:EU:b2da9736-0fbd-4a2b-acb3-69c01d8dce7d&page=queryresults
[0m15:36:24.972013 [info ] [Thread-3 (]: 16 of 16 PASS unique_fct_team_season_stats_team_id_season ...................... [[32mPASS[0m in 0.94s]
[0m15:36:24.986181 [debug] [Thread-3 (]: Finished running node test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5
[0m15:36:25.007511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:25.020738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:25.021649 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_match_results_match_id.a6ac9d1162' was properly closed.
[0m15:36:25.023078 [debug] [MainThread]: Connection 'test.premier_league_analytics.accepted_values_fct_match_results_result__H__A__D.c75485f35d' was properly closed.
[0m15:36:25.025435 [debug] [MainThread]: Connection 'model.premier_league_analytics.fct_team_season_stats' was properly closed.
[0m15:36:25.026266 [debug] [MainThread]: Connection 'test.premier_league_analytics.unique_fct_team_season_stats_team_id_season.7df4e1e8f5' was properly closed.
[0m15:36:25.027173 [info ] [MainThread]: 
[0m15:36:25.030551 [info ] [MainThread]: Finished running 4 table models, 11 data tests, 1 view model in 0 hours 0 minutes and 18.67 seconds (18.67s).
[0m15:36:25.039132 [debug] [MainThread]: Command end result
[0m15:36:25.094661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/manifest.json
[0m15:36:25.100577 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/semantic_manifest.json
[0m15:36:25.117551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/target/run_results.json
[0m15:36:25.118361 [info ] [MainThread]: 
[0m15:36:25.119262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:25.120045 [info ] [MainThread]: 
[0m15:36:25.120892 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m15:36:25.122198 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:36:25.143470 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 52.250244, "process_in_blocks": "0", "process_kernel_time": 3.246598, "process_mem_max_rss": "388460544", "process_out_blocks": "0", "process_user_time": 13.541799}
[0m15:36:25.144249 [debug] [MainThread]: Command `dbt build` succeeded at 15:36:25.144118 after 52.25 seconds
[0m15:36:25.144740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f21eed0>]}
[0m15:36:25.145628 [debug] [MainThread]: Flushing usage events
[0m15:36:25.533303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:46.999292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134fea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134fefd0>]}


============================== 15:36:47.042639 | 8daebda4-4599-4a52-8343-3c2472d21064 ==============================
[0m15:36:47.042639 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:36:47.044377 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/adilosman/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'invocation_command': 'dbt run --select dim_team', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/adilosman/Desktop/premier-league-analytics-warehouse/dbt/logs', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True'}
