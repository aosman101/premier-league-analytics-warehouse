version: 2

metrics:
  - name: avg_goals_per_match
    label: "Avg goals per match"
    model: ref('fct_team_season_stats')
    description: "Average goals scored per match by team and season."
    calculation_method: expression
    expression: "sum(goals_for) / sum(matches_played)"
    timestamp: season_start_date
    time_grains: [year]
    dimensions:
      - team_name
      - season

  - name: avg_goals_conceded_per_match
    label: "Avg goals conceded per match"
    model: ref('fct_team_season_stats')
    description: "Average goals allowed per match by team and season."
    calculation_method: expression
    expression: "sum(goals_against) / sum(matches_played)"
    timestamp: season_start_date
    time_grains: [year]
    dimensions:
      - team_name
      - season

  - name: win_rate
    label: "Win rate"
    model: ref('fct_team_season_stats')
    description: "Share of matches won by team and season."
    calculation_method: expression
    expression: "sum(wins) / sum(matches_played)"
    timestamp: season_start_date
    time_grains: [year]
    dimensions:
      - team_name
      - season

  - name: points_per_match
    label: "Points per match"
    model: ref('fct_team_season_stats')
    description: "Average points earned per match by team and season."
    calculation_method: expression
    expression: "sum(points) / sum(matches_played)"
    timestamp: season_start_date
    time_grains: [year]
    dimensions:
      - team_name
      - season
